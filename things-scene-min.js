!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.scene=e():t.scene=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=90)}([function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=o(n(94)),s=o(n(153)),c=r(n(20)),l=r(n(27)),f=r(n(190)),h=o(n(198)),p=r(n(3)),d=n(1),y=r(n(73)),v=o(n(74)),g=n(72),b=o(n(200)),_=n(75),m=n(201),w=o(n(202)),x=o(n(203)),k=o(n(204)),O=o(n(205)),P=n(206),A=o(n(207)),j=o(n(208)),E=n(77),M=n(209),S=n(213),T=o(n(35)),C=o(n(215)),R={},I={mutable:!1,resizable:!0,rotatable:!0,properties:[],"value-property":"text",sample:{xx:0}},L=[],D={theta:0,tx:0,ty:0,sx:1,sy:1,fade:0},B=new WeakMap,F=0,N=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._app=n,this._model=e||{},this._state={},this._delta=p.clone(D),n&&this.animation&&(this.animation.started=!0),this.clearCache(),C.default.add(this),B.set(this,F++)}return a(t,null,[{key:"buildSample",value:function(t,e){var n=this.register(t).nature.sample||{};return Object.assign({type:t},n,e)}},{key:"register",value:function(t,e){if(!e)return R[t];R[t]=e}},{key:"nature",get:function(){return I}},{key:"residents",get:function(){return B}}]),a(t,[{key:"created",value:function(){}},{key:"added",value:function(t){}},{key:"removed",value:function(t){}},{key:"ready",value:function(){}},{key:"touch",value:function(){this.updatedAt=performance.now()}},{key:"clearCache",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];y.clear.apply(y,[this].concat(e))}},{key:"removeSelf",value:function(t){t?this.dispose():this.parent&&this.parent.removeComponent(this)}},{key:"dispose",value:function(){this._animation&&(this._animation.dispose(),delete this._animation),this.disposeMappings(),this.parent&&this.parent.removeComponent(this),delete this._text_substitutor,delete this._value_substitutor,this._disposed=!0,this.retention&&C.default.touch(),this.clearCache(),delete this._app}},{key:"isLayer",value:function(){return!1}},{key:"isGroup",value:function(){return!1}},{key:"isContainer",value:function(){return!1}},{key:"isLine",value:function(){return!1}},{key:"isRoot",value:function(){return!1}},{key:"isRootModel",value:function(){return!1}},{key:"is3dish",value:function(){return!1}},{key:"isTemplate",value:function(){return!!this.get("templatePrefix")}},{key:"isHTMLElement",value:function(){return!1}},{key:"get",value:function(t){return this._model[t]}},{key:"set",value:function(t,e){if("string"==typeof t)return this.set(i({},t,e));var n={},r={},o=!1,t=p.clone(t),a=this;return Object.getOwnPropertyNames(t).forEach(function(e){var i=a._model[e],s=t[e];(0,u.default)(i,s)||(r[e]=i,n[e]=s,a._model[e]=s,delete a._state[e],o=!0)}),o&&(this.clearCache(),n.hasOwnProperty("text")&&delete this._text_substitutor,n.hasOwnProperty("retention")&&C.default.add(this),n.hasOwnProperty("fillStyle")&&this.onchangeFill(n,r),n.hasOwnProperty("mappings")&&this.onchangeMappings(n,r),n.hasOwnProperty("data")&&this.onchangeData(n,r),this.onchange&&this.onchange(n,r),this.trigger("change",n,r)),this}},{key:"getState",value:function(t){return this._state.hasOwnProperty(t)?this._state[t]:this.get(t)}},{key:"setState",value:function(t,e){if("string"==typeof t)return this.setState(i({},t,e));var n={},r={},o=!1,t=p.clone(t),a=this;return Object.getOwnPropertyNames(t).forEach(function(e){var i=a.getState(e),s=t[e];(0,u.default)(i,s)||(r[e]=i,n[e]=s,a._state[e]=s,o=!0)}),o&&(this.clearCache(),n.hasOwnProperty("text")&&delete this._text_substitutor,n.hasOwnProperty("fillStyle")&&this.onchangeFill(n,r),n.hasOwnProperty("data")&&this.onchangeData(n,r),this.onchange&&this.onchange(n,r),this.trigger("change",n,r)),this}},{key:"getContext",value:function(){return this._parent.getContext()}},{key:"outline",value:function(t){return(0,w.default)(this,t||0)}},{key:"contains",value:function(t,e){return!1}},{key:"adjustResize",value:function(t,e,n){if(n){var r=this.bounds,o=r.height/r.width,i=t.width-r.width,a=t.height-r.height;i*o>a?a=i*o:i=a/o;var u=t.left-r.left,s=t.top-r.top;return 0!=u&&0!=s?(s=-a,u=-i):0!=u?u=-i:0!=s&&(s=-a),{left:r.left+u,top:r.top+s,width:r.width+i,height:r.height+a}}return t}},{key:"adjustRotation",value:function(t,e){if(e||this.app.rotateStepForced){var n=this.app.rotateStep;return Math.floor((t+n/2)/n)*n}return t}},{key:"findFirst",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(t.apply(void 0,[this].concat(n)))return this}},{key:"findAll",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return"string"==typeof t?c.select(t,this,n[0]||this):"function"==typeof t&&t.apply(void 0,[this].concat(n))?[this]:void 0}},{key:"capture",value:function(t,e){if(!this.capturable)return!1;var n=this.transcoordP2S(t,e);return this.contains(n.x,n.y)?this:void 0}},{key:"prepare",value:function(t,e){t(this)}},{key:"prepareIf",value:function(t){var e=this;t&&this.prepare&&this.prepare(function(t){e.invalidate()},function(t){(0,d.error)(t)})}},{key:"draw",value:function(t){t.save(),this._pre_draw(t),this._draw(t),this._post_draw(t),t.restore()}},{key:"delta",value:function(t,e){if(void 0===e)return t?this._delta[t]:this._delta;this._delta[t]=e}},{key:"_pre_draw",value:function(t){var e=this.rotatePoint,n=this.model,r=n.scale,o=n.rotation,i=n.shadow,a=n.alpha,u=(r&&r.x||1)*this._delta.sx,s=(r&&r.y||1)*this._delta.sy,c=(o||0)+this._delta.theta,l=this._delta,f=l.tx,h=void 0===f?0:f,p=l.ty,d=void 0===p?0:p,y=(a||1)-this._delta.fade;(h||d)&&t.translate(h,d),(1!=u||1!=s||c)&&(t.translate(e.x,e.y),1==u&&1==s||t.scale(u,s),c&&t.rotate(c),t.translate(-e.x,-e.y)),y&&(t.globalAlpha=y),i&&(0,g.setShadow)(t,i,this),this.hidden&&(t.globalAlpha*=.5)}},{key:"_draw",value:function(t){}},{key:"_post_draw",value:function(t){this.drawText(t)}},{key:"drawText",value:function(t){!this.textHidden&&this.text&&this.hasTextProperty&&(0,P.drawText)(t,this.textBounds,this.textLines(t),this.model)}},{key:"drawStroke",value:function(t){(0,x.default)(t,this.model,this)}},{key:"drawFill",value:function(t){this.fillStyle&&"transparent"!=this.fillStyle&&((0,m.drawFill)(t,this.bounds,this.center,this.model,this),(0,g.resetShadow)(t))}},{key:"animate",value:function(t){return this._animate&&this._animate.stop(),this._animate=(0,v.default)(t),this._animate}},{key:"move",value:function(t){var e=t.x,n=t.y,r=this.path,o=e,i=n;this.path=r.map(function(t){return{x:t.x+o,y:t.y+i}})}},{key:"symmetryX",value:function(t){"number"!=typeof t&&(t=this.center.x);var e=this.model.rotation,n=this.fillStyle;if(this.set("rotation",2*Math.PI-e),n&&"gradient"===n.type&&"linear"===n.gradientType){var r=p.clone(n);r.rotation=(Math.PI-parseFloat(n.rotation||0))%(2*Math.PI),this.set("fillStyle",r)}this.path=this.path.map(function(e){return{x:2*t-e.x,y:e.y}})}},{key:"symmetryY",value:function(t){this.symmetryX(),this.set("rotation",(Math.PI+this.model.rotation)%(2*Math.PI)),t&&this.move({x:0,y:2*(t-this.center.y)})}},{key:"effect",value:function(t,e){return(0,h.default)(this,t,e)}},{key:"invalidate",value:function(){this.parent&&this.parent.invalidate()}},{key:"defaultTextSubstitutor",value:function(){var t=this.getState("text");return void 0==t?"":String(t)}},{key:"textLines",value:function(t){return(0,P.textLines)(t||this.getContext(),this.textBounds.width,this.font,this.text,this.get("textWrap"))}},{key:"trim",value:function(){delete this._model[""],"chartjs"!==this._model.type&&delete this._model.chart}},{key:"serialize",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return JSON.stringify.apply(JSON,[this.hierarchy].concat(e))}},{key:"nature",get:function(){return this.constructor.nature}},{key:"disposed",get:function(){return!!this._disposed}},{key:"retention",get:function(){return Number(this.get("retention"))||0}},{key:"hasTextProperty",get:function(){return!0}},{key:"app",get:function(){return!this._app&&this.parent&&(this._app=this.parent.app),this._app}},{key:"model",get:function(){return this._model}},{key:"state",get:function(){return Object.assign({},this._model,this._state)}},{key:"hierarchy",get:function(){var t=p.clone(this._model);return this.volatile.forEach(function(e){delete t[e]}),t}},{key:"volatile",get:function(){return L}},{key:"textHidden",get:function(){return!!this._textHidden},set:function(t){this._textHidden=!!t,this.invalidate()}},{key:"root",get:function(){return this.isRoot()?this:this.parent&&this.parent.root}},{key:"rootModel",get:function(){return this.isRootModel()?this:this.parent&&this.parent.rootModel}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}},{key:"center",get:function(){var t=this.bounds;return{x:t.left+t.width/2,y:t.top+t.height/2}},set:function(t){if(t&&!isNaN(t.x)&&!isNaN(t.y)){var e=this.center;if(Math.round(100*t.x)/100!=Math.round(100*e.x)/100||Math.round(100*t.y)/100!=Math.round(100*e.y)/100){var n=t.x-e.x,r=t.y-e.y;this.path=this.path.map(function(t){return{x:t.x+n,y:t.y+r}})}}}},{key:"location",get:function(){return this.center},set:function(t){this.center=t}},{key:"dimension",get:function(){return this.get("dimension")},set:function(t){this.set("dimension",t)}},{key:"bounds",get:function(){var t,e,n,r,o=this.path;t=e=o[0].x,n=r=o[0].y;for(var i=1;i<o.length;i++){var a=o[i];a.x<t?t=a.x:a.x>e&&(e=a.x),a.y<n?n=a.y:a.y>r&&(r=a.y)}return{left:t,top:n,width:e-t,height:r-n}},set:function(t){var e=this.bounds;if(Math.round(100*t.width)/100!=Math.round(100*e.width)/100||Math.round(100*t.height)/100!=Math.round(100*e.height)/100||Math.round(100*t.left)/100!=Math.round(100*e.left)/100||Math.round(100*t.top)/100!=Math.round(100*e.top)/100){var n={x:0==e.width?1:t.width/e.width,y:0==e.height?1:t.height/e.height};this.path=this.path.map(function(r){return{x:t.left+(r.x-e.left)*n.x,y:t.top+(r.y-e.top)*n.y}})}}},{key:"path",get:function(){return(0,d.error)("이 컴포넌트에 get path 가 구현되어있지 않음.",this),[]},set:function(t){(0,d.error)("이 컴포넌트에 get path 가 구현되어있지 않음.",this)}},{key:"anchors",get:function(){return[]}},{key:"strokeStyle",get:function(){return this.get("strokeStyle")},set:function(t){this.set("strokeStyle",t)}},{key:"fillStyle",get:function(){return this.getState("fillStyle")},set:function(t){this.setState("fillStyle",t)}},{key:"fontColor",get:function(){return this.get("fontColor")},set:function(t){this.set("fontColor",String(p.objToVal(t)))}},{key:"rotation",get:function(){return this.getState("rotation")},set:function(t){this.setState("rotation",Number(p.objToVal(t)))}},{key:"mutable",get:function(){return I.mutable}},{key:"resizable",get:function(){return I.resizable&&!this.stuck}},{key:"rotatable",get:function(){return I.rotatable&&!this.stuck}},{key:"capturable",get:function(){return!1!==this.get("capturable")}},{key:"stuck",get:function(){return!!(this.parent&&this.parent.layout.isStuck(this)||this.get("locked"))}},{key:"hidden",get:function(){return this.app.isViewMode&&this.getState("hidden")},set:function(t){this.setState("hidden",t)}},{key:"animation",get:function(){if(this.app.isViewMode&&!this.isTemplate()){if(!this._animation){var t=this.model.animation;t&&t.oncreate&&(this._animation=f.compile(this,t.oncreate))}return this._animation}}},{key:"started",set:function(t){this.animation&&(this.animation.started=t)}},{key:"font",get:function(){return(0,P.font)(this.model)}},{key:"lineHeight",get:function(){var t=this.get("lineHeight");return t||1.2*this.fontSize}},{key:"textSubstitutor",get:function(){return this._text_substitutor||(this._text_substitutor=(0,E.buildSubstitutor)(this.getState("text"),this)||this.defaultTextSubstitutor),this._text_substitutor}},{key:"text",get:function(){var t=this.get("textFormat");return t?(0,O.default)(t,this.textSubstitutor()):this.textSubstitutor()},set:function(t){delete this._text_substitutor;var e=p.objToVal(t);this.setState("text",void 0==e?"":String(e))}},{key:"textBounds",get:function(){var t=this.model,e=t.paddingTop,n=void 0===e?0:e,r=t.paddingLeft,o=void 0===r?0:r,i=t.paddingRight,a=void 0===i?0:i,u=t.paddingBottom,s=void 0===u?0:u,c=this.bounds,l=c.left,f=c.top,h=c.width,p=c.height;return{left:l+o,top:f+n,width:Math.max(h-o-a,0),height:Math.max(p-n-s,0)}}},{key:"rotatePoint",get:function(){return this.center}},{key:"value",get:function(){var t=this.nature["value-property"]||"text";return"value"==t?this.getState("value"):this[t]},set:function(t){var e=this.nature["value-property"]||"text";"value"==e?this.setState("value",t):this[e]=t}},{key:"data",get:function(){return this.getState("data")},set:function(t){this.setState("data",t),this.touch()}},{key:"mappings",get:function(){return!this._mappings&&this.parent&&this.buildMappings(),this._mappings}},{key:"controls",get:function(){}}]),t}();e.default=N,N.union=b.default,N.transcoordR=S.transcoordR,N.transcoordRR=S.transcoordRR,N.createCanvas=_.createCanvas,N.memoize=y.intercept,N.mixin=l.mixin,N.drawText=P.drawText,N.font=P.font,N.textLines=P.textLines,N.drawStroke=x.default,N.drawFill=m.drawFill,N.reposition=T.default,N.RetentionManager=C.default,N.template=s.default,Object.assign(N.prototype,{drawEffect:k.default,prepareFill:m.prepareFill,prepareFillIf:m.prepareFillIf,onchangeFill:m.onchangeFill,mutateBounds:j.default,mutatePath:A.default,substitute:E.substitute,onchangeMappings:M.onchangeMappings,onchangeData:M.onchangeData,buildMappings:M.buildMappings,executeMappings:M.executeMappings,disposeMappings:M.disposeMappings,transcoordS2P:S.transcoordS2P,transcoordP2S:S.transcoordP2S,transcoordS2T:S.transcoordS2T,transcoordT2S:S.transcoordT2S,transcoordS2TR:S.transcoordS2TR,transcoordS2O:S.transcoordS2O,transcoordC2S:S.transcoordC2S,transcoordS2C:S.transcoordS2C}),["rotatePoint","font","lineHeight","retention"].forEach(function(t){return N.memoize(N.prototype,t,!1)}),["bounds","center","textBounds"].forEach(function(t){return N.memoize(N.prototype,t,!0)}),N.mixin(N.prototype,l.event.withEvent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});"undefined"==typeof window||window;var r="[ERROR]",o="[WARN]",i="[DEBUG]";e.error=function(){for(var t,e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];var i=[];n.forEach(function(t){return t&&t.stack&&i.push(t.stack)}),(t=console).error.apply(t,[r].concat(n,[i.join(" ")]))},e.warn=function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=[];n.forEach(function(t){return t&&t.stack&&i.push(t.stack)}),(t=console).warn.apply(t,[o].concat(n,[i.join(" ")]))},e.debug=function(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=console).log.apply(t,[i].concat(n))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.NOTHING={},e.MODE_VIEW=0,e.MODE_EDIT=1,e.MODE_SHIFT=2,e.MAX_UNDO_SIZE=30,e.DPPX="undefined"==typeof window?1:window.devicePixelRatio||(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1,e.GESTURES=["mousemove","mouseup","mousedown","mouseout","wheel","click","touchstart","touchmove","touchend","dblclick"],e.KEYEVENTS=["keydown","keyup"],e.DEFAULT={ALPHA:1,FONT_SIZE:15,FONT_FAMILY:"serif",FONT_COLOR:"black",TEXT_ALIGN:"center",TEXT_BASELINE:"middle",TEXT_WRAP:!1,BOLD:!1,ITALIC:!1,STROKE_STYLE:"#999",LINE_DASH:"solid"}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"!=(void 0===t?"undefined":a(t))&&(t={});for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.forEach(function(e){for(var n in e)!function(n){"object"!=a(e[n])?t[n]=e[n]:e[n].length>0?t[n]=e[n].map(function(t){return"object"!=a(e[n])?t:o({},t)}):t[n]=o(t[n],e[n])}(n)}),t}function i(t,e,n){if(!t||!e)return t;for(var r in e){if(t[r]&&n)throw new Error('utils.push attempted to overwrite "'+r+'" while running in protected mode');"object"==a(t[r])&&"object"==a(e[r])?i(t[r],e[r]):t[r]=e[r]}return t}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.clone=function(t){return JSON.parse(JSON.stringify(t))},e.merge=o,e.push=i;var u=n(68);Object.defineProperty(e,"debounce",{enumerable:!0,get:function(){return r(u).default}});var s=n(181);Object.defineProperty(e,"throttle",{enumerable:!0,get:function(){return r(s).default}});var c=n(182);Object.defineProperty(e,"once",{enumerable:!0,get:function(){return r(c).default}}),e.uniqueId=function(t){return""+(t||"")+ ++f};var l=n(186);Object.defineProperty(e,"isEmpty",{enumerable:!0,get:function(){return r(l).default}}),e.objToVal=function(t){for(;t&&"object"===(void 0===t?"undefined":a(t));){var e=t;for(var n in t){t=t[n];break}if(t===e){t=void 0;break}}return t};var f=0},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(73));e.default=function(t){var e=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"contains",value:function(t,e){var n=this.model,r=n.left,o=n.top,i=n.width,a=n.height,u=n.lineWidth,s=(void 0===u?0:u)/2;return t<Math.max(r+i,r)+s&&t>Math.min(r+i,r)-s&&e<Math.max(o+a,o)+s&&e>Math.min(o+a,o)-s}},{key:"path",set:function(t){var e=t[0],n=t[2],r=this.model;r.width,r.height;this.set({left:e.x,top:e.y,width:n.x-e.x,height:n.y-e.y})},get:function(){var t=this.model,e=t.left,n=void 0===e?0:e,r=t.top,o=void 0===r?0:r,i=t.width,a=void 0===i?0:i,u=t.height,s=void 0===u?0:u;return[{x:n,y:o},{x:n+a,y:o},{x:n+a,y:o+s},{x:n,y:o+s}]}}]),n}();return o.intercept(e.prototype,"path",!1),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"_post_draw",value:function(t){this.drawFill(t),this.drawStroke(t),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t)}}]),e}();e.default=i},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(44),i="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,a=o||i||Function("return this")();t.exports=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(87)),i=(n(3),function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"execute",value:function(){this.params.changes.forEach(function(t){return t.component.set(t.after)})}}],[{key:"before",value:function(t){return t.map(function(t){return{component:t}})}},{key:"after",value:function(t,e){e.execute(null,!1)}},{key:"around",value:function(t,e,n){e.call(n),t.execute(null,!1)}}]),e}());e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},a=r(n(0)),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(20)),s=n(36),c=r(n(4)),l=r(n(78)),f=[],h=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r._components=[],r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,l.default)((0,c.default)(a.default))),o(e,[{key:"dispose",value:function(){this.components.slice().forEach(function(t){return t.dispose()}),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"isContainer",value:function(){return!0}},{key:"containable",value:function(t){return"variable"!==t.get("type")}},{key:"reflow",value:function(){this.layout.reflow(this),this.components&&this.components.forEach(function(t){t.isContainer()&&t.reflow()})}},{key:"addComponent",value:function(t){var e=t.parent;if(e){if(this===e)return;e.removeComponent(t)}var n=this._components.push(t)-1;t.parent=this,t.added(this),this.trigger("add",this,t,n),t.delegate_on(this),t.trigger("added",this,t,n),this.root&&this.root.isReady&&t.ready()}},{key:"removeComponent",value:function(t){var e=this._components.indexOf(t);-1!=e&&(this._components.splice(e,1),t.parent=null,t.removed(this),this.trigger("remove",this,t),t.trigger("removed",this,t),t.delegate_off(this))}},{key:"insertComponentAt",value:function(t,e){var n=t.parent;n&&n.removeComponent(t);var r=this._components.splice(0,e);this._components=r.concat(t,this._components),e=this._components.indexOf(t),t.parent=this,t.added(this),this.trigger("add",this,t,e),t.delegate_on(this),t.trigger("added",this,t,e)}},{key:"add",value:function(t){var e=this;return t instanceof Array?(t.forEach(function(t){-1==e._components.indexOf(t)&&e.addComponent(t)}),this):this.add.call(this,[t])}},{key:"remove",value:function(t){var e=this;return t instanceof Array?this._components?(t.forEach(function(t){e.removeComponent(t)}),this):this:this.remove.call(this,[t])}},{key:"getAt",value:function(t){if(this._components)return this._components[t]}},{key:"forEach",value:function(t,e){this._components&&this._components.forEach(t,e)}},{key:"traverse",value:function(t,e){t.call(e,this),this._components&&this._components.forEach(function(n){n.isContainer()?n.traverse(t,e):t.call(e,n)})}},{key:"indexOf",value:function(t){return(this._components||f).indexOf(t)}},{key:"size",value:function(){return(this._components||f).length}},{key:"moveChildAt",value:function(t,e){var n=this.indexOf(e);if(-1!=n){var r=this._components.splice(0,n),o=this._components.splice(1);this._components=r.concat(o),t=Math.max(0,t),t=Math.min(t,this._components.length),r=this._components.splice(0,t),this._components=r.concat(e,this._components)}}},{key:"moveChildForward",value:function(t){var e=this.indexOf(t);-1!=e&&e!=this.size()-1&&(this._components[e]=this._components[e+1],this._components[e+1]=t)}},{key:"moveChildBackward",value:function(t){var e=this.indexOf(t);-1!=e&&0!=e&&(this._components[e]=this._components[e-1],this._components[e-1]=t)}},{key:"moveChildToFront",value:function(t){var e=this.indexOf(t);if(-1!=e&&e!=this.size()-1){var n=this._components.splice(0,e),r=this._components.splice(1);this._components=n.concat(r,this._components)}}},{key:"moveChildToBack",value:function(t){var e=this.indexOf(t);if(-1!=e&&0!=e){var n=this._components.splice(0,e),r=this._components.splice(0);this._components=this._components.concat(n,r)}}},{key:"symmetryX",value:function(t){i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"symmetryX",this).call(this,t),this.components.map(function(t){t.symmetryX(0)})}},{key:"findAll",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("string"==typeof t)return u.select(t,this,n[0]||this);if("function"==typeof t){for(var o=[],i=this.components.length-1;i>=0;i--){var a,s=(a=this.components[i]).findAll.apply(a,[t].concat(n));s&&(o=o.concat(s))}return t.apply(void 0,[this].concat(n))&&o.push(this),o}}},{key:"findFirst",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("string"==typeof t)return u.select(t,this,n[0])[0];if("function"==typeof t){for(var o=this.components.length-1;o>=0;o--){var i,a=(i=this.components[o]).findFirst.apply(i,[t].concat(n));if(null!=a)return a}return t.apply(void 0,[this].concat(n))?this:null}}},{key:"findById",value:function(t){return this.root.findById(t)}},{key:"contains",value:function(t,n){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"contains",this).call(this,t,n);if(!r){var o=this.model,a=o.left,u=o.top,s=o.width,c=o.height,l=o.lineWidth,f=void 0===l?0:l,h=this.stuck?0:10+f/2;r=t<Math.max(a+s,a)+h&&t>Math.min(a+s,a)-h&&n<Math.max(u+c,u)+h&&n>Math.min(u+c,u)-h}return r}},{key:"capture",value:function(t,e){var n=this.transcoordP2S(t,e);if(!this.contains(n.x,n.y))return!1;var r=this.bounds;n.x-=r.left,n.y-=r.top;for(var o=this.layout.capturables(this),i=o.length-1;i>=0;i--){var a=o[i].capture(n.x,n.y);if(a)return a}return this.capturable&&this}},{key:"capturePath",value:function(t,e){if(e){if(e.indexOf(this)>-1)return!1;for(var n=0;n<e.length;n++)if(!this.containable(e[n]))return!1}for(var r=[],o=this.bounds,i=o.left,a=o.top,u=o.width,s=o.height,c=0;c<t.length;c++){var l=this.transcoordP2S(t[c].x,t[c].y);if(l.x<i||l.x>i+u||l.y<a||l.y>a+s)return!1;l.x-=i,l.y-=a,r.push(l)}for(var f=this.layout.capturables(this),h=f.length-1;h>=0;h--){var p=f[h];if(p.isContainer()){var d=p.capturePath(r,e);if(d)return d}}return this.focusible&&this}},{key:"_draw",value:function(t){var e=this.bounds,n=e.left,r=void 0===n?0:n,o=e.top,i=void 0===o?0:o,a=e.width,u=e.height;t.beginPath(),t.rect(r,i,a,u),this.drawFill(t),this.drawStroke(t)}},{key:"_post_draw",value:function(t){i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t);var n=this.model,r=n.top,o=n.left;n.scale;t.translate(o,r),this.layout.drawables(this).forEach(function(e){e.draw(t)}),t.translate(-o,-r),this.drawText(t)}},{key:"trim",value:function(){this.components.forEach(function(t){t.trim()}),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trim",this).call(this)}},{key:"showMoveHandle",get:function(){return!0}},{key:"hasTextProperty",get:function(){return!1}},{key:"components",get:function(){return this._components}},{key:"focusible",get:function(){return!0}},{key:"layout",get:function(){return s.Layout.get(this.get("layout"))||s.AbsoluteLayout}},{key:"hierarchy",get:function(){var t=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hierarchy",this);return this.components&&(t.components=this.components.map(function(t){return t.hierarchy})),t}}]),e}();e.default=h,["layout"].forEach(function(t){return a.default.memoize(h.prototype,t,!1)}),a.default.register("container",h)},function(t,e,n){"use strict";var r=n(108),o=n(113);t.exports=function(t,e){var n=o(t,e);return r(n)?n:void 0}},function(t,e,n){"use strict";var r=n(23),o=n(109),i=n(110),a="[object Null]",u="[object Undefined]",s=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?u:a:s&&s in Object(t)?o(t):i(t)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){var e=void 0===t?"undefined":r(t);return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){return null!=t&&"object"==(void 0===t?"undefined":r(t))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o={};e.default={register:function(t,e){o[t]=e},unregister:function(t){delete o[t]},get:function(t){if(t){var e=o[t];return e||(0,r.error)("Layout Not Found - ",t),e}}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},a=r(n(0)),u=r(n(8)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2)),c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return t.translate=t.translate||{x:0,y:0},r._draw_reserved=!1,r.__draw__=function(){r._draw_reserved=!1,r.trigger("redraw"),r.reflow(),r.draw()},r.throttle_draw=function(){r._draw_reserved||requestAnimationFrame(r.__draw__),r._draw_reserved=!0},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),o(e,[{key:"fitSize",value:function(t){if(this.target){var e=getComputedStyle(this.target),n=e?parseFloat(e.getPropertyValue("width")):this.target.offsetWidth,r=e?parseFloat(e.getPropertyValue("height")):this.target.offsetHeight;t.setAttribute("width",n*s.DPPX),t.setAttribute("height",r*s.DPPX),t.style.width=n+"px",t.style.height=r+"px"}}},{key:"resize",value:function(){this.fitSize(this.element)}},{key:"isLayer",value:function(){return!0}},{key:"createElement",value:function(){var t=a.default.createCanvas(1,1);return t.style.position="absolute",t}},{key:"dispose",value:function(){i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this),this.target=null,this.element=null}},{key:"getContext",value:function(){return this._context2D||(this._context2D=this.canvas&&this.canvas.getContext("2d")),this._context2D}},{key:"draw",value:function(t){this.canvas&&(t=t||this.getContext())&&i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t)}},{key:"_pre_draw",value:function(t){var e=this.model,n=e.translate,r=e.scale,o=void 0===r?{x:1,y:1}:r,i=e.rotation;t.clearRect(0,0,t.canvas.width,t.canvas.height),n&&t.translate(n.x*s.DPPX,n.y*s.DPPX),t.scale(o.x*s.DPPX,o.y*s.DPPX),i&&t.rotate(i)}},{key:"contains",value:function(t,e){return!1}},{key:"invalidate",value:function(){this.throttle_draw()}},{key:"move",value:function(t){var e=this.get("translate")||{x:0,y:0};this.set({translate:{x:e.x+t.x,y:e.y+t.y}})}},{key:"target",get:function(){return this._target},set:function(t){this._target&&this.element&&this._target.removeChild(this.element),this._target=t,t&&(this.element||(this.element=this.createElement()),this.resize(),t.appendChild(this.element))}},{key:"canvas",get:function(){return this.element}},{key:"selected",get:function(){return this.root.selected},set:function(t){this.root.selected=t}},{key:"focused",get:function(){return this.root.focused},set:function(t){this.root.focused=t}},{key:"rotatePoint",get:function(){return{x:0,y:0}}}]),e}();e.default=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){for(var e=0;t&&!t.isRootModel();)e+=t.get("rotation")||0,t=t.parent;return e%(2*Math.PI)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=(r(n(0)),r(n(87))),u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),i(e,[{key:"execute",value:function(){this.params.changes.forEach(function(t){var e=t.component,n=t.to_container,r=t.to_index,i=t.to_left,a=t.to_top,u=(t.hint,function(t){if(t.isRootModel())return t.bounds;var e=t.bounds,n=t.rotatePoint,r=n;return r=t.transcoordS2T(r.x,r.y),{left:r.x-(n.x-e.left),top:r.y-(n.y-e.top),width:e.width,height:e.height}}(e)),s=o(e);if(e.removeSelf(!n),e.bounds=u,e.set("rotation",s),n){e.set("rotation",function(t,e){return((t.get("rotation")||0)-o(e))%(2*Math.PI)}(e,n));var c=function(t,e){if(e.isRootModel())return t.bounds;var n=t.bounds,r=t.rotatePoint,o=e.transcoordT2S(r.x,r.y),i=e.bounds;return{left:o.x-(r.x-n.left)-i.left,top:o.y-(r.y-n.top)-i.top,width:n.width,height:n.height}}(e,n);t.to_left=void 0!==i?i:c.left,t.to_top=void 0!==a?a:c.top,e.bounds={left:t.to_left,top:t.to_top,width:c.width,height:c.height},void 0===r?n.addComponent(e):n.insertComponentAt(e,r)}})}}]),e}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(71)),i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.client=e,this.config=n,this._started=!1;var r=this.config,i=r.delta,a=void 0===i?"linear":i,u=r.options,s=r.ease;"string"==typeof a&&(a=o.default[a]),this.delta="out"==s?function(t,e){return function(n){return 1-t(1-n,e)}}(a,u):"inout"==s?function(t,e){return function(n){return n<.5?t(2*n,e)/2:(2-t(2*(1-n),e))/2}}(a,u):a,this.init()}return r(t,[{key:"dispose",value:function(){this.stop(),delete this.client}},{key:"init",value:function(){}},{key:"start",value:function(){var t=this;if(!this._started){var e=this.config,n=e.duration,r=void 0===n?2e3:n,o=e.delay,i=void 0===o?0:o,a=e.repeat,u=void 0!==a&&a;this._started=!0,setTimeout(function(){var e=0;t._raf=requestAnimationFrame(function n(){if(t._started){0==e&&(e=performance.now(),t.client.touch());var o=performance.now()-e,a=i/r,s=o/r,c=u?s%(1+a):Math.min(s,1);c=Math.max(c-a,0),t.step(t.delta(c)),t.client&&t.client.invalidate(),!(s>=1)||u&&t._started||(t.stop(),e=0),t._started&&(t._raf=requestAnimationFrame(n))}})},0)}}},{key:"stop",value:function(){this._raf&&cancelAnimationFrame(this._raf),this._raf=null,this._started=!1}},{key:"started",get:function(){return this._started},set:function(t){this.started!=!!t&&(t?this.start():this.stop())}}]),t}();e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(79);Object.defineProperty(e,"compile",{enumerable:!0,get:function(){return r(o).default}});var i=n(88);Object.defineProperty(e,"duplicate",{enumerable:!0,get:function(){return r(i).default}});var a=n(20);Object.defineProperty(e,"select",{enumerable:!0,get:function(){return a.select}}),Object.defineProperty(e,"match",{enumerable:!0,get:function(){return a.match}})},function(t,e,n){"use strict";t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){"use strict";var r=Array.isArray;t.exports=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=e.get("class");return!!o&&(o.split(" ")||[]).indexOf(t.substr(1))>=0}function o(t,e,n,r){return t==e.get("type")}function i(t,e,n,r,o,a){return t(e,n,r,o)&&a.push(n),n.components&&n.components.forEach(function(n){i(t,e,n,r,o,a)}),a}Object.defineProperty(e,"__esModule",{value:!0}),e.match=function(t,e,n,i){if("(all)"==t)return!0;switch(t.charAt(0)){case"#":return function(t,e,n,r){return t.substr(1)==e.get("id")}(t,e);case".":return r(t,e);case"(":return function(t,e,n,r){switch(t){case"(all)":return!0;case"(self)":return r===e;case"(root)":return!r.parent&&r===e;case"(descendant)":return r!==e;case"(child)":return r===e.parent;default:return!1}}(t,e,0,i);default:return o(t,e)}},e.select=function(t,e,n){if("(root)"==t)return[e];if("(self)"==t)return n?[n]:[];var a;switch(t.charAt(0)){case"#":var u=e.root.findById(t.substr(1));return u?[u]:[];case".":a=r;break;case"(":a=function(t,e,n,r){switch(t){case"(all)":return!0;case"(parent)":return n&&n.parent===e;case"(child)":case"(children)":return n&&n===e.parent;case"(sibling)":case"(siblings)":return n&&n.parent===e.parent&&n!==e;default:return!1}};break;default:a=o}return i(a,t,e,n,e,[])}},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(98),i=n(99),a=n(100),u=n(101),s=n(102);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},function(t,e,n){"use strict";var r=n(18);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){"use strict";var r=n(6).Symbol;t.exports=r},function(t,e,n){"use strict";var r=n(9)(Object,"create");t.exports=r},function(t,e,n){"use strict";var r=n(122);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){"use strict";var r=n(43),o=n(53);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);Object.defineProperty(e,"logger",{enumerable:!0,get:function(){return r(o).default}});var i=n(179);Object.defineProperty(e,"event",{enumerable:!0,get:function(){return r(i).default}});var a=n(70);Object.defineProperty(e,"mixin",{enumerable:!0,get:function(){return r(a).default}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},a=r(n(8)),u=r(n(0)),s=["left","top","width","height","rotation","animation"],c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"isGroup",value:function(){return!0}},{key:"get",value:function(t){return this._model[t]}},{key:"set",value:function(t,n){if("string"==typeof t)return this.set(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,n));var r=s.reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{});return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,r)}},{key:"capture",value:function(t,n){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"capture",this).call(this,t,n);if(!this.app.isEditMode)return r;if(this.parent.isGroup())return r&&r!==this&&r;for(var o=0;o<this.root.selected.length;o++){for(var a=this.root.selected[o];a!==this&&(a.isGroup()||a.parent.isGroup());)a=a.parent;if(a===this)return r&&r!==this&&r}return r&&r!==this&&this}},{key:"calculateBounds",value:function(){this.clearCache(),this.__MUTATING__=!0,this.mutateBounds(function(t){var e=u.default.union(this.components.map(function(t){return t.bounds}));return this.components.forEach(function(t){var n=t.bounds;t.bounds={left:n.left-e.left,top:n.top-e.top,width:n.width,height:n.height}}),{left:t.left+e.left,top:t.top+e.top,width:e.width,height:e.height}},this),this.__MUTATING__=!1,this.parent.isGroup()&&this.parent.calculateBounds()}},{key:"_draw",value:function(t){}},{key:"_post_draw",value:function(t){var e=this.model,n=e.top,r=e.left;e.scale;t.translate(r,n),this.layout.drawables(this).forEach(function(e){e.draw(t)}),t.translate(-r,-n)}},{key:"bounds",set:function(t){if(this.__MUTATING__)(function t(e,n,r,o){var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var a=Object.getPrototypeOf(e);null!==a&&t(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var u=i.set;void 0!==u&&u.call(o,r)}return r})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bounds",t,this);else{var n=this.bounds,r={x:t.width/n.width,y:t.height/n.height};this.path=this.path.map(function(e){return{x:t.left+(e.x-n.left)*r.x,y:t.top+(e.y-n.top)*r.y}}),this.components&&this.components.forEach(function(t){if(t.mutable)t.mutatePath(null,function(t){return t.map(function(t){return{x:t.x*r.x,y:t.y*r.y}})});else{var e=t.bounds,n=t.center,o={x:n.x*(1-r.x),y:n.y*(1-r.y)},i=e.width*(1-r.x),a=e.height*(1-r.y),u=-(o.x-i/2),s=-(o.y-a/2);t.bounds={left:e.left+u,top:e.top+s,width:e.width*r.x,height:e.height*r.y}}})}},get:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bounds",this)}},{key:"focusible",get:function(){return!1}}]),e}();e.default=c,u.default.register("group",c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={};e.default={register:function(t,e){r[t]=e},unregister:function(t){delete r[t]},get:function(t){return r[t]}}},function(t,e,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";var r=n(9)(n(6),"Map");t.exports=r},function(t,e,n){"use strict";(function(t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(6),i=n(144),a="object"==r(e)&&e&&!e.nodeType&&e,u=a&&"object"==r(t)&&t&&!t.nodeType&&t,s=u&&u.exports===a?o.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;t.exports=c}).call(e,n(51)(t))},function(t,e,n){"use strict";var r=n(145),o=n(146),i=n(147),a=i&&i.isTypedArray,u=a?o(a):r;t.exports=u},function(t,e,n){"use strict";var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.state,n=e.id,u=e.scale,s=void 0===u?i:u,c=(e.translate,e.bold),l=e.italic,f=e.fontFamily,h=void 0===f?"":f,p=e.textAlign,d=e.textBaseline,y=e.paddingTop,v=void 0===y?0:y,g=e.paddingBottom,b=void 0===g?0:g,_=e.paddingLeft,m=void 0===_?0:_,w=e.paddingRight,x=void 0===w?0:w,k=e.fontSize,O=void 0===k?r.DEFAULT.FONT_SIZE:k,P=e.lineWidth,A=void 0===P?0:P,j=e.lineDash,E=t.state.class,M=(t.text,t.strokeStyle),S=(t.fillStyle,t.rotation),T=void 0===S?0:S,C=t.fontColor,R=t.hidden,I=t.bounds,L=I.left,D=I.top,B=I.width,F=I.height,N=t.element;N.hidden=R,n&&(N.id=n),E&&(N.className=E),Object.assign(N.style,a,{fontFamily:h,fontSize:O+"px",left:L+"px",top:D+"px",width:B+"px",height:F+"px",paddingTop:v+"px",paddingRight:x+"px",paddingBottom:b+"px",paddingLeft:m+"px",border:A+"px",borderColor:M,borderStyle:A>0?j||r.DEFAULT.LINE_DASH:"",color:C,fontWeight:c?"bold":"",fontStyle:l?"italic":"",textAlign:"end"==p?"right":"start"==p?"left":"",verticalAlign:d}),(0,o.default)(t);var Y=t.delta(),z=(s&&s.x||1)*Y.sx,U=(s&&s.y||1)*Y.sy,W=(T||0)+Y.theta,G=Y.tx||0,H=Y.ty||0;["-webkit-","-moz-","-ms-","-o-",""].forEach(function(t){N.style[t+"transform"]="rotate("+W+"rad) translate("+G+"px, "+H+"px) scale("+z+", "+U+")"})};var r=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(n(214)),i={x:1,y:1},a={boxSizing:"border-box",margin:"0px",position:"absolute",outline:"none",display:"inline-block"}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(13);Object.defineProperty(e,"Layout",{enumerable:!0,get:function(){return r(o).default}});var i=n(216);Object.defineProperty(e,"AbsoluteLayout",{enumerable:!0,get:function(){return r(i).default}});var a=n(217);Object.defineProperty(e,"CardLayout",{enumerable:!0,get:function(){return r(a).default}});var u=n(218);Object.defineProperty(e,"LinearHorizontalLayout",{enumerable:!0,get:function(){return r(u).default}});var s=n(219);Object.defineProperty(e,"LinearVerticalLayout",{enumerable:!0,get:function(){return r(s).default}});var c=n(220);Object.defineProperty(e,"TableLayout",{enumerable:!0,get:function(){return r(c).default}});var l=n(221);Object.defineProperty(e,"HTMLAbsoluteLayout",{enumerable:!0,get:function(){return r(l).default}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u=r(n(224)),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_draw",value:function(t){var e=this.model,n=e.cx,r=e.cy,o=e.rx,i=e.ry,a=e.startAngle,u=e.endAngle,s=e.anticlockwise;t.beginPath(),t.ellipse(n,r,Math.abs(o),Math.abs(i),0,a||0,u||2*Math.PI,s)}},{key:"contains",value:function(t,e){var n=this.model,r=n.cx,o=n.cy,i=(t-r)/(2*n.rx-.5),a=(e-o)/(2*n.ry-.5);return i*i+a*a<.25}},{key:"outline",value:function(t){return(0,u.default)(this,t)}},{key:"path",get:function(){var t=this.model,e=t.cx,n=t.cy,r=t.rx,o=t.ry;return[{x:e-r,y:n-o},{x:e+r,y:n-o},{x:e+r,y:n+o},{x:e-r,y:n+o}]},set:function(t){var e=t[0],n=t[2];this.set({cx:e.x+(n.x-e.x)/2,cy:e.y+(n.y-e.y)/2,rx:(n.x-e.x)/2,ry:(n.y-e.y)/2})}}]),e}();e.default=s,i.default.memoize(s.prototype,"path",!1),i.default.register("ellipse",s)},function(t,e,n){"use strict";(function(t){function n(e){return new t(e).toString("base64")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.license=function(t){u.key=t};var o={},i=!1,a=!1,u=e.License=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"isHostnameValid",value:function(){var e=location.hostname;if(""===e)return!0;for(var n=t.hostname.split(","),r=0;r<n.length;r++){if(t.matchLicenseHost(n[r].trim(),t.baseUrl))return!0;if(t.matchLicenseHost(n[r].trim(),e))return!0}return!1}},{key:"matchLicenseHost",value:function(e,n){if(n="127.0.0.1"==n?"localhost":n,e="127.0.0.1"==e?"localhost":e,n==e)return"localhost"!=e||"Production"!=t.licenseType;var r=e.split("."),o=n.split(".");if(r.length==o.length){for(var i=0;i<r.length;i++){var a=r[i],u=o[i];if(!("*"==a||a==u))return!1}return!0}return!1}},{key:"isUnlimited",value:function(){return"UNLIMITED"==t.expirationDate}},{key:"isUnexpired",value:function(){if(t.isUnlimited())return!0;var e=new Date;return t.expirationDate>e}},{key:"isKeyValid",value:function(){JSON.stringify(o,null," ");return o.Key==function(t,e){var r=JSON.parse(JSON.stringify(t));delete r.Key;var o=[];return n(JSON.stringify(r)).split("").forEach(function(t,n){o.push(String.fromCharCode(Math.abs(t.charCodeAt()-e[n%e.length].charCodeAt())))}),n(o.join(""))}(o,"hatio lab.")}},{key:"certified",get:function(){if(a)return a;if(!t.key)return!1;try{for(var e=Number(t.key.charAt(0)),n=Number(t.key.substring(t.key.length-e)),r=t.key.substring(1,t.key.length-e),i=0,u=0;u<r.length;u++)i+=r.charCodeAt(u);return i===n&&(o=JSON.parse(atob(r)),a=!0)}catch(t){return console.error("license invalid"),!1}}},{key:"key",get:function(){return t._key},set:function(e){t._key=e,i=!1,a=!1}},{key:"licenseType",get:function(){return o["License Type"]}},{key:"expirationDate",get:function(){var t=o["Expiration Date"]||"";if("UNLIMITED"==t)return t;var e=t.split(".");return t&&3==e.length&&(t=new Date(e[0],e[1],e[2])),t}},{key:"hostname",get:function(){return o.Hostname}},{key:"licenseKey",get:function(){return o.Key}},{key:"baseUrl",get:function(){return t._baseUrl||""},set:function(e){t._baseUrl=e}},{key:"valid",get:function(){return!!t.certified&&(i||(i=t.isKeyValid()&&t.isHostnameValid()&&t.isUnexpired()),i)}}]),t}()}).call(e,n(243).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){t instanceof Array||(t=[t]),n||(n=this.model_layer);var i=[];this.selected=t.map(function(t){var o=e.left,a=e.top,u=e.width,s=e.height,c=e.x,l=e.y,f=e.cx,h=e.cy,p=r.compile(t,n.app);return isNaN(o)||isNaN(a)||isNaN(u)||isNaN(s)||(p.bounds={left:o,top:a,width:u,height:s}),isNaN(c)||isNaN(l)||p.move({x:c,y:l}),isNaN(f)||isNaN(h)||(p.center={x:f,y:h}),i.push({component:p,to_container:n}),p}),this.app.commander.execute(new o.default({changes:i}))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(17)),o=function(t){return t&&t.__esModule?t:{default:t}}(n(15))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=this.selected;this.selected=[];for(var e=null,n=t.filter(function(t){return!t.isRootModel()&&(t.parent.focusible||t.parent.isGroup())}).map(function(t){return e||(e=t.parent),{component:t,to_container:null}});e&&e.isGroup()&&"break"!==function(){var t=[];if(e.components.filter(function(t){return!n.find(function(e){return e.component===t})}).forEach(function(e){return t.push(e)}),t.length>1)return"break";var r=e.parent;t.forEach(function(t){return n.push({component:t,to_container:r})}),n.push({component:e,to_container:null}),e=r}(););n.length>0&&this.app.commander.execute(new r.default({changes:n})),e&&e.calculateBounds&&e.calculateBounds()};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(15))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=13.3;e.default={screen:function(t){return void 0!==t&&(r=t),r}}},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=o(n(0)),u=o(n(8)),s=o(n(222)),c=r(n(17)),l=r(n(259)),f=r(n(261)),h=r(n(265)),p=r(n(3)),d=r(n(86)),y=n(1),v=[];"undefined"!=typeof window&&window.addEventListener("resize",function(){v.forEach(function(t){t.resize()})});var g=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Object.assign({type:"root",scale:{x:1,y:1}},t||{}),n));return t=t||{},r._app=n,r.target_element=t.target_element,r.rebuildContentModel(r.model.model),v.push(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),i(e,[{key:"dispose",value:function(){this._app&&this._app.dispose(),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this),this._disposeAllResources(),this.target_element=null,delete this._refresh_mapping_debouncer,d.hide(this);var t=v.indexOf(this);t>=0&&v.splice(t,1)}},{key:"isRoot",value:function(){return!0}},{key:"variable",value:function(t,e){var n=this.findById(t);if(!n){var r=this.findTemplateFor(t);if(!r)return;var o=Object.assign(p.clone(r.hierarchy),{id:t,templatePrefix:""});n=c.compile(o,this.app),this.model_layer.addComponent(n)}if(void 0===e)return n.data;n.data=e,n.touch()}},{key:"buildVariables",value:function(t){var e=this;!t||t instanceof Array||(t=Object.keys(t).map(function(e){var n=t[e];return n.key=e,n})),t&&t.forEach(function(t,n){var r=e.indexMap[t.key];if(r)r.set({data:t.value,mappings:t.mappings&&t.mappings.slice(),dataType:t.dataType});else{var o=c.compile({type:"variable",id:t.key,left:-120,top:0+20*n,strokeStyle:"black",width:100,height:20,dataType:t.type,data:t.value,mappings:t.mappings&&t.mappings.slice()},e.app);e.model_layer.addComponent(o)}})}},{key:"addTemplate",value:function(t,e){var n=this.templateMap[t];n&&(0,y.error)("Template replaced (duplicated)",t,e,n),this.templateMap[t]=e,delete this.templatePrefixes}},{key:"removeTemplate",value:function(t,e){var n=this.templateMap[t];n!==e?(0,y.warn)("Removing template failed (different)",t,e,n):delete this.templateMap[t],delete this.templatePrefixes}},{key:"findTemplateFor",value:function(t){this.templatePrefixes||(this.templatePrefixes=Object.keys(this.templateMap).sort().reverse());var e=this.templatePrefixes.find(function(e){return t.startsWith(e)});if(e)return this.templateMap[e]}},{key:"addIndex",value:function(t,e){var n=this.indexMap[t];n&&(0,y.error)("Index replaced (duplicated)",t,e,n),this.indexMap[t]=e}},{key:"removeIndex",value:function(t,e){var n=this.indexMap[t];n!==e?(0,y.warn)("Removing index failed (different)",t,e,n):delete this.indexMap[t]}},{key:"findById",value:function(t){return this.indexMap[t]}},{key:"findOrCreate",value:function(t){var e=this.indexMap[t];if(!e){var n=this.findTemplateFor(t);if(n){var r=Object.assign(p.clone(n.hierarchy),{id:t,templatePrefix:""});e=c.compile(r,this.app),this.model_layer.addComponent(e)}}return e}},{key:"resize",value:function(){this.components.forEach(function(t){t.resize&&t.resize()}),this.invalidate()}},{key:"_disposeAllResources",value:function(){var t=this;this.selected=[],this._focused=null,this._ready=!1,this.eventEngine&&(this.assist_handlers&&this.assist_handlers.forEach(function(e){t.eventEngine.remove(e)}),this.eventEngine.dispose(),delete this.eventEngine),this.assist_layers&&this.assist_layers.forEach(function(e){e.dispose(),t.removeComponent(e)}),delete this.assist_layers,this.model_layer&&this.model_layer.dispose(),this.model_layer&&this.removeComponent(this.model_layer),delete this.model_layer,this.indexMap={},this.templateMap={}}},{key:"rebuildContentModel",value:function(t){var e=this;this._disposeAllResources(),this.eventEngine=new f.Engine(this),(t=t||{}).type="model-layer";var n=t.variables;delete t.variables,this.model_layer=c.compile(t,this.app),this.model_layer.target=this.target_element,this.addComponent(this.model_layer),n&&this.buildVariables(n),this.assist_layers=(this.model.layers||[]).map(function(t){var n=c.compile(t,e.app);return n.target=e.target_element,e.addComponent(n),n}),this.assist_handlers=(this.model.handlers||[]).map(function(t){var n={};return e.eventEngine.add(n,h.EventMap.get(t)),n}),this._ready=!0,this.traverse(function(t){return t.ready()})}},{key:"draw",value:function(){this.components.forEach(function(t){return t.draw()})}},{key:"contains",value:function(t,e){return!0}},{key:"capturePath",value:function(t,e){return this.model_layer.capturePath(t,e)}},{key:"invalidate",value:function(){this.components.forEach(function(t){return t.invalidate()})}},{key:"refreshMappings",value:function(){if(!this._refresh_mapping_debouncer){if(this.disposed)return;this._refresh_mapping_debouncer=p.debounce(function t(e){e.executeMappings(),e.components&&e.components.forEach(function(e){return t(e)})},1e3)}this._refresh_mapping_debouncer(this.model_layer)}},{key:"_addTraverse",value:function(t){var e=this;t.components&&t.components.forEach(function(t){return e._addTraverse(t)});var n=t.model,r=n.id,o=n.templatePrefix;r&&this.addIndex(r,t),o&&this.addTemplate(o,t);var i=p.merge({},t.eventMap,t.model.eventMap);this.eventEngine.add(t,i)}},{key:"_removeTraverse",value:function(t){var e=this;t.components&&t.components.forEach(function(t){return e._removeTraverse(t)});var n=t.model,r=n.id,o=n.templatePrefix;r&&this.removeIndex(r,t),o&&this.removeTemplate(o,t),this.eventEngine.remove(t)}},{key:"onadded",value:function(t,e){this._addTraverse(e),this.refreshMappings(),this.invalidate()}},{key:"onremoved",value:function(t,e){this._removeTraverse(e),this.invalidate()}},{key:"onchanged",value:function(t,e,n){e.templatePrefix&&this.removeTemplate(e.templatePrefix,n.origin),t.templatePrefix&&this.addTemplate(t.templatePrefix,n.origin),e.id&&this.removeIndex(e.id,n.origin),t.id&&this.addIndex(t.id,n.origin),e.id==t.id&&e.class==t.class||this.refreshMappings()}},{key:"app",get:function(){return this._app}},{key:"target_element",get:function(){return this._target_element},set:function(t){this._ua_event_handler&&(this._ua_event_handler.dispose(),delete this._ua_event_handler),t&&(this._ua_event_handler=new f.UAEventHandler(this,t)),this.forEach(function(e){return e.target=t}),this._target_element=t}},{key:"unitScale",get:function(){switch(this.model_layer.get("unit")){case"mm":case"cm":case"in":return this.app.PPM/10;case"px":default:return 1}}},{key:"root",get:function(){return this}},{key:"isReady",get:function(){return this._ready}},{key:"rootModel",get:function(){return this.model_layer}},{key:"stuck",get:function(){return!0}},{key:"data",get:function(){return Object.values(this.indexMap).reduce(function(t,e){return t[e.model.id]=e.data,t},{})},set:function(t){for(var e in t){var n=this.findOrCreate(e);n&&(n.data=t[e])}}},{key:"selected",get:function(){return(this._selected||[]).filter(function(t){return t.parent})},set:function(t){var e=this._selected;this._selected=t,this.trigger("selected",t,e)}},{key:"focused",get:function(){return this._focused},set:function(t){this._focused!==t&&(this._focused=t,this.invalidate())}},{key:"style",get:function(){return this._style},set:function(t){this._style=t,this._compiled_style=l.compile(t)}},{key:"hasTextProperty",get:function(){return!1}},{key:"eventMap",get:function(){return{"(root)":{"(descendant)":{added:this.onadded,removed:this.onremoved,change:this.onchanged}}}}}]),e}();e.default=g,Object.assign(g.prototype,{fit:s.default}),a.default.memoize(g.prototype,"unitScale",!1)},function(t,e,n){"use strict";var r=n(10),o=n(11),i="[object AsyncFunction]",a="[object Function]",u="[object GeneratorFunction]",s="[object Proxy]";t.exports=function(t){if(!o(t))return!1;var e=r(t);return e==a||e==u||e==i||e==s}},function(t,e,n){"use strict";(function(e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="object"==(void 0===e?"undefined":n(e))&&e&&e.Object===Object&&e;t.exports=r}).call(e,n(30))},function(t,e,n){"use strict";var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(114),i=n(121),a=n(123),u=n(124),s=n(125);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},function(t,e,n){"use strict";var r=n(126),o=n(129),i=n(130),a=1,u=2;t.exports=function(t,e,n,s,c,l){var f=n&a,h=t.length,p=e.length;if(h!=p&&!(f&&p>h))return!1;var d=l.get(t);if(d&&l.get(e))return d==e;var y=-1,v=!0,g=n&u?new r:void 0;for(l.set(t,e),l.set(e,t);++y<h;){var b=t[y],_=e[y];if(s)var m=f?s(_,b,y,e,t,l):s(b,_,y,t,e,l);if(void 0!==m){if(m)continue;v=!1;break}if(g){if(!o(e,function(t,e){if(!i(g,e)&&(b===t||c(b,t,n,s,l)))return g.push(e)})){v=!1;break}}else if(b!==_&&!c(b,_,n,s,l)){v=!1;break}}return l.delete(t),l.delete(e),v}},function(t,e,n){"use strict";var r=n(49),o=n(54),i=n(26);t.exports=function(t){return i(t)?r(t):o(t)}},function(t,e,n){"use strict";var r=n(142),o=n(50),i=n(19),a=n(32),u=n(52),s=n(33),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=i(t),l=!n&&o(t),f=!n&&!l&&a(t),h=!n&&!l&&!f&&s(t),p=n||l||f||h,d=p?r(t.length,String):[],y=d.length;for(var v in t)!e&&!c.call(t,v)||p&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||u(v,y))||d.push(v);return d}},function(t,e,n){"use strict";var r=n(143),o=n(12),i=Object.prototype,a=i.hasOwnProperty,u=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(t){return o(t)&&a.call(t,"callee")&&!u.call(t,"callee")};t.exports=s},function(t,e,n){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){"use strict";var r=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},function(t,e,n){"use strict";var r=n(34),o=n(148),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){"use strict";t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){"use strict";var r=n(149),o=n(31),i=n(150),a=n(151),u=n(152),s=n(10),c=n(45),l=c(r),f=c(o),h=c(i),p=c(a),d=c(u),y=s;(r&&"[object DataView]"!=y(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=y(new o)||i&&"[object Promise]"!=y(i.resolve())||a&&"[object Set]"!=y(new a)||u&&"[object WeakMap]"!=y(new u))&&(y=function(t){var e=s(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case d:return"[object WeakMap]"}return e}),t.exports=y},function(t,e,n){"use strict";var r=n(58);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){"use strict";var r=n(9),o=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e,n){"use strict";var r=n(60),o=n(158),i=n(159);t.exports=function(t,e){return i(o(t,e,r),t+"")}},function(t,e,n){"use strict";t.exports=function(t){return t}},function(t,e,n){"use strict";t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(18),i=n(26),a=n(52),u=n(11);t.exports=function(t,e,n){if(!u(n))return!1;var s=void 0===e?"undefined":r(e);return!!("number"==s?i(n)&&a(e,n.length):"string"==s&&e in n)&&o(n[e],t)}},function(t,e,n){"use strict";var r=n(10),o=n(12),i=n(167),a="[object DOMException]",u="[object Error]";t.exports=function(t){if(!o(t))return!1;var e=r(t);return e==u||e==a||"string"==typeof t.message&&"string"==typeof t.name&&!i(t)}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},function(t,e,n){"use strict";t.exports=/<%=([\s\S]+?)%>/g},function(t,e,n){"use strict";var r=n(176);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(10),i=n(12),a="[object Symbol]";t.exports=function(t){return"symbol"==(void 0===t?"undefined":r(t))||i(t)&&o(t)==a}},function(t,e,n){"use strict";var r=n(11),o=n(180),i=n(69),a="Expected a function",u=Math.max,s=Math.min;t.exports=function(t,e,n){function c(e){var n=d,r=y;return d=y=void 0,m=e,g=t.apply(r,n)}function l(t){var n=t-_;return void 0===_||n>=e||n<0||x&&t-m>=v}function f(){var t=o();if(l(t))return h(t);b=setTimeout(f,function(t){var n=e-(t-_);return x?s(n,v-(t-m)):n}(t))}function h(t){return b=void 0,k&&d?c(t):(d=y=void 0,g)}function p(){var t=o(),n=l(t);if(d=arguments,y=this,_=t,n){if(void 0===b)return function(t){return m=t,b=setTimeout(f,e),w?c(t):g}(_);if(x)return b=setTimeout(f,e),c(_)}return void 0===b&&(b=setTimeout(f,e)),g}var d,y,v,g,b,_,m=0,w=!1,x=!1,k=!0;if("function"!=typeof t)throw new TypeError(a);return e=i(e)||0,r(n)&&(w=!!n.leading,v=(x="maxWait"in n)?u(i(n.maxWait)||0,e):v,k="trailing"in n?!!n.trailing:k),p.cancel=function(){void 0!==b&&clearTimeout(b),m=0,d=_=y=b=void 0},p.flush=function(){return void 0===b?g:h(o())},p}},function(t,e,n){"use strict";var r=n(11),o=n(67),i=NaN,a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return i;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=s.test(t);return n||c.test(t)?l(t.slice(2),n?2:8):u.test(t)?i:+t}},function(t,e,n){"use strict";function r(t,e){if(e instanceof Array)e.forEach(function(e){return r(t,e)});else{if(t.mixedIn=t.hasOwnProperty("mixedIn")?t.mixedIn:[],t.mixingIn=t.hasOwnProperty("mixingIn")?t.mixingIn:[],t.mixedIn.indexOf(e)>=0)return t;if(t.mixingIn.indexOf(e)>=0)throw new Error("found cyclic dependencies between "+t.mixingIn);t.mixingIn.push(e),e.call(t),t.mixingIn.pop(),t.mixedIn.push(e)}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){return t}function o(t){return Math.pow(t,2)}function i(t){return 1-Math.sin(Math.acos(t))}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:1.5};return Math.pow(t,2)*((e.x+1)*t-e.x)}function u(t){for(var e=0,n=1;1;e+=n,n/=2)if(t>=(7-4*e)/11)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(n,2)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:1.5};return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e.x/3*t)}Object.defineProperty(e,"__esModule",{value:!0}),e.linear=r,e.quad=o,e.circ=i,e.back=a,e.bounce=u,e.elastic=s,e.default={linear:r,quad:o,circ:i,back:a,bounce:u,elastic:s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setShadow=function(t,e,n){var o=e.left,i=void 0===o?0:o,a=e.top,u=void 0===a?0:a,s=e.blurSize,c=void 0===s?0:s,l=e.color,f=void 0===l?"transparent":l,h=n.rootModel.get("scale")||r;t.shadowOffsetX=i*h.x,t.shadowOffsetY=u*h.y,t.shadowBlur=c*h.x,t.shadowColor=f},e.resetShadow=function(t){t.shadowColor="transparent"};var r={x:1,y:1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.intercept=function(t,e,n){var i=t.__lookupGetter__(e);i?n?t.__defineGetter__(e,function(){return void 0===this.__cache__[e]&&(this.__cache__[e]=i.call(this)),r.clone(this.__cache__[e])}):t.__defineGetter__(e,function(){return void 0===this.__cache__[e]&&(this.__cache__[e]=i.call(this)),this.__cache__[e]}):(0,o.error)(e+" is not defined in "+t.constructor.name)},e.reset=function(t){t.__cache__={}},e.clear=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0==n.length?t.__cache__={}:n.forEach(function(e){return delete t.__cache__[e]})};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(3)),o=n(1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.duration,n=void 0===e?1e3:e,o=(t.delay,t.step),i=t.delta,a=t.ease,u=t.options,s=t.repeat,c=void 0!==s&&s;"string"==typeof i&&(i=r.default[i]),"out"==a?i=function(t,e){return function(n){return 1-t(1-n,e)}}(i,u):"inout"==a&&(i=function(t,e){return function(n){return n<.5?t(2*n,e)/2:(2-t(2*(1-n),e))/2}}(i,u));var l=!1;return{start:function(){var t=this;if(l)return this;l=!0;var e=0;return requestAnimationFrame(function r(){if(l){0==e&&(e=performance.now());var a=(performance.now()-e)/n,s=c?a%1:Math.min(a,1);o(i(s,u)),!(a>=1)||c&&l||(t.stop(),e=0),l&&requestAnimationFrame(r)}}),this},stop:function(){return l=!1,this}}};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(71))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.createCanvas=void 0,e.createElement=void 0;"undefined"==typeof document?e.createCanvas=function(t,e){return new Canvas(t,e)}:e.createCanvas=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r){var o=String(e).split("\n");return r?[].concat.apply([],o.map(function(e){return function(t,e,n){var r,o,i=e.split(" "),a=[],u=[];for(r=0,o=1;o<=i.length;o++)if(u=i.slice(r,o),t.measureText(u.join(" ")).width>n){if(o-r==1){var s=function(t,e,n){if(e.length<2)return e;for(var r=2;r<e.length;r++){var o=e.substring(0,r);if(!(t.measureText(o).width<n))break}return e.substring(0,r-1)}(t,u[0],n);a.push([s]),i.splice(r,1,s,u[0].substring(s.length))}else{for(;""==i[o-1];)o++;a.push(i.slice(r,--o))}r=o}return o-r>1&&a.push(u),0==a.length&&a.push([""]),a}(t,e,n)})):o.map(function(t){return t.split(" ")})}},function(t,e,n){"use strict";function r(t){var e=t.substr(2,t.length-3).trim().replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".").filter(function(t){return!!t.trim()}),n=e.slice(1);return{match:t,target:e[0],accessor:n.length>0?function(t){return n.reduce(function(t,e){return t?t[e]:void 0},t)}:i}}Object.defineProperty(e,"__esModule",{value:!0}),e.substitute=function(t){var e=this;if(t){var n=String(t),i=(n.match(/#{(\S*)}/gi)||[]).map(function(t){return r(t)}),a=(n.match(/\${[^}]*}/gi)||[]).map(function(t){return r(t)});if(0==i.length&&0==a.length)return n;var u=n;return i.forEach(function(t){var n=(0,o.objToVal)(t.accessor(e.getState(t.target)));u=u.replace(t.match,void 0===n?"":n)}),a.forEach(function(t){var n=e.root.findById(t.target),r=(0,o.objToVal)(t.accessor(n&&n.data));u=u.replace(t.match,void 0===r?"":r)}),u}},e.buildSubstitutor=function(t,e){if(t){var n=String(t),i=(n.match(/#{(\S*)}/gi)||[]).map(function(t){return r(t)}),a=(n.match(/\${[^}]*}/gi)||[]).map(function(t){return r(t)});if(0!=i.length||0!=a.length)return function(){var t=n;return i.forEach(function(n){var r=(0,o.objToVal)(n.accessor(e.getState(n.target)));t=t.replace(n.match,void 0===r?"":r)}),a.forEach(function(n){var r=e.root.findById(n.target),i=(0,o.objToVal)(n.accessor(r&&r.data));t=t.replace(n.match,void 0===i?"":i)}),t}}};var o=n(3),i=function(t){return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},i=new Image;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAclBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC0BbqFAAAAJXRSTlMAgAP3VSI6/g9fBk5FavJsMrariSjzPnO1enRRL5SMhmOOWB9keFTE0wAAANxJREFUOMutk9kWgyAMRLFuiLjUtdp9yf//YglVsQXz1HniMPcEMgHGvpX2O0Ypi+EgCL+IAShC+wB7QfubRDT7AFcnUPoLMLiP4PyJbsb55i05AgnR5iaQDsICgtH0cotBWoAP1c7kC6kFxEseCfZfB6gEgbNeBrira2QmH1uVYCXlA3is8UmgUCPIyQJKEmu8QtQJN0e9DPXVpzG2G216c1CqRmcBOdxXk07sWUSPv07zo0amCNQycv+NzmR6cRcwmfbuI7p2nZ/z4be0P83Foz6vIkhfZXr82XgDlZsspIq4peUAAAAASUVORK5CYII=",e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"_post_draw",value:function(t){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"_post_draw",this).call(this,t),this.app.isEditMode&&this._focused&&this.showMoveHandle&&this._draw_move_handle(t)}},{key:"_draw_move_handle",value:function(t){var e=this.bounds,n=e.left,r=e.top,o=e.width;t.save(),t.beginPath(),t.rect(n+o,r,25,25);t.fillStyle="rgba(235, 235, 235, 1)",t.strokeStyle="#333",t.fill(),t.stroke(),t.drawImage(i,n+o+3.75,r+3.75,17.5,17.5),t.closePath(),t.restore()}},{key:"contains",value:function(t,e){var r=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"contains",this).call(this,t,e);if(this.app.isViewMode)return r;var i=this.bounds,a=i.left,u=i.top,s=i.width,c=(i.height,a+s);return this.showMoveHandle&&(r=r||t<Math.max(c+25,c)&&t>Math.min(c+25,c)&&e<Math.max(u+25,u)&&e>Math.min(u+25,u)),this._focused=!!r,this.invalidate(),r}}]),n}()}},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){var n=i.Component.register(t.type);if(!n)return(0,a.warn)("Class not found",t.type),null;var r=new n(t,e);return t.components&&r.isContainer()&&(t.components.forEach(function(t){var n=o(t,e);n&&r.addComponent(n)}),delete t.components),r.created(),r}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=r(n(80)),a=(r(n(240)),n(1))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);Object.defineProperty(e,"Component",{enumerable:!0,get:function(){return r(o).default}});var i=n(8);Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return r(i).default}});var a=n(42);Object.defineProperty(e,"RootContainer",{enumerable:!0,get:function(){return r(a).default}});var u=n(5);Object.defineProperty(e,"Shape",{enumerable:!0,get:function(){return r(u).default}});var s=n(81);Object.defineProperty(e,"Line",{enumerable:!0,get:function(){return r(s).default}});var c=n(37);Object.defineProperty(e,"Ellipse",{enumerable:!0,get:function(){return r(c).default}});var l=n(82);Object.defineProperty(e,"Rect",{enumerable:!0,get:function(){return r(l).default}});var f=n(225);Object.defineProperty(e,"Polygon",{enumerable:!0,get:function(){return r(f).default}});var h=n(226);Object.defineProperty(e,"Polyline",{enumerable:!0,get:function(){return r(h).default}});var p=n(83);Object.defineProperty(e,"Ruler",{enumerable:!0,get:function(){return r(p).default}});var d=n(227);Object.defineProperty(e,"ImageView",{enumerable:!0,get:function(){return r(d).default}});var y=n(228);Object.defineProperty(e,"Text",{enumerable:!0,get:function(){return r(y).default}});var v=n(28);Object.defineProperty(e,"Group",{enumerable:!0,get:function(){return r(v).default}});var g=n(229);Object.defineProperty(e,"LocalRef",{enumerable:!0,get:function(){return r(g).default}});var b=n(230);Object.defineProperty(e,"GlobalRef",{enumerable:!0,get:function(){return r(b).default}});var _=n(84);Object.defineProperty(e,"InfoWindow",{enumerable:!0,get:function(){return r(_).default}});var m=n(231);Object.defineProperty(e,"HTMLOverlayElement",{enumerable:!0,get:function(){return r(m).default}});var w=n(232);Object.defineProperty(e,"HTMLOverlayContainer",{enumerable:!0,get:function(){return r(w).default}});var x=n(233);Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return r(x).default}});var k=n(234);Object.defineProperty(e,"Triangle",{enumerable:!0,get:function(){return r(k).default}});var O=n(235);Object.defineProperty(e,"Donut",{enumerable:!0,get:function(){return r(O).default}});var P=n(236);Object.defineProperty(e,"Star",{enumerable:!0,get:function(){return r(P).default}});var A=n(237);Object.defineProperty(e,"Variable",{enumerable:!0,get:function(){return r(A).default}});var j=n(4);Object.defineProperty(e,"RectPath",{enumerable:!0,get:function(){return r(j).default}});var E=n(238);Object.defineProperty(e,"ValueHolder",{enumerable:!0,get:function(){return r(E).default}});var M=n(239);Object.defineProperty(e,"DataSource",{enumerable:!0,get:function(){return r(M).default}});var S=n(78);Object.defineProperty(e,"MoveHandle",{enumerable:!0,get:function(){return r(S).default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),i=n(223),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"isLine",value:function(){return!0}},{key:"_draw",value:function(t){var e=this.model,n=e.begin,r=void 0===n?"none":n,o=e.end,a=void 0===o?"none":o,u=e.lineWidth,s=this.drawPath;(0,i.drawEndTips)(t,s,this.model),t.beginPath();var c=(0,i.getTipNeckPos)(r,u,s[0],s[1]),l=(0,i.getTipNeckPos)(a,u,s[s.length-1],s[s.length-2]);t.moveTo(c.x,c.y);for(var f=1;f<s.length-1;f++)t.lineTo(s[f].x,s[f].y);t.lineTo(l.x,l.y),this.drawStroke(t)}},{key:"contains",value:function(t,e){var n=this.model.lineWidth;return(0,i.containedInPath)(t,e,this.drawPath,n)}},{key:"drawPath",get:function(){return this.path}},{key:"resizable",get:function(){return!1}},{key:"mutable",get:function(){return!0}},{key:"rotatable",get:function(){return!1}},{key:"path",get:function(){var t=this.model;return[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}]},set:function(t){var e=t[0],n=t[1];this.set({x1:e.x,y1:e.y,x2:n.x,y2:n.y})}}]),e}();e.default=a,a.getTipNeckPos=i.getTipNeckPos,a.containedInPath=i.containedInPath,a.drawEndTips=i.drawEndTips,o.default.memoize(a.prototype,"path",!1),o.default.register("line",a)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){var r=e>n?n/e*100:100;return t>=r?t=r:t<=0&&(t=0),t}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=r(n(0)),u=r(n(5)),s=r(n(4)),c={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"round",name:"round",property:"round"}]},l={ondragmove:function(t,e,n){var r=n.model,i=r.left,a=(r.top,r.width),u=r.height,s=(n.transcoordP2S(t.x,t.y).x-i)/(a/2)*100;s=o(s,a,u),n.set({round:s})}},f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,s.default)(u.default)),i(e,[{key:"is3dish",value:function(){return!0}},{key:"_draw",value:function(t){var e=this.model.round,n=void 0===e?0:e,r=this.bounds,i=r.left,a=r.top,u=r.width,s=r.height;if(t.beginPath(),(n=o(n,u,s))>0){var c=n/100*(u/2);t.moveTo(i+c,a),t.lineTo(i+u-c,a),t.quadraticCurveTo(i+u,a,i+u,a+c),t.lineTo(i+u,a+s-c),t.quadraticCurveTo(i+u,a+s,i+u-c,a+s),t.lineTo(i+c,a+s),t.quadraticCurveTo(i,a+s,i,a+s-c),t.lineTo(i,a+c),t.quadraticCurveTo(i,a,i+c,a)}else t.rect(i,a,u,s)}},{key:"controls",get:function(){var t=this.model,e=t.left,n=t.top,r=t.width,i=t.round,a=t.height;return i=void 0==i?0:o(i,r,a),[{x:e+r/2*(i/100),y:n,handler:l}]}},{key:"nature",get:function(){return c}}]),e}();e.default=f,a.default.register("rect",f)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u=r(n(4)),s=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(2)),[1,2,10,20,50,50,50,50,50,50]),c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,u.default)(a.default)),o(e,[{key:"_draw",value:function(t){var e=this.model,n=e.lineWidth,r=void 0===n?1:n,o=e.fillStyle,i=void 0===o?"lightgray":o,a=e.font,u=void 0===a?"15px Arial":a,c=e.left,l=e.top,f=(e.rotation,e.origin),h=(e.margin,e.width),p=e.height,d=e.side,y=void 0===d?"bottom":d,v=e.strokeStyle,g=void 0===v?"#000000":v,b=e.scale,_=void 0===b?1:b;t.translate(c,l),t.beginPath();var m=Math.round(r/2);t.rect(-m,-m,h+2*m,p+2*m),t.clip(),t.beginPath(),t.rect(0,0,h,p),i&&(t.fillStyle=i,t.fill()),t.lineWidth=r,t.strokeStyle=g,t.stroke(),t.beginPath(),t.font=u;var w="bottom"!==y,x=w?0:p,k=4*p/5,O=2*p/3,P=1*p/2,A=3*p/5;w&&(k=p-k,O=p-O,P=p-P,A=p-1.5*p/5);var j=_*this.app.PPM/this.root.unitScale,E=Math.ceil(f/j),M=this.app.PPM/j,S=M<=1.1?1:s[Math.round(M)]||100;1!=S&&(E+=(S-E%S)%S);var T=Math.ceil(E*j),C=f+h;for(t.fillStyle=g;T<C;){if(E%10==0){t.moveTo(T-f,P),t.lineTo(T-f,x);var R=(E/10).toString(),I=t.measureText(R);t.fillText(R,T-f-I.width-6,A)}else E%5==0?(t.moveTo(T-f,O),t.lineTo(T-f,x)):(t.moveTo(T-f,k),t.lineTo(T-f,x));E+=S,T=Math.ceil(E*j)}}}]),e}();e.default=c,i.default.register("ruler",c)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=t.split(/\s+/),r=n.indexOf(e);return-1!=r?n.splice(r,1):n.splice(-1,0,e),n.join(" ")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=r(n(0)),u=r(n(5)),s=r(n(4)),c=n(2),l={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"textarea",label:"front-side-template",name:"frontSideTemplate",property:{language:"html"}},{type:"textarea",label:"back-side-template",name:"backSideTemplate",property:{language:"html"}},{type:"textarea",label:"style",name:"style",property:{language:"css"}}]},f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,s.default)(u.default)),i(e,[{key:"dispose",value:function(){var t=this;this.infoWindows.map(function(t){return t.component}).forEach(function(e){return t._removeInfoWindow(e)}),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"_findInfoWindowByComponent",value:function(t){return this.infoWindows.find(function(e){return e.component===t})}},{key:"_addInfoWindow",value:function(t,e,n){this._findInfoWindowByComponent(t)||this._windows.push({component:t,window:e,styleElement:n})}},{key:"_removeInfoWindow",value:function(t){var e=this._findInfoWindowByComponent(t);if(e){var n=e.window;n&&n.parentNode.removeChild(n);var r=this.infoWindows.lastIndexOf(e);this.infoWindows.splice(r,1)}}},{key:"_draw",value:function(t){var n=this.bounds,r=n.left,o=n.top,i=n.width,a=n.height;t.beginPath(),t.drawImage(e.image,r,o,i,a)}},{key:"infoWindows",get:function(){return this._windows||(this._windows=[]),this._windows}},{key:"hasTextProperty",get:function(){return!1}},{key:"nature",get:function(){return l}}],[{key:"hide",value:function(t,e){if(e){var n=t.root.findById(e);n?n._removeInfoWindow(t):console.warn("InfoWindow Not Found.",e)}}},{key:"show",value:function(t,n,r){if(n){var i=t.root.findById(n);if(i){if(!i._findInfoWindowByComponent(t)){var u=i.model,s=u.frontSideTemplate,l=void 0===s?"":s,f=u.backSideTemplate,h=[l,void 0===f?"":f].filter(function(t){return String(t).trim()});if(0!=(h=h.map(function(t){return a.default.template(function(t,e,n){return(e||n?['<div class="info-window-btns">',e?'<button class="closable">&#88</button>':"",n?'<button class="flipable">&#8652</button>':"","</div>"]:[]).concat(['<div class="info-window-content">',t,"</div>"]).join("")}(t,!r,2==h.length))})).length){var p='\n.flip {\n  backface-visibility:             hidden;\n      -moz-backface-visibility:    hidden;\n      -ms-backface-visibility:     hidden;\n      -o-backface-visibility:      hidden;\n      -webkit-backface-visibility: hidden;\n  border-radius: 7px;\n  height: auto;\n  font: normal 14px helvetica, arial, san serif;\n  position: absolute;\n  opacity:.9;\n  transform-origin:             50% 50% 0px;\n      -moz-transform-origin:    50% 50% 0px;\n      -ms-transform-origin:     50% 50% 0px;\n      -o-transform-origin:      50% 50% 0px;\n      -webkit-transform-origin: 50% 50% 0px;\n  transition: all 2s;\n      -moz-transition:    all 2s;\n      -ms-transition:     all 2s;\n      -o-transition:      all 2s;\n      -webkit-transition: all 2s;\n  min-width: 100px;min-height:50px;\n  background-color:#3e424e;\n  box-shadow: 2px 3px 2px 0px rgba(0,0,0,0.15);\n}\n\n#side-1 {\n  transform:             rotateY( 0deg );\n      -moz-transform:    rotateY( 0deg );\n      -ms-transform:     rotateY( 0deg );\n      -o-transform:      rotateY( 0deg );\n      -webkit-transform: rotateY( 0deg );\n}\n.flip:after{\n   content:"";\n   display:block;\n   position: absolute;\n   opacity:.9;\n   width: 0;\n   height: 0;\n}\n.flip.arrow-top:after{\n   left:45%;\n   top:-17px;\n   border-left:10px solid transparent;\n   border-bottom:18px solid #323b44;\n   border-right:10px solid transparent;\n}\n.flip.arrow-right:after{\n   left:100%;\n   top:48%;\n   border-top:10px solid transparent;\n   border-left:18px solid #323b44;\n   border-bottom:10px solid transparent;\n}\n.flip.arrow-bottom:after{\n   left:45%;\n   top:100%;\n   border-left:10px solid transparent;\n   border-top:18px solid #323b44;\n   border-right:10px solid transparent;\n}\n.flip.arrow-left:after{\n   right:100%;\n   top:48%;\n   border-top:10px solid transparent;\n   border-right:18px solid #323b44;\n   border-bottom:10px solid transparent;\n}\n\n#side-2 {\n  transform:             rotateY( 180deg );\n      -moz-transform:    rotateY( 180deg );\n      -ms-transform:     rotateY( 180deg );\n      -o-transform:      rotateY( 180deg );\n      -webkit-transform: rotateY( 180deg );\n}\n\n.flip-side-1 {\n  transform:             rotateY( 0deg ) !important;\n      -moz-transform:    rotateY( 0deg ) !important;\n      -ms-transform:     rotateY( 0deg ) !important;\n      -o-transform:      rotateY( 0deg ) !important;\n      -webkit-transform: rotateY( 0deg ) !important;\n}\n\n.flip-side-2 {\n  transform:             rotateY( 180deg ) !important;\n      -moz-transform:    rotateY( 180deg ) !important;\n      -ms-transform:     rotateY( 180deg ) !important;\n      -o-transform:      rotateY( 180deg ) !important;\n      -webkit-transform: rotateY( 180deg ) !important;\n}\n\n.info-window-btns{\n  position:absolute;\n  top:-7px;\n  right:5px;\n  overflow:hidden;\n}\n.info-window-content{\n  padding:10px;\n  color:#efefef;\n  font-size:13px;\n  line-height:1.4;\n}\n.info-window-btns button{\n  width:20px;height:20px;\n  float:right;\n  border:0;\n  border-radius:12px;\n  background-color:#2a7da1;\n  margin-right:3px;padding:2px 4px;\n  text-align:center;\n  cursor:pointer;\n  font-size:12px;\n  color:#fff\n}\n.info-window-btns button:hover{\n  background-color:#60bb23;\n}\n'+i.get("style"),d=t.bounds,y=d.left,v=d.top,g=d.width,b=d.height,_=document.createElement("span");_.style.position="absolute";var m=document.createElement("style");if(m.type="text/css",m.styleSheet?m.styleSheet.cssText=p:m.appendChild(document.createTextNode(p)),_.appendChild(m),h[0]){var w=document.createElement("div");w.id="side-1",w.className="flip",w.style.display="inline-block",w.innerHTML=h[0](t)}if(h[1]){var x=document.createElement("div");x.id="side-2",x.className="flip",x.style.display="inline-block",x.innerHTML=h[1](t)}c.GESTURES.forEach(function(t){_.addEventListener(t,function(t){t.stopPropagation()})}),c.KEYEVENTS.forEach(function(t){_.addEventListener(t,function(t){t.stopPropagation()})});var k=t.root.model_layer.overlay;if(w&&_.appendChild(w),x&&_.appendChild(x),k.appendChild(_),i._addInfoWindow(t,_,m),w){var O=w.querySelector(".info-window-btns > .flipable");O&&O.addEventListener("click",function(t){t.preventDefault(),x.className=o(x.className,"flip-side-1"),w.className=o(w.className,"flip-side-2")},!1);var P=w.querySelector(".info-window-btns > .closable");P&&P.addEventListener("click",function(r){r.preventDefault(),e.hide(t,n)},!1)}if(x){var A=x.querySelector(".info-window-btns > .flipable");A&&A.addEventListener("click",function(t){t.preventDefault(),x.className=o(x.className,"flip-side-1"),w.className=o(w.className,"flip-side-2")},!1);var j=x.querySelector(".info-window-btns > .closable");j&&j.addEventListener("click",function(r){r.preventDefault(),e.hide(t,n)},!1)}var E=w.offsetWidth,M=w.offsetHeight,S=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.rootModel.target.getBoundingClientRect()),T=[];w&&T.push(w),x&&T.push(x);var C={x:y+g/2,y:v},R=t.transcoordS2C(C.x+E/2,C.y);if(R.x+S.left<S.right){if(M+20<R.y)return _.style.marginLeft=C.x-E/2+"px",_.style.marginTop=C.y-M-20+"px",void T.forEach(function(t){return t.className+=" arrow-bottom"});if(C={x:y+g/2,y:v+b},R=t.transcoordS2C(C.x+E/2,C.y+M+20),S.bottom>R.y+S.top)return _.style.marginLeft=C.x-E/2+"px",_.style.marginTop=C.y+20+"px",void T.forEach(function(t){return t.className+=" arrow-top"})}if(C={x:y,y:v+b/2},(R=t.transcoordS2C(C.x-E-20,C.y+M)).x>S.left)return _.style.marginLeft=C.x-E-20+"px",_.style.marginTop=C.y-M/2+"px",void T.forEach(function(t){return t.className+=" arrow-right"});C={x:y+g,y:v+b/2},_.style.marginLeft=C.x+20+"px",_.style.marginTop=C.y-M/2+"px",T.forEach(function(t){return t.className+=" arrow-left"})}}}else console.warn("InfoWindow Not Found.",n)}else console.warn("InfoWindow not defined.")}},{key:"image",get:function(){return e._image||((e._image=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAY1BMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIAbxiAAAAIHRSTlMA+gPshCwwWFzYCeLRm7QRG6rLeDZI9JOJJDtjb1HAf1sAT80AAAQQSURBVHhe7MCBAAAAAMKw/KkzOMG2BAAAAKeu3lUohIEggO7jQi5qHqpgwML5/6+0F0y02z31FlvMMLKt86QMQ1ined2Evih1hFFjLfRWjgzDOGZ6JSiM00B9EuHALtQxJLiQBmqSBCeSUEuEGzs1BDjSaHxWOKK5Eyz/4SoMV/hp4+vtcPkdwZD/udwevNg7t1xXYRiKmkB7C+ENlPLq8fxHeX+RGjWQ1D45ldcIulBIvCvYJGBEadyTzxAcfY57NBjpLScOO/bzugcTHe7IMwiSLMcdHZhocMcMgTLjjgZM7F1bCJZ2v27ARGzYDwIk2Z+JYGJ/iiwQLMv+JAEThjkmRG64Q0Q+gIiIiIiIiIiIyFy0KRFt0bOJZAWSUigmkQaJaXhENiRnYBEpkZySRSRGcmIWEaQnYhHRSI5mESmQnIJFZIqQmGhiEYEbEnPjGlEGjYTogW/WUkOXENENSqZfEXmDiIiIiIiIiIiIiIiIiIiImq5ETIpRpBpjJCMeKy6Ri0ZS9MQjkmkkJs1YRDokp2MRyZGclkUkQnIiEQltaX3Lzb6yiGTpl2y/avqSAxGgelCOKI+Kc2isL0TUSsZ4EREREREREREREREREREREfnIQzXrNWSRTeNxnlOwIgueIr6AAyE+CpiqMEUK71IDO4E+LluEKYKnKcMUifEsTZgiJZ5lDVNkwJPcqzBFoPF/HplfxL/w6b4EPGv1h18Weya1TL8iIiIeiIiIiIiIiEjkPefxV+5YA9PPHylB+u5aqgZ39H+jKOxrqtu+pkzvr9YbzoZ6w2OFkzcrA3yE4WZlSSyFk54VoA/wR43+FaD+r9w32QdWvgvjp2ty2xq8qHPHmtyPFxfrK3hw1ejERlAlfR/Ame2OTow05d4rOLLSlHtDVhI0uRO01JeZ405op6zgNNXT+bIRfpIgn+AkU4pOxBscohojdCHu4RRzjC5EYwVHqRONDkSnEvK/CB3QSU32IRW3ZPnj9iEVoGCNTLVrh8ia1x+6wq8xvB5mz8pxu7oPwIn9lcR0AiuX1+1KX+BXqdvXzWsAC0NsGjzZsS/2Bd6yRA5RgIHkXNhSD3whASZ8rrB9mItuEAizac0fDlHxDMEwpQfD1tW4y3Hjfy5s9nOHH3uwWA+EqEJBWCjoTL/S5toBB/7hu6zer74NgqSP39zJU+qQX3ix763mHTqvIVRUVprCljlElRkEjBqNYevH8veBJ2xhiyhE8YctmhDFH7ZoQhR/2KIJUfxhiyRE8YctmhDFH7ZoQhR/2OIJUfxhC9Ppf/t1jgJACERRsHGyYRZB0Ujvf0xD8w6kP7y6RZmgf/oTFTtbbzJVxZWo2Nlqw6TVy5GowNl6ssm7v50obamfSxQAAAAAAAsKLM15fb3vpQAAAABJRU5ErkJggg=="),e._image}}]),e}();e.default=f,a.default.register("info-window",f)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(35));e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"isHTMLElement",value:function(){return!0}},{key:"setElementProperties",value:function(t){throw new Error("Not Implemented Yet")}},{key:"createElement",value:function(){this.element=document.createElement(this.tagName),this.element&&(this.parent.isHTMLElement()?this.parent.element.appendChild(this.element):this.root.model_layer.overlay.appendChild(this.element),this.oncreate_element&&this.oncreate_element(this.element))}},{key:"reposition",value:function(){this.element&&(0,o.default)(this)}},{key:"disposeElement",value:function(){var t=this.element;t&&t.parentElement&&t.parentElement.removeChild(t),delete this.element}},{key:"ready",value:function(){!this.element&&this.createElement(),this.setElementProperties(this.element),this.reposition()}},{key:"added",value:function(){this.element&&(this.parent.isHTMLElement()?this.parent.element.appendChild(this.element):this.root.model_layer.overlay.appendChild(this.element),this.reposition())}},{key:"dispose",value:function(){this.disposeElement(this),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"dispose",this).call(this)}},{key:"onchange",value:function(t,e){this.element&&this.setElementProperties(this.element),this.reposition()}},{key:"element",get:function(){return this._element},set:function(t){this._element=t}},{key:"tagName",get:function(){return this.get("type")}},{key:"hasTextProperty",get:function(){return!0}},{key:"textHidden",get:function(){return!0}}]),n}()}},function(t,e,n){"use strict";function r(t){var e=y.get(t);if(e){var n=e.div.parentNode;n&&n.removeChild(e.div);var r=e.scene;r.target=null,r.release(),y.delete(t)}}function o(t){r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.hide=o,e.show=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},v=n.data,g=n.location,b=void 0===g?a:g,_=t.app.refProvider;_&&_.get(e,!0).then(function(e){var n=document.createElement("div");n.style.position="absolute",n.style.display="inline-block",n.innerHTML=h;var g=n.querySelector(".popup-content"),_=e.root.model,m=_.width,w=_.height;g.style.width=m+"px",g.style.height=w+"px";var x=document.createElement("style");x.type="text/css",x.styleSheet?x.styleSheet.cssText=p:x.appendChild(document.createTextNode(p)),n.appendChild(x),i.GESTURES.forEach(function(t){n.addEventListener(t,function(t){t.stopPropagation()})}),i.KEYEVENTS.forEach(function(t){n.addEventListener(t,function(t){t.stopPropagation()})}),t.root.model_layer.overlay.appendChild(n),function(t,e,n){r(t),y.set(t,{div:e,scene:n})}(t.root,n,e),n.querySelector(".closable").addEventListener("click",function(e){e.preventDefault(),o(t.root)},!1),e.target=g,e.data=v||t.data,e.fit("both");var k=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a,o=t.bounds,i=e.bounds,h=Math.max(o.width/4-i.width/2,d),p=Math.min(3*o.width/4+i.width/2,o.width-d)-i.width,y=Math.max(o.height/4-i.height/2,d),v=Math.min(3*o.height/4+i.height/2,o.height-d)-i.height;switch(r){case f:return{x:n.x<o.width/2?p:h,y:n.y<o.height/2?v:y};case u:return{x:h,y:y};case s:return{x:p,y:y};case c:return{x:h,y:v};case l:return{x:p,y:v};case a:default:return{x:(o.width-i.width)/2,y:(o.height-i.height)/2}}}(t.rootModel,e.root,t.center,b);n.style.left=k.x+"px",n.style.top=k.y+"px"},function(t){console.error("cannot fetch board: "+e,t)})};var i=n(2),a="center",u="left-top",s="right-top",c="left-bottom",l="right-bottom",f="auto",h='\n<div class="popup-content">\n</div>\n<button class="closable">&#88</button>\n',p="\nbutton.closable {\n  width: 20px;\n  height: 20px;\n  right: 0px;\n  top: 0px;\n  padding: 0;\n  margin: 0;\n  border: 0px;\n  text-align: center;\n  cursor: pointer;\n  font-size: 12px;\n  color: black;\n  position: absolute;\n  background-color: transparent;\n}\n\nbutton.closable:hover {\n  background-color:#60bb23;\n}\n",d=20,y=new WeakMap},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=Object.assign({},e)}return r(t,[{key:"excute",value:function(){}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=(0,o.clone)(t.hierarchy);return void 0!==e.id&&delete e.id,(0,r.default)(e,t.app)};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(79)),o=n(3)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(269)),a=r(n(74)),u=r(n(283)),s=new WeakSet,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._container=e,this.app=e.app,this._commander=new u.default(this._container),this.app.commander=this._commander,s.add(this)}return o(t,null,[{key:"residents",get:function(){return s}}]),o(t,[{key:"play",value:function(){i.play.apply(this._container,arguments)}},{key:"add",value:function(){return i.add.apply(this._container,arguments)}},{key:"duplicate",value:function(){return i.duplicate.apply(this._container,arguments)}},{key:"remove",value:function(){return i.remove.apply(this._container,arguments)}},{key:"animate",value:function(){return a.default.apply(this,arguments)}},{key:"fullscreen",value:function(){return i.fullscreen.apply(this._container,arguments)}},{key:"variable",value:function(t,e){return this._container.variable.apply(this._container,arguments)}},{key:"resize",value:function(){this._container.resize()}},{key:"dispose",value:function(){this._commander&&this._commander.dispose(),this._container&&this._container.dispose()}},{key:"select",value:function(t){for(var e,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this._container.selected=(e=this.root).findAll.apply(e,[t].concat(r)),this.selected}},{key:"undo",value:function(){this.commander.undo()}},{key:"redo",value:function(){this.commander.redo()}},{key:"cut",value:function(){return i.cut.apply(this._container,arguments)}},{key:"copy",value:function(){return i.copy.apply(this._container,arguments)}},{key:"paste",value:function(){return i.paste.apply(this._container,arguments)}},{key:"undoableChange",value:function(){return i.undoableChange.apply(this._container,arguments)}},{key:"change",value:function(){return i.change.apply(this.root,arguments)}},{key:"findAll",value:function(){return this.root.findAll.apply(this.root,arguments)}},{key:"findFirst",value:function(){return this.root.findFirst.apply(this.root,arguments)}},{key:"findById",value:function(){return this._container.findById.apply(this._container,arguments)}},{key:"serialize",value:function(){return this.root.trim(),this.root.serialize.apply(this.root,arguments)}},{key:"align",value:function(){return i.align.apply(this._container,arguments)}},{key:"distribute",value:function(){return i.distribute.apply(this._container,arguments)}},{key:"zorder",value:function(){return i.zorder.apply(this._container,arguments)}},{key:"symmetryX",value:function(){return i.symmetryX.apply(this._container,arguments)}},{key:"symmetryY",value:function(){return i.symmetryY.apply(this._container,arguments)}},{key:"on",value:function(){return i.on.apply(this._container,arguments)}},{key:"once",value:function(){return i.once.apply(this._container,arguments)}},{key:"off",value:function(){return i.off.apply(this._container,arguments)}},{key:"toDataURL",value:function(){return i.toDataURL.apply(this._container,arguments)}},{key:"group",value:function(){return i.group.apply(this._container,arguments)}},{key:"ungroup",value:function(){return i.ungroup.apply(this._container,arguments)}},{key:"fit",value:function(t){var e=this;this._container.once("redraw",function(){return e._container.fit(t)}),this._container.invalidate()}},{key:"target",get:function(){return this._container.target_element},set:function(t){var e;if("string"==typeof t){if(!(e=document.getElementById(t)))throw"target element '"+t+"' is not exist";if(e.firstChild)throw"target element '"+t+"' already has children"}else e=t;e&&e.style&&(e.style.cursor="default"),this._container.target_element=e,this._container.invalidate()}},{key:"scale",get:function(){return this.root.get("scale")},set:function(t){this.root.set("scale",t)}},{key:"translate",get:function(){return this.root.get("translate")},set:function(t){this.root.set("translate",t)}},{key:"unit",get:function(){return this.root.get("unit")||"px"}},{key:"PPM",get:function(){return this.app.PPM}},{key:"PPI",get:function(){return this.app.PPI}},{key:"DPPX",get:function(){return this.app.DPPX}},{key:"unitScale",get:function(){return this._container.unitScale}},{key:"screen",get:function(){return this.app.screen},set:function(t){this.app.screen=t,this._container.resize()}},{key:"selected",get:function(){return this._container.selected.slice()}},{key:"commander",get:function(){return this._commander}},{key:"model",get:function(){return this.root.hierarchy},set:function(t){this._container.rebuildContentModel(t)}},{key:"root",get:function(){return this._container.model_layer}},{key:"mode",get:function(){return this.app.mode},set:function(t){void 0!==t&&(this.app.mode=t)}},{key:"ids",get:function(){return i.getIds.apply(this._container)}},{key:"data",set:function(t){this._container.data=t},get:function(){return this._container.data}},{key:"variables",get:function(){return i.getVariables.apply(this._container)},set:function(t){i.setVariables.apply(this._container,[t])}}]),t}();e.default=c},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(91));e.default=o,"undefined"!=typeof window&&(window.scene=o),void 0!==r&&(r.scene=o),e.default=o,t.exports=e.default}).call(e,n(30))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.FPS=e.version=e.license=e.Scene=e.ScriptLoader=e.ReferenceMap=e.EventMap=e.Layer=e.Model=e.create=e.config=e.polyfill=void 0;var o=n(92);Object.defineProperty(e,"polyfill",{enumerable:!0,get:function(){return r(o).default}});var i=n(41);Object.defineProperty(e,"config",{enumerable:!0,get:function(){return i.config}});var a=n(93);Object.defineProperty(e,"create",{enumerable:!0,get:function(){return r(a).default}});var u=n(14);Object.defineProperty(e,"Layer",{enumerable:!0,get:function(){return r(u).default}});var s=n(29);Object.defineProperty(e,"EventMap",{enumerable:!0,get:function(){return r(s).default}});var c=n(2);Object.keys(c).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return c[t]}})});var l=n(80);Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}})});var f=n(36);Object.keys(f).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return f[t]}})});var h=n(286);Object.defineProperty(e,"ReferenceMap",{enumerable:!0,get:function(){return r(h).default}});var p=n(287);Object.defineProperty(e,"ScriptLoader",{enumerable:!0,get:function(){return r(p).default}});var d=n(1);Object.keys(d).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return d[t]}})});var y=n(89);Object.defineProperty(e,"Scene",{enumerable:!0,get:function(){return r(y).default}});var v=n(38);Object.defineProperty(e,"license",{enumerable:!0,get:function(){return v.license}});var g=n(288);Object.defineProperty(e,"version",{enumerable:!0,get:function(){return r(g).default}});var b=n(289);Object.defineProperty(e,"FPS",{enumerable:!0,get:function(){return r(b).default}});var _=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(17));e.Model=_},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default="done","function"!=typeof Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}),"function"!=typeof Object.values&&(Object.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e}),"function"!=typeof Object.keys&&(Object.values=function(t){var e=[];for(var n in t)e.push(n);return e}),"undefined"!=typeof CanvasRenderingContext2D&&void 0==CanvasRenderingContext2D.prototype.ellipse&&(CanvasRenderingContext2D.prototype.ellipse=function(t,e,n,r,o,i,a,u){this.save(),this.translate(t,e),this.rotate(o),this.translate(-n,-r),this.scale(n,r),this.arc(1,1,1,i,a,u),this.restore()}),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(console.warn("requestAnimationFrame not supported"),window.requestAnimationFrame=function(e,n){var r=performance.now(),o=Math.max(0,33-(r-t)),i=window.setTimeout(function(){e(r+o)},o);return t=r+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t});var i=i||function(){function t(){r(this,t)}return o(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"has",value:function(){}},{key:"delete",value:function(){}}]),t}(),a=a||function(){function t(){r(this,t)}return o(t,[{key:"add",value:function(){}}]),t}()},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.target,n=t.model,r=t.style,s=t.layers,c=void 0===s?[]:s,l=t.handlers,f=void 0===l?[]:l,h=t.mode,p=void 0===h?a.MODE_VIEW:h,d=t.refProvider,y=null;if("string"==typeof e){if(!(y=document.getElementById(e)))throw"target element '"+e+"' is not exist";if(y.firstChild)throw"target element '"+e+"' is not empty"}else y=e;return y&&y.style&&(y.style.cursor="default",y.style.overflow="hidden"),new u.default(new o.default({target_element:y,model:n,style:r,layers:c,handlers:f},new i.default(p,d)))};var o=r(n(42)),i=r(n(268)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2)),u=r(n(89))},function(t,e,n){"use strict";var r=n(95);t.exports=function(t,e){return r(t,e)}},function(t,e,n){"use strict";function r(t,e,n,a,u){return t===e||(null==t||null==e||!i(t)&&!i(e)?t!=t&&e!=e:o(t,e,n,a,r,u))}var o=n(96),i=n(12);t.exports=r},function(t,e,n){"use strict";var r=n(97),o=n(47),i=n(131),a=n(135),u=n(56),s=n(19),c=n(32),l=n(33),f=1,h="[object Arguments]",p="[object Array]",d="[object Object]",y=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,v,g,b){var _=s(t),m=s(e),w=_?p:u(t),x=m?p:u(e),k=(w=w==h?d:w)==d,O=(x=x==h?d:x)==d,P=w==x;if(P&&c(t)){if(!c(e))return!1;_=!0,k=!1}if(P&&!k)return b||(b=new r),_||l(t)?o(t,e,n,v,g,b):i(t,e,w,n,v,g,b);if(!(n&f)){var A=k&&y.call(t,"__wrapped__"),j=O&&y.call(e,"__wrapped__");if(A||j){var E=A?t.value():t,M=j?e.value():e;return b||(b=new r),g(E,M,n,v,b)}}return!!P&&(b||(b=new r),a(t,e,n,v,g,b))}},function(t,e,n){"use strict";function r(t){var e=this.__data__=new o(t);this.size=e.size}var o=n(21),i=n(103),a=n(104),u=n(105),s=n(106),c=n(107);r.prototype.clear=i,r.prototype.delete=a,r.prototype.get=u,r.prototype.has=s,r.prototype.set=c,t.exports=r},function(t,e,n){"use strict";t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){"use strict";var r=n(22),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),--this.size,0))}},function(t,e,n){"use strict";var r=n(22);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){"use strict";var r=n(22);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){"use strict";var r=n(22);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},function(t,e,n){"use strict";var r=n(21);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e,n){"use strict";t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e,n){"use strict";t.exports=function(t){return this.__data__.get(t)}},function(t,e,n){"use strict";t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){"use strict";var r=n(21),o=n(31),i=n(46),a=200;t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var u=n.__data__;if(!o||u.length<a-1)return u.push([t,e]),this.size=++n.size,this;n=this.__data__=new i(u)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){"use strict";var r=n(43),o=n(111),i=n(11),a=n(45),u=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(r(t)?h:u).test(a(t))}},function(t,e,n){"use strict";var r=n(23),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,u),n=t[u];try{t[u]=void 0;var r=!0}catch(t){}var o=a.call(t);return r&&(e?t[u]=n:delete t[u]),o}},function(t,e,n){"use strict";var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,n){"use strict";var r=n(112),o=function(){var t=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=function(t){return!!o&&o in t}},function(t,e,n){"use strict";var r=n(6)["__core-js_shared__"];t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){"use strict";var r=n(115),o=n(21),i=n(31);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(116),i=n(117),a=n(118),u=n(119),s=n(120);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},function(t,e,n){"use strict";var r=n(24);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e,n){"use strict";t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){"use strict";var r=n(24),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===o?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){"use strict";var r=n(24),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},function(t,e,n){"use strict";var r=n(24),o="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?o:e,this}},function(t,e,n){"use strict";var r=n(25);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){var e=void 0===t?"undefined":r(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){"use strict";var r=n(25);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){"use strict";var r=n(25);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){"use strict";var r=n(25);t.exports=function(t,e){var n=r(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new o;++e<n;)this.add(t[e])}var o=n(46),i=n(127),a=n(128);r.prototype.add=r.prototype.push=i,r.prototype.has=a,t.exports=r},function(t,e,n){"use strict";var r="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,r),this}},function(t,e,n){"use strict";t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e,n){"use strict";t.exports=function(t,e){return t.has(e)}},function(t,e,n){"use strict";var r=n(23),o=n(132),i=n(18),a=n(47),u=n(133),s=n(134),c=1,l=2,f="[object Boolean]",h="[object Date]",p="[object Error]",d="[object Map]",y="[object Number]",v="[object RegExp]",g="[object Set]",b="[object String]",_="[object Symbol]",m="[object ArrayBuffer]",w="[object DataView]",x=r?r.prototype:void 0,k=x?x.valueOf:void 0;t.exports=function(t,e,n,r,x,O,P){switch(n){case w:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case m:return!(t.byteLength!=e.byteLength||!O(new o(t),new o(e)));case f:case h:case y:return i(+t,+e);case p:return t.name==e.name&&t.message==e.message;case v:case b:return t==e+"";case d:var A=u;case g:var j=r&c;if(A||(A=s),t.size!=e.size&&!j)return!1;var E=P.get(t);if(E)return E==e;r|=l,P.set(t,e);var M=a(A(t),A(e),r,x,O,P);return P.delete(t),M;case _:if(k)return k.call(t)==k.call(e)}return!1}},function(t,e,n){"use strict";var r=n(6).Uint8Array;t.exports=r},function(t,e,n){"use strict";t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},function(t,e,n){"use strict";t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},function(t,e,n){"use strict";var r=n(136),o=1,i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,u,s){var c=n&o,l=r(t),f=l.length;if(f!=r(e).length&&!c)return!1;for(var h=f;h--;){var p=l[h];if(!(c?p in e:i.call(e,p)))return!1}var d=s.get(t);if(d&&s.get(e))return d==e;var y=!0;s.set(t,e),s.set(e,t);for(var v=c;++h<f;){var g=t[p=l[h]],b=e[p];if(a)var _=c?a(b,g,p,e,t,s):a(g,b,p,t,e,s);if(!(void 0===_?g===b||u(g,b,n,a,s):_)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var m=t.constructor,w=e.constructor;m!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof w&&w instanceof w)&&(y=!1)}return s.delete(t),s.delete(e),y}},function(t,e,n){"use strict";var r=n(137),o=n(139),i=n(48);t.exports=function(t){return r(t,i,o)}},function(t,e,n){"use strict";var r=n(138),o=n(19);t.exports=function(t,e,n){var i=e(t);return o(t)?i:r(i,n(t))}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e,n){"use strict";var r=n(140),o=n(141),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,u=a?function(t){return null==t?[]:(t=Object(t),r(a(t),function(e){return i.call(t,e)}))}:o;t.exports=u},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[o++]=a)}return i}},function(t,e,n){"use strict";t.exports=function(){return[]}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){"use strict";var r=n(10),o=n(12),i="[object Arguments]";t.exports=function(t){return o(t)&&r(t)==i}},function(t,e,n){"use strict";t.exports=function(){return!1}},function(t,e,n){"use strict";var r=n(10),o=n(53),i=n(12),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[r(t)]}},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){"use strict";(function(t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(44),i="object"==r(e)&&e&&!e.nodeType&&e,a=i&&"object"==r(t)&&t&&!t.nodeType&&t,u=a&&a.exports===i&&o.process,s=function(){try{return u&&u.binding&&u.binding("util")}catch(t){}}();t.exports=s}).call(e,n(51)(t))},function(t,e,n){"use strict";var r=n(55)(Object.keys,Object);t.exports=r},function(t,e,n){"use strict";var r=n(9)(n(6),"DataView");t.exports=r},function(t,e,n){"use strict";var r=n(9)(n(6),"Promise");t.exports=r},function(t,e,n){"use strict";var r=n(9)(n(6),"Set");t.exports=r},function(t,e,n){"use strict";var r=n(9)(n(6),"WeakMap");t.exports=r},function(t,e,n){"use strict";var r=n(154),o=n(166),i=n(169),a=n(170),u=n(171),s=n(63),c=n(62),l=n(48),f=n(65),h=n(172),p=n(66),d=/\b__p \+= '';/g,y=/\b(__p \+=) '' \+/g,v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,g=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,b=/($^)/,_=/['\n\r\u2028\u2029\\]/g;t.exports=function(t,e,n){var m=h.imports._.templateSettings||h;n&&c(t,e,n)&&(e=void 0),t=p(t),e=r({},e,m,a);var w,x,k=r({},e.imports,m.imports,a),O=l(k),P=i(k,O),A=0,j=e.interpolate||b,E="__p += '",M=RegExp((e.escape||b).source+"|"+j.source+"|"+(j===f?g:b).source+"|"+(e.evaluate||b).source+"|$","g"),S="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";t.replace(M,function(e,n,r,o,i,a){return r||(r=o),E+=t.slice(A,a).replace(_,u),n&&(w=!0,E+="' +\n__e("+n+") +\n'"),i&&(x=!0,E+="';\n"+i+";\n__p += '"),r&&(E+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),A=a+e.length,e}),E+="';\n";var T=e.variable;T||(E="with (obj) {\n"+E+"\n}\n"),E=(x?E.replace(d,""):E).replace(y,"$1").replace(v,"$1;"),E="function("+(T||"obj")+") {\n"+(T?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(w?", __e = _.escape":"")+(x?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+E+"return __p\n}";var C=o(function(){return Function(O,S+"return "+E).apply(void 0,P)});if(C.source=E,s(C))throw C;return C}},function(t,e,n){"use strict";var r=n(155),o=n(157),i=n(163),a=o(function(t,e,n,o){r(e,i(e),t,o)});t.exports=a},function(t,e,n){"use strict";var r=n(156),o=n(57);t.exports=function(t,e,n,i){var a=!n;n||(n={});for(var u=-1,s=e.length;++u<s;){var c=e[u],l=i?i(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),a?o(n,c,l):r(n,c,l)}return n}},function(t,e,n){"use strict";var r=n(57),o=n(18),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];i.call(t,e)&&o(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){"use strict";var r=n(59),o=n(62);t.exports=function(t){return r(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(i--,a):void 0,u&&o(n[0],n[1],u)&&(a=i<3?void 0:a,i=1),e=Object(e);++r<i;){var s=n[r];s&&t(e,s,r,a)}return e})}},function(t,e,n){"use strict";var r=n(61),o=Math.max;t.exports=function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,u=o(i.length-e,0),s=Array(u);++a<u;)s[a]=i[e+a];a=-1;for(var c=Array(e+1);++a<e;)c[a]=i[a];return c[e]=n(s),r(t,this,c)}}},function(t,e,n){"use strict";var r=n(160),o=n(162)(r);t.exports=o},function(t,e,n){"use strict";var r=n(161),o=n(58),i=n(60),a=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:i;t.exports=a},function(t,e,n){"use strict";t.exports=function(t){return function(){return t}}},function(t,e,n){"use strict";var r=800,o=16,i=Date.now;t.exports=function(t){var e=0,n=0;return function(){var a=i(),u=o-(a-n);if(n=a,u>0){if(++e>=r)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){"use strict";var r=n(49),o=n(164),i=n(26);t.exports=function(t){return i(t)?r(t,!0):o(t)}},function(t,e,n){"use strict";var r=n(11),o=n(34),i=n(165),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=o(t),n=[];for(var u in t)("constructor"!=u||!e&&a.call(t,u))&&n.push(u);return n}},function(t,e,n){"use strict";t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){"use strict";var r=n(61),o=n(59),i=n(63),a=o(function(t,e){try{return r(t,void 0,e)}catch(t){return i(t)?t:new Error(t)}});t.exports=a},function(t,e,n){"use strict";var r=n(10),o=n(168),i=n(12),a="[object Object]",u=Function.prototype,s=Object.prototype,c=u.toString,l=s.hasOwnProperty,f=c.call(Object);t.exports=function(t){if(!i(t)||r(t)!=a)return!1;var e=o(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==f}},function(t,e,n){"use strict";var r=n(55)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){"use strict";var r=n(64);t.exports=function(t,e){return r(e,function(e){return t[e]})}},function(t,e,n){"use strict";var r=n(18),o=Object.prototype,i=o.hasOwnProperty;t.exports=function(t,e,n,a){return void 0===t||r(t,o[n])&&!i.call(a,n)?e:t}},function(t,e,n){"use strict";var r={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};t.exports=function(t){return"\\"+r[t]}},function(t,e,n){"use strict";var r=n(173),o={escape:n(177),evaluate:n(178),interpolate:n(65),variable:"",imports:{_:{escape:r}}};t.exports=o},function(t,e,n){"use strict";var r=n(174),o=n(66),i=/[&<>"']/g,a=RegExp(i.source);t.exports=function(t){return(t=o(t))&&a.test(t)?t.replace(i,r):t}},function(t,e,n){"use strict";var r=n(175)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});t.exports=r},function(t,e,n){"use strict";t.exports=function(t){return function(e){return null==t?void 0:t[e]}}},function(t,e,n){"use strict";function r(t){if("string"==typeof t)return t;if(a(t))return i(t,r)+"";if(u(t))return l?l.call(t):"";var e=t+"";return"0"==e&&1/t==-s?"-0":e}var o=n(23),i=n(64),a=n(19),u=n(67),s=1/0,c=o?o.prototype:void 0,l=c?c.toString:void 0;t.exports=r},function(t,e,n){"use strict";t.exports=/<%-([\s\S]+?)%>/g},function(t,e,n){"use strict";t.exports=/<%([\s\S]+?)%>/g},function(t,e,n){"use strict";function r(t,e,n,r){if(!n)return!0;if("object"==(void 0===n?"undefined":a(n))){for(var o in n){var i=n[o];t[e].apply(t,[o,i])}return!1}return!c.test(n)||(n.split(c).forEach(function(n){return t[e].apply(t,[n].concat(r))}),!1)}function o(t,e){t.forEach(function(t){return t.callback.apply(t.ctx,e)})}function i(t,e){t.forEach(function(t){return f.delegate.apply(t,e)})}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(3)),s=n(187),c=/\s+/,l=["on","off","once","delegate_on","delegate_off","trigger","listenTo"],f={withEvent:function(){var t=this;l.forEach(function(e){return t[e]=f[e]})},on:function(t,e,n){return r(this,"on",t,[e,n])&&e?(this._listeners||(this._listeners={}),(this._listeners[t]||(this._listeners[t]=[])).push({callback:e,context:n,ctx:n||this}),this):this},once:function(t,e,n){if(!r(this,"once",t,[e,n])||!e)return this;var o=this,i=u.once(function(){o.off(t,i),e.apply(o,arguments)});i._callback=e,this.on(t,i,n)},off:function(t,e,n){if(!this._listeners||!r(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._listeners=void 0,this;var o;o=t?[t]:Object.keys(this._listeners);for(var i=0;i<o.length;i++){var a=o[i],u=this._listeners[a];if(u){var s=[];if(this._listeners[a]=s,e||n)for(var c=0;c<u.length;c++){var l=u[c];(e&&e!==l.callback&&e!==l.callback._callback||n&&n!==l.context)&&s.push(l)}s.length||delete this._listeners[a]}}return this},delegate_on:function(t){return this._delegators||(this._delegators=new s.List),this._delegators.append(t),this},delegate_off:function(t){return this._delegators?(this._delegators.remove(t),this):this},delegate:function(){if(this._delegators&&this._delegators.size()>0&&i(this._delegators,arguments),!this._listeners)return this;var t=arguments.length-1,e=arguments[t];arguments[t]={origin:e.origin,name:e.name,deliverer:this};var n=this._listeners[e.name],r=this._listeners["(all)"];return n&&o(n,arguments),r&&o(r,arguments),this},trigger:function(t){var e=[].slice.call(arguments,1);if(e.push({origin:this,name:t,deliverer:this}),this._delegators&&this._delegators.size()>0&&i(this._delegators,e),!this._listeners)return this;if(!r(this,"trigger",t,e))return this;var n=this._listeners[t],a=this._listeners["(all)"];return n&&o(n,e),a&&o(a,e),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var o=!e&&!n;n||"object"!=(void 0===e?"undefined":a(e))||(n=this),t&&((r={})[t._listenId]=t);for(var i in r){var s=r[i];s.off(e,n,this),(o||u.isEmpty(s._events))&&delete this._listeningTo[i]}return this}},h={listenTo:"on",listenToOnce:"once"};for(var p in h){var d=h[p];f[p]=function(t,e,n){this._listeningTo||(this._listeningTo={});var r=this._listeningTo;return t._listenId||(t._listenId=u.uniqueId("l")),r[t._listenId]=t,n||"object"!=(void 0===e?"undefined":a(e))||(n=this),t[d](e,n,this),this}}e.default=f},function(t,e,n){"use strict";var r=n(6);t.exports=function(){return r.Date.now()}},function(t,e,n){"use strict";var r=n(68),o=n(11),i="Expected a function";t.exports=function(t,e,n){var a=!0,u=!0;if("function"!=typeof t)throw new TypeError(i);return o(n)&&(a="leading"in n?!!n.leading:a,u="trailing"in n?!!n.trailing:u),r(t,e,{leading:a,maxWait:e,trailing:u})}},function(t,e,n){"use strict";var r=n(183);t.exports=function(t){return r(2,t)}},function(t,e,n){"use strict";var r=n(184),o="Expected a function";t.exports=function(t,e){var n;if("function"!=typeof e)throw new TypeError(o);return t=r(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}},function(t,e,n){"use strict";var r=n(185);t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}},function(t,e,n){"use strict";var r=n(69),o=1/0,i=1.7976931348623157e308;t.exports=function(t){return t?(t=r(t))===o||t===-o?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},function(t,e,n){"use strict";var r=n(54),o=n(56),i=n(50),a=n(19),u=n(26),s=n(32),c=n(34),l=n(33),f="[object Map]",h="[object Set]",p=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(u(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||s(t)||l(t)||i(t)))return!t.length;var e=o(t);if(e==f||e==h)return!t.size;if(c(t))return!r(t).length;for(var n in t)if(p.call(t,n))return!1;return!0}},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Stack=e.List=void 0,e.withList=function(){for(var t in i)this[t]=i[t]},e.withStack=function(){for(var t in i)this[t]=i[t]};var i=r(n(188)),a=r(n(189)),u=e.List=function t(){o(this,t)},s=e.Stack=function t(){o(this,t)};u.prototype=i,s.prototype=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.insertAt=function(t,e){return this.__collection__?(-1==(t=this.__collection__.indexOf(e))&&this.__collection__.splice(t,0,e),this):this},e.append=function(t){return this.__collection__||(this.__collection__=[]),-1==this.__collection__.indexOf(t)&&this.__collection__.push(t),this},e.prepend=function(t){return this.__collection__||(this.__collection__=[]),-1==this.__collection__.indexOf(t)&&this.__collection__.unshift(t),this},e.remove=function(t){if(!this.__collection__)return this;var e=this.__collection__.indexOf(t);return e>=0&&this.__collection__.splice(e,1),this},e.getAt=function(t){if(this.__collection__)return this.__collection__[t]},e.forEach=function(t,e){this.__collection__&&this.__collection__.forEach(t,e)},e.indexOf=function(t){if(this.__collection__)return this.__collection__.indexOf(t)},e.size=function(){return this.__collection__?this.__collection__.length:0},e.clear=function(){this.__collection__=[]},e.moveForward=function(t){var e=this.indexOf(t);-1!=e&&0!=e&&(this.__collection__[e]=this.__collection__[e-1],this.__collection__[e-1]=t)},e.moveBackward=function(t){var e=this.indexOf(t);-1!=e&&e!=this.size()-1&&(this.__collection__[e]=this.__collection__[e+1],this.__collection__[e+1]=t)},e.moveToHead=function(t){var e=this.indexOf(t);if(-1!=e&&0!=e){var n=this.__collection__.splice(0,e),r=this.__collection__.splice(1);this.__collection__=this.__collection__.concat(n,r)}},e.moveToTail=function(t){var e=this.indexOf(t);if(-1!=e&&e!=this.size()-1){var n=this.__collection__.splice(0,e),r=this.__collection__.splice(1);this.__collection__=n.concat(r,this.__collection__)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.push=function(t){throw new Error("Not Implemented Yet")},e.pop=function(t){throw new Error("Not Implemented Yet")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(191);Object.defineProperty(e,"compile",{enumerable:!0,get:function(){return function(t){return t&&t.__esModule?t:{default:t}}(r).default}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=l[e.type];return n?new n(t,e):null};var o=r(n(192)),i=r(n(193)),a=r(n(194)),u=r(n(195)),s=r(n(196)),c=r(n(197)),l={rotation:o.default,vibration:i.default,heartbeat:a.default,moving:u.default,outline:s.default,fade:c.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e=this.config.theta,n=void 0===e?6.28:e;this.client.delta("theta",t*n)}}]),e}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e=this.config.theta,n=void 0===e?.2617993877991494:e,r=4*n,o=t*r;t<.25?o*=-1:t<.75?o-=2*n:o=r-o,this.client.delta("theta",o)}}]),e}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e,n=this.config.scale,r=2*((void 0===n?1.3:n)-1);e=t<.5?1+r*t:1+(1-t)*r,this.client.delta("sx",e),this.client.delta("sy",e)}}]),e}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e=this.config,n=e.x,r=void 0===n?0:n,o=e.y,i=void 0===o?0:o;this.client.delta("tx",t*r),this.client.delta("ty",t*i)}}]),e}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e=this.config.rideOn,n=this.client;if(e&&n&&n.root){var r=n.center,o=n.root.findById(e);if(o){var i=o.outline(t),r=n.transcoordS2T(r.x,r.y);o&&(n.delta("tx",i.x-r.x),n.delta("ty",i.y-r.y))}}}}]),e}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(16)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"step",value:function(t){var e,n=this.config,r=n.startAlpha,o=void 0===r?1:r,i=n.endAlpha,a=void 0===i?0:i,u=o>a?a:o,s=2*((o<a?a:o)-u);e=t<.5?1-(u+t*s):1-(u+(1-t)*s),this.client.delta("fade",e)}}]),e}();e.default=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=a[n.type];r&&r(t,e,n)};var o=r(n(199)),i=r(n(72)),a={gradation:o.default,shadow:i.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){n.type;var r=n.subType,o=n.from,i=n.to,a=n.colors;switch(r){case"linear":u=e.createLinearGradient(o.x,o.y,i.x,i.y);break;case"radial":u=e.createRadialGradient(o.x,o.y,o.r,i.x,i.y,i.r);break;default:var u=e.createLinearGradient(o.x,o.y,i.x,i.y)}a&&(a.forEach(function(t){u.addColorStop(t.endPoint,t.color)}),e.fillStyle=u,e.fill())}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n,r,o;return t.forEach(function(t){void 0===e?(e=t.left,n=t.top,r=t.left+t.width,o=t.top+t.height):(e=Math.min(t.left,e),n=Math.min(t.top,n),r=Math.max(t.left+t.width,r),o=Math.max(t.top+t.height,o))}),{left:e,top:n,width:r-e,height:o-n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.drawFill=function(t,e,n,o,a){var u=o.alpha,s=void 0===u?1:u,c=a.fillStyle;if(t.globalAlpha*=s,c)if("string"==typeof c)t.fillStyle=c,t.fill();else if("object"==(void 0===c?"undefined":r(c)))if("gradient"==c.type){t.translate(n.x,n.y);var l=void 0,f=e.width,h=e.height;if("linear"==c.gradientType){var p=3.141592653589793,d=c.rotation;if(d>=.436332&&d<=1.13446||d>=2.00713&&d<=2.70526||d>=3.57792&&d<=4.27606||d>=5.14872&&d<=5.84685){var y=Math.sqrt(Math.pow((f-4)/2,2)+Math.pow((h-4)/2,2));y-=y-(f+h)/3,l=t.createLinearGradient(y*Math.cos(d+p),y*Math.sin(d+p),y*Math.cos(d),y*Math.sin(d))}else l=t.createLinearGradient((f-4)/2*Math.cos(d+p),(h-4)/2*Math.sin(d+p),(f-4)/2*Math.cos(d),(h-4)/2*Math.sin(d))}else if("radial"==c.gradientType){var v=.95*Math.sqrt(Math.pow((f-4)/2,2)+Math.pow((h-4)/2,2));switch(c.center){case"center":l=t.createRadialGradient(0,0,0,0,0,v);break;case"left-top":l=t.createRadialGradient(-f/2,-h/2,0,-f/2,-h/2,2*v);break;case"right-top":l=t.createRadialGradient(f/2,-h/2,0,f/2,-h/2,2*v);break;case"left-bottom":l=t.createRadialGradient(-f/2,h/2,0,-f/2,h/2,2*v);break;case"right-bottom":l=t.createRadialGradient(f/2,h/2,0,f/2,h/2,2*v);break;default:l=t.createRadialGradient(0,0,0,0,0,v)}}c.colorStops.forEach(function(t){if(t.position>=0&&t.position<=1)try{l.addColorStop(t.position,t.color)}catch(e){(0,i.warn)("Invalid Color for colorstop : ",t.color),l.addColorStop(t.position,"#fff")}}),t.fillStyle=l,t.fill(),t.translate(-n.x,-n.y)}else if("pattern"==c.type&&c.image){a.prepareFillIf(!a._pattern_image_origin);var g=a._pattern_image;if(!g)return;var b=0,_=0,m=0,w=0,x=e.left,k=e.top;if(!c.fitPattern){switch(b=c.offsetX,_=c.offsetY,c.align){case"center":m=e.width/2-(c.width?c.width/2:0),w=e.height/2+(c.height?c.height/2:0);break;case"left-top":break;case"left-bottom":w=c.height?e.height%c.height:e.height;break;case"right-top":m=c.width?e.width%c.width:e.width;break;case"right-bottom":m=c.width?e.width%c.width:e.width,w=c.height?e.height%c.height:e.height;break;case"left":w=e.height/2+(c.height?c.height/2:0);break;case"right":m=c.width?e.width%c.width:e.width,w=e.height/2+(c.height?c.height/2:0);break;case"top":m=e.width/2-(c.width?c.width/2:0);break;case"bottom":m=e.width/2-(c.width?c.width/2:0),w=c.height?e.height%c.height:e.height}x+=b+m,k+=_+w}t.translate(x,k),c.fitPattern?Math.abs((g.width-e.width)*(g.height-e.height))>1?(delete a._pattern_image,delete a._pattern_image_origin):t.fillStyle=t.createPattern(g,"no-repeat"):t.fillStyle=t.createPattern(g,"repeat"),t.fill(),t.translate(-x,-k)}},e.prepareFill=function(t,e){var n=this.fillStyle;if(n&&"pattern"==n.type&&n.image){if("string"!=typeof n.image)return this._pattern_image_origin=this._pattern_image=n.image,void t(this);this._pattern_image=null,this._pattern_image_origin=new Image;var r=this;this._pattern_image_origin.onload=function(){if(!n.fitPattern&&!n.width&&!n.height)return r._pattern_image=r._pattern_image_origin,void t(this);var e=n.width||this.width,i=n.height||this.height;n.fitPattern&&(e=r.bounds.width,i=r.bounds.height);var a=(0,o.createCanvas)(e,i);a.getContext("2d").drawImage(this,0,0,this.width,this.height,0,0,e,i),r._pattern_image=a,t(this)},this._pattern_image_origin.onerror=function(t){e(t)};try{"data"!==String(n.image).substring(0,4)?this._pattern_image_origin.crossOrigin="use-credentials":this._pattern_image_origin.crossOrigin=null,this._pattern_image_origin.src=this.app.url(n.image)}catch(t){e(t)}}else t(this)},e.prepareFillIf=function(t){var e=this;t&&this.prepareFill(function(t){e.invalidate()},function(t){(0,i.error)(t)})},e.onchangeFill=function(t,e){var n=this.fillStyle;"pattern"===n.type?this.prepareFillIf(n.image):this._pattern_image&&(this._pattern_image=null,this._pattern_image_origin=null)};var o=n(75),i=n(1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=t.path.slice();if(n&&n.length){var o=1,i=[];if(t.isLine()||n.push(n[0]),e<=0)return t.transcoordS2T(n[0].x,n[0].y);if(e>=1)return t.transcoordS2T(n[n.length-1].x,n[n.length-1].y);for(;n[o];){var a=n[o-1],u=n[o],s=u.x-a.x,c=u.y-a.y;i.push(Math.sqrt(s*s+c*c)),o++}var l=i.reduce(function(t,e){return t+e},0);o=0;var f=0;do{f+=i[o++]}while(f/l<e);e=(e-(f-=i[--o])/l)*(l/i[o]);var h=n[o%n.length],p=n[(o+1)%n.length],d=h.x+Math.round((p.x-h.x)*e),y=h.y+Math.round((p.y-h.y)*e);return t.transcoordS2T(d,y)}(0,r.error)("path should not be empty")};var r=n(1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=e.strokeStyle,o=e.lineDash,i=e.lineWidth,a=e.lineCap,u=e.lineJoin,s=e.alpha;if(r&&0!=i){if(a&&(t.lineCap=a),o){var c="round"==a;switch(o){case"solid":o=[0,0];break;case"round-dot":o=c?[0,2*i]:[i,i];break;case"square-dot":o=c?[i,2*i]:[2*i,i];break;case"dash":o=c?[3*i,2.5*i]:[4*i,1.5*i];break;case"dash-dot":o=c?[3*i,3*i,0,3*i]:[4*i,2*i,i,2*i];break;case"long-dash":o=c?[5*i,4*i]:[6*i,3*i];break;case"long-dash-dot":o=c?[5*i,3*i,0,3*i]:[6*i,2*i,i,2*i];break;case"long-dash-dot-dot":o=c?[5*i,2*i,0,2*i,0,2*i]:[6*i,i,i,i,i,i]}t.setLineDash(o)}t.globalAlpha*=s,t.strokeStyle=r,t.lineWidth=i,t.lineJoin=u,t.stroke()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this;this._model.effects&&this._model.effects.forEach(function(n){e.effect(t,n)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(!t||isNaN(+e))return e;var n,r,o,i,a,u,s,c,l,f=t.length,h=t.search(/[0-9\-\+#]/),p=h>0?t.substring(0,h):"",d=t.split("").reverse().join(""),y=d.search(/[0-9\-\+#]/),v=f-y,g=t.substring(v,v+1),b=v+("."===g||","===g?1:0),_=y>0?t.substring(b,f):"";if(t=t.substring(h,b),e="-"===t.charAt(0)?-e:+e,n=e<0?e=-e:0,r=t.match(/[^\d\-\+#]/g),o=r&&r[1]&&r[0]||",",t=t.split("."),e=e.toFixed(t[1]&&t[1].length),e=+e+"",a=t[1]&&t[1].lastIndexOf("0"),(!(s=e.split("."))[1]||s[1]&&s[1].length<=a)&&(e=(+e).toFixed(a+1)),c=t[0].split(o),t[0]=c.join(""),(i=t[0]&&t[0].indexOf("0"))>-1)for(;s[0].length<t[0].length-i;)s[0]="0"+s[0];else 0==+s[0]&&(s[0]="");if(e=e.split("."),e[0]=s[0],u=c[1]&&c[c.length-1].length){for(d="",v=(l=e[0]).length%u,f=l.length,b=0;b<f;b++)d+=l.charAt(b),!((b-v+1)%u)&&b<f-u&&(d+=o);e[0]=d}e[1]=t[1]&&e[1]?"."+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1);var m;return m="+"==t[0].substring(0,1)?n?"-":"+":n?"-":"",p+(m+r)+_}},function(t,e,n){"use strict";function r(t){var e=t.fontFamily,n=void 0===e?o.DEFAULT.FONT_FAMILY:e,r=t.bold,i=void 0===r?o.DEFAULT.BOLD:r,a=t.italic,u=void 0===a?o.DEFAULT.ITALIC:a,s=t.fontSize,c=void 0===s?o.DEFAULT.FONT_SIZE:s,l=[];return i&&l.push("bold"),u&&l.push("italic"),l.push(c+"px"),l.push(n),l.join(" ")}Object.defineProperty(e,"__esModule",{value:!0}),e.textLines=function(t,e,n,r,o){if(!r)return[];t.save(),t.font=n;var a=(0,i.default)(t,r,e,!!o);return t.restore(),a},e.font=r,e.drawText=function(t,e,n,i){var a=i.alpha,u=void 0===a?o.DEFAULT.FONT_COLOR:a,s=i.fontColor,c=void 0===s?o.DEFAULT.FONT_COLOR:s,l=i.textAlign,f=void 0===l?o.DEFAULT.TEXT_ALIGN:l,h=i.textBaseline,p=void 0===h?o.DEFAULT.TEXT_BASELINE:h,d=i.fontSize,y=void 0===d?o.DEFAULT.FONT_SIZE:d,v=i.lineHeight,g=void 0===v?1.2*y:v;t.save(),t.beginPath();var b=e.left,_=e.top,m=e.width,w=e.height;t.font=r(i);var x,k=n.length*g;switch(p){case"top":x=_,t.textBaseline="top";break;case"bottom":x=_+w-k+g,t.textBaseline="bottom";break;case"middle":default:x=_+w/2-k/2+g/2,t.textBaseline="middle"}var O;switch(f){case"left":O=b,t.textAlign="left";break;case"right":O=b+m,t.textAlign="right";break;case"justify":O=b,t.textAlign="left";break;case"center":default:O=b+m/2,t.textAlign="center"}t.globalAlpha*=u,t.fillStyle=c,"justify"!=f?n.forEach(function(e,n){t.fillText(e.join(" "),O,x+n*g)}):n.forEach(function(e,n){var r=x+n*g;if(1==e.length)t.fillText(e[0],O,r);else{var o=e.map(function(e){return t.measureText(e).width}),i=o.reduce(function(t,e){return t+e},0),a=(m-i)/(e.length-1),u=O;e.forEach(function(e,n){t.fillText(e,u,r),u+=o[n]+a})}}),t.restore()};var o=n(2),i=function(t){return t&&t.__esModule?t:{default:t}}(n(76))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=this,o=this.path,i=this.rotatePoint;this.get("rotation"),this.get("scale"),t&&(o=t.call(n,o));var a=o.map(function(t){return r.transcoordS2P(t.x,t.y)});e&&(o=e.call(n,a))&&(a=o);var u,s,c,l,f={x:0,y:0};u=s=(o=a.map(function(t){return r.transcoordP2S(t.x,t.y,f)}))[0].x,c=l=o[0].y;for(var h=1;h<o.length;h++){var p=o[h];p.x<u?u=p.x:p.x>s&&(s=p.x),p.y<c?c=p.y:p.y>l&&(l=p.y)}i={x:(u+s)/2,y:(c+l)/2},i=this.transcoordS2P(i.x,i.y,f),this.path=a.map(function(t){return r.transcoordP2S(t.x,t.y,i)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=this.bounds,o=this.rotatePoint,i=this.get("rotation"),a=this.get("scale");if(t){var u=t.call(e,n);u&&(n=u)}var s=n,c=s.left,l=s.top,f=[{x:c,y:l},{x:c+s.width,y:l+s.height}],h=(f=f.map(function(t){return r.default.transcoordRR(t.x,t.y,o,i,a)}))[0],p=f[1];o={x:(h.x+p.x)/2,y:(h.y+p.y)/2},h=(f=f.map(function(t){return r.default.transcoordR(t.x,t.y,o,i,a)}))[0],p=f[1],this.bounds={left:h.x,top:h.y,width:p.x-h.x,height:p.y-h.y}};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(0))},function(t,e,n){"use strict";function r(){var t=this;this.mappings&&this.mappings.forEach(function(e){try{var n=e.target,r=e.property,i=e.accessor;if(void 0==(i=i(t.data)))return;if("(root)"==(n=n.trim())||"(key)"==n){if((f=Object.keys(i||{}).map(function(e){return t.root.findOrCreate(e)}).filter(function(t){return!!t})).length>0){var a=e.evaluator(i,f);f.forEach(function(t){return t[r]=a[t.get("id")]})}}else if(n.startsWith("[")){if(!n.endsWith("]"))throw String("mapping target should end with ']' to designate property-id.("+n+")");var u=n.substring(1,n.length-1),s=e.evaluator(i,f);if(s instanceof Array)s.forEach(function(e){var n=e[u];if(n){var o=t.root.findOrCreate(n);o&&(o[r]=e)}});else{if(!(s instanceof Object))throw String("mapping data should be an object to target property-id.("+t.data+")");var c=s[u];if(c){var l=t.root.findOrCreate(c);l&&(l[r]=s)}}}else{var f=t.root.findAll(n,t);if(f.length>0){var h=e.evaluator(i,f);f.forEach(function(t){return t[r]=h})}}}catch(n){(0,o.error)(n,t,e)}})}Object.defineProperty(e,"__esModule",{value:!0}),e.executeMappings=r,e.onchangeData=function(t,e){r.call(this)},e.buildMappings=function(){var t=this;if(this._model.mappings)return!this._model.mappings instanceof Array?((0,o.error)("Mappings model is invalid (should be a Array) ..",this._model.mappings),void(this._mappings=[])):void(this._mappings=(this._model.mappings||[]).map(function(e){return new i.default(e,t)}));this._mappings=[]},e.disposeMappings=function(){this._mappings&&this._mappings.forEach(function(t){return t.dispose()}),delete this._mappings},e.onchangeMappings=function(t,e){this.disposeMappings(),r.call(this)};var o=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(n(210))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(211)),a=r(n(212)),u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.owner=n,this.model=e}return o(t,[{key:"dispose",value:function(){delete this._model,delete this.owner,delete this.evaluator,delete this.accessor}},{key:"model",get:function(){return this._model},set:function(t){t.target;var e=t.property,n=t.rule,r=t.param,o=t.accessor;this._model=t,this.evaluator=(0,i.default)(this,this.owner,n,r,function(t){switch(t){case"ref":case"fillStyle":case"strokeStyle":return"string";default:return}}(e)),this.accessor=(0,a.default)(o)}},{key:"target",get:function(){return this.model.target}},{key:"property",get:function(){return this.model.property}},{key:"param",get:function(){return this.model.param}}]),t}();e.default=u},function(module,exports,__webpack_require__){"use strict";function tostring(t){var e=(0,_utils.objToVal)(t);return void 0==e?"":String(e)}function tonumber(t){return Number((0,_utils.objToVal)(t))}function value(t){return t}function valueString(t){return tostring(t)}function valueNumber(t){return tonumber(t)}function map(t){if(this.param)return t=tostring(t),this.param.hasOwnProperty(t)?this.param[t]:this.param.default}function range(t){var e=this.param;if(e){for(var n in e){var r=n.split("~"),o=_slicedToArray(r,2),i=o[0],a=o[1],u=!!i,s=!!a;if(i=parseFloat(i),a=parseFloat(a),t=tonumber(t),u&&!s&&t>=i)return e[n];if(!u&&s&&t<i)return e[n];if(t>=i&&t<a)return e[n]}return e.default}}function radian(t){return tonumber(t)*Math.PI/180}function noop(){}function build(script){var evaluator;try{return eval("evaluator = function(value, targets) {"+script+"}"),evaluator}catch(t){return(0,_logger.error)(t),function(){}}}function buildEvaluator(mapping,owner,rule,param,type){switch(rule){case"value":return"text"===type||"string"===type?function(t){return tostring(t)}.bind(mapping):"number"===type?function(t){return tonumber(t)}.bind(mapping):value.bind(owner);case"map":return function(t){if(this.param)return t=tostring(t),this.param.hasOwnProperty(t)?this.param[t]:this.param.default}.bind(mapping);case"range":return function(t){var e=this.param;if(e){for(var n in e){var r=n.split("~"),o=_slicedToArray(r,2),i=o[0],a=o[1],u=!!i,s=!!a;if(i=parseFloat(i),a=parseFloat(a),t=tonumber(t),u&&!s&&t>=i)return e[n];if(!u&&s&&t<i)return e[n];if(t>=i&&t<a)return e[n]}return e.default}}.bind(mapping);case"radian":return function(t){return tonumber(t)*Math.PI/180}.bind(mapping);case"eval":return function(script){var evaluator;try{return eval("evaluator = function(value, targets) {"+script+"}"),evaluator}catch(t){return(0,_logger.error)(t),function(){}}}(param).bind(owner);default:return value.bind(owner)}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=function(mapping,owner,rule,param,type){switch(rule){case"value":return"text"===type||"string"===type?function(t){return tostring(t)}.bind(mapping):"number"===type?function(t){return tonumber(t)}.bind(mapping):value.bind(owner);case"map":return function(t){if(this.param)return t=tostring(t),this.param.hasOwnProperty(t)?this.param[t]:this.param.default}.bind(mapping);case"range":return function(t){var e=this.param;if(e){for(var n in e){var r=n.split("~"),o=_slicedToArray(r,2),i=o[0],a=o[1],u=!!i,s=!!a;if(i=parseFloat(i),a=parseFloat(a),t=tonumber(t),u&&!s&&t>=i)return e[n];if(!u&&s&&t<i)return e[n];if(t>=i&&t<a)return e[n]}return e.default}}.bind(mapping);case"radian":return function(t){return tonumber(t)*Math.PI/180}.bind(mapping);case"eval":return function(script){var evaluator;try{return eval("evaluator = function(value, targets) {"+script+"}"),evaluator}catch(t){return(0,_logger.error)(t),function(){}}}(param).bind(owner);default:return value.bind(owner)}};var _logger=__webpack_require__(1),_utils=__webpack_require__(3)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!t)return r;var e=String(t).trim().replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".").filter(function(t){return!!t.trim()});return e.length>0?function(t){return e.reduce(function(t,e){return t?t[e]:void 0},t)}:r};var r=function(t){return t}},function(t,e,n){"use strict";function r(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:1,y:1};return t-=n.x,e-=n.y,{x:(t*Math.cos(-r)-e*Math.sin(-r)+n.x)/o.x,y:(t*Math.sin(-r)+e*Math.cos(-r)+n.y)/o.y}}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:1,y:1};return t-=n.x,e-=n.y,{x:(t*Math.cos(r)-e*Math.sin(r)+n.x)*o.x,y:(t*Math.sin(r)+e*Math.cos(r)+n.y)*o.y}}Object.defineProperty(e,"__esModule",{value:!0}),e.transcoordR=r,e.transcoordRR=o,e.transcoordP2S=function(t,e,n){if(!this.parent)return{x:t,y:e};var o=this.model,i=o.rotation,a=void 0===i?0:i,u=o.scale,s=void 0===u?{x:1,y:1}:u;if(this.isLayer()){var c=this.model.translate,l=r(t,e,c,a,s);return c&&(l.x-=c.x/(s?s.x:1),l.y-=c.y/(s?s.y:1)),l}var f=r(t,e,n=n||this.rotatePoint,a,s);return{x:f.x+(n.x-n.x/s.x),y:f.y+(n.y-n.y/s.y)}},e.transcoordS2P=function(t,e,n){if(!this.parent)return{x:t,y:e};var r=this.model,i=r.rotation,a=void 0===i?0:i,u=r.scale,s=void 0===u?{x:1,y:1}:u;if(this.isLayer()){var c=this.model.translate,l=o(t,e,void 0,a,s);return c&&(l.x+=c.x,l.y+=c.y),l}var f=o(t,e,n=n||this.rotatePoint,a,s);return{x:f.x-(n.x-n.x/s.x),y:f.y-(n.y-n.y/s.y)}},e.transcoordS2TR=function(t,e,n){var n=n||this.rootModel,r=this.transcoordS2T(t,e,n);return o(r.x,r.y,void 0,n.get("rotation")||0)},e.transcoordS2T=function(t,e,n){for(var n=n||this.rootModel,r=[],o=this.parent;o&&o!==n;o=o.parent)r.push(o);var i=this.transcoordS2P(t,e);return r.forEach(function(t){var e=t.model.scale,n=t.bounds;if(e){var r=t.rotatePoint;i.x+=(r.x-n.left)*e.x,i.y+=(r.y-n.top)*e.y}else i.x+=n.left,i.y+=n.top;i=t.transcoordS2P(i.x,i.y)}),i},e.transcoordT2S=function(t,e,n){for(var n=n||this.rootModel,r=[],o=this.parent;o&&o!==n;o=o.parent)r.splice(0,0,o);var i={x:t,y:e};return r.forEach(function(t){var e=t.model.scale;i=t.transcoordP2S(i.x,i.y);var n=t.bounds;if(e){var r=t.rotatePoint;i.x-=(r.x-n.left)/e.x,i.y-=(r.y-n.top)/e.y}else i.x-=n.left,i.y-=n.top}),this.transcoordP2S(i.x,i.y)},e.transcoordS2O=function(t,e,n){var r=this.rootModel,o=this.transcoordS2T(t,e,r);return n.transcoordT2S(o.x,o.y,r)},e.transcoordC2S=function(t,e,n){if(!n)for(n=this;n&&!n.isLayer();)n=n.parent;var o=n.model,i=o.translate,a=o.scale,u=r(t,e,i,o.rotation,a);return i&&(u.x-=i.x/(a?a.x:1),u.y-=i.y/(a?a.y:1)),n===this?u:this.transcoordT2S(u.x,u.y,n)},e.transcoordS2C=function(t,e,n){if(!n)for(n=this;n&&!n.isLayer();)n=n.parent;if(n!==this)r=this.transcoordS2T(t,e,n);else var r={x:t,y:e};var i=n.model,a=i.translate,u=i.rotation,s=i.scale;return r=o(r.x,r.y,void 0,u,s),a&&(r.x+=a.x,r.y+=a.y),r};!function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(2))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.element,n=t.fillStyle,r=e.style;if(r.background="",n)if("string"==typeof n)r.backgroundColor=n;else switch(n.type){case"pattern":r.backgroundImage="url("+n.image+")",n.fitPattern?r.backgroundSize="100% 100%":n.width||n.height?r.backgroundSize=(n.width?n.width+"px":"auto")+" "+(n.height?n.height+"px":"auto"):r.backgroundSize="contain";break;case"gradient":r.background=function(t,e){var n=e.colorStops,r=e.gradientType;if(n instanceof Array&&n.length>0)switch(r){case"radial":var o=e.center||"center";return"radial-gradient(farthest-corner at "+function(t,e){var n=t.bounds,r=n.width,o=n.height;switch(e){case"center":return[r/2,o/2];case"left-top":return[0,0];case"right-top":return[r,0];case"left-bottom":return[0,o];default:return[r,o]}}(t,o).map(function(t){return t+"px"}).join(" ")+","+n.map(function(t){return t.color+" "+100*t.position+"%"}).join(",")+")";case"linear":return"linear-gradient("+(180*(e.rotation||0)/3.141592653589793+90)+"deg, "+n.map(function(t){return t.color+" "+100*t.position+"%"}).join(",")+")"}return""}(t,n)}};n(2)},function(t,e,n){"use strict";function r(t){return!t.disposed&&t.retention>0&&!t.isTemplate()&&t.app&&t.app.isViewMode}Object.defineProperty(e,"__esModule",{value:!0});var o,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),u=n(1),s=[],c=(0,a.throttle)(function(){requestAnimationFrame(function(){o=null;var t=performance.now(),e=(s=s.filter(function(t){return r(t)})).reduce(function(e,n){var r=t-n.updatedAt;return r>=n.retention?e.kills.push(n):e.next=0==e.next?n.retention-r:Math.min(e.next,n.retention-r),e},{next:0,kills:[]});e.kills.forEach(function(t){var e=s.indexOf(t);-1!=e?(s.splice(e,1),t.removeSelf(!0)):(0,u.error)("Should not be here. Maybe reentrance problem.")}),e.next>0&&(o=setTimeout(c,Math.max(e.next,500)))})},500),l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"add",value:function(t){r(t)&&-1==s.indexOf(t)&&(s.push(t),t.touch()),this.touch()}},{key:"remove",value:function(t){var e=s.indexOf(t);e>0&&s.splice(e,1),this.touch()}},{key:"touch",value:function(){null!==o&&(clearTimeout(o),o=null),c()}},{key:"length",get:function(){return s.length}}]),t}();e.default=new l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={reflow:function(t,e){},capturables:function(t){return t.components},drawables:function(t){return t.components.filter(function(t){return!t.hidden})},isStuck:function(t){return!1},ABSOLUTE:!0};(function(t){return t&&t.__esModule?t:{default:t}})(n(13)).default.register("absolute",r),e.default=r},function(t,e,n){"use strict";function r(t){var e=t.components.filter(function(t){return!t.hidden}),n=t.get("layoutConfig"),r=e[n&&n.activeIndex||0];return r&&[r]||[]}Object.defineProperty(e,"__esModule",{value:!0});var o={reflow:function(t){var e=t.bounds,n={left:0,top:0,width:e.width,height:e.height};t.forEach(function(t){t.bounds=n,t.set("rotation",0)})},capturables:function(t){return r(t)},drawables:function(t){return r(t)},isStuck:function(t){return!0}};(function(t){return t&&t.__esModule?t:{default:t}})(n(13)).default.register("card",o),e.default=o},function(t,e,n){"use strict";function r(t){var e=t.get("layoutConfig");return e?e.weight||1:1}Object.defineProperty(e,"__esModule",{value:!0});var o={reflow:function(t){var e=this.drawables(t),n=t.get("padding")||{},o=e.reduce(function(t,e){return t+r(e)},0),i=t.bounds,a=o>0?(i.width-((n.left||0)+(n.right||0)))/o:i.width,u=i.height-((n.top||0)+(n.bottom||0)),s=0;e.forEach(function(t){var e=r(t),o=t.get("margin")||{};t.bounds={left:a*s+(n.left||0)+(o.left||0),top:0+(n.top||0)+(o.top||0),width:e*a-((o.left||0)+(o.right||0)),height:u-((o.top||0)+(o.bottom||0))},t.set("rotation",0),s+=e})},capturables:function(t){return t.components},drawables:function(t){return t.components.filter(function(t){return!t.hidden})},isStuck:function(t){return!0}};(function(t){return t&&t.__esModule?t:{default:t}})(n(13)).default.register("linear-horizontal",o),e.default=o},function(t,e,n){"use strict";function r(t){var e=t.get("layoutConfig");return e?e.weight||1:1}Object.defineProperty(e,"__esModule",{value:!0});var o={reflow:function(t){var e=this.drawables(t),n=t.get("padding")||{},o=e.reduce(function(t,e){return t+r(e)},0),i=t.bounds,a=o>0?(i.height-((n.top||0)+(n.bottom||0)))/o:i.height,u=i.width-((n.left||0)+(n.right||0)),s=0;e.forEach(function(t){var e=r(t),o=t.get("margin")||{};t.bounds={left:0+(n.left||0)+(o.left||0),top:a*s+(n.top||0)+(o.top||0),width:u-((o.left||0)+(o.right||0)),height:e*a-((o.top||0)+(o.bottom||0))},t.set("rotation",0),s+=e})},capturables:function(t){return t.components},drawables:function(t){return t.components.filter(function(t){return!t.hidden})},isStuck:function(t){return!0}};(function(t){return t&&t.__esModule?t:{default:t}})(n(13)).default.register("linear-vertical",o),e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={reflow:function(t){var e=t.get("layoutConfig"),n=e&&e.columns||t.get("columns"),r=e&&e.rows||t.get("rows"),o=e&&e.widths||t.get("widths"),i=e&&e.heights||t.get("heights"),a=o?o.filter(function(t,e){return e<n}).reduce(function(t,e){return t+e},0):n,u=i?i.filter(function(t,e){return e<r}).reduce(function(t,e){return t+e},0):r,s=t.textBounds,c=t.get("paddingLeft")||0,l=t.get("paddingTop")||0,f=s.width/a,h=s.height/u,p=0,d=0;t.components.forEach(function(t,e){for(var r=o?o[e%n]:1,a=i?i[Math.floor(e/n)]:1,u=t.colspan||1,s=0;--u>0;)s+=o?o[(e+u)%n]:1;for(var y=t.rowspan||1,v=0;--y>0;)v+=i?i[Math.floor(e/n)+y]:1;t.bounds={left:c+p,top:l+d,width:f*(r+s),height:h*(a+v)},t.set("rotation",0),e%n==n-1?(p=0,d+=a*h):p+=r*f})},capturables:function(t){return t.components.filter(function(t){return!t.merged})},drawables:function(t){return t.components.filter(function(t){return!t.merged})},isStuck:function(t){return!0},keyNavigate:function(t,e,n){var r=t.get("layoutConfig"),o=r&&r.columns||t.get("columns"),i=r&&r.rows||t.get("rows"),a=t.getRowColumn(e),u=a.row,s=a.column;switch(n.code){case"ArrowUp":if(u>0)return t.getAt((u-1)*o+s);break;case"ArrowDown":if(u<i-1)return t.getAt((u+1)*o+s);break;case"ArrowRight":if(s<o-1)return t.getAt(u*o+s+1);break;case"ArrowLeft":if(s>0)return t.getAt(u*o+s-1);break;default:return e}},joinType:!0};(function(t){return t&&t.__esModule?t:{default:t}})(n(13)).default.register("table",r),e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(13)),i=r(n(35)),a={reflow:function(t,e){this.drawables(t).filter(function(t){return t.isHTMLElement()}).forEach(function(t){return(0,i.default)(t)})},capturables:function(t){return t.components},drawables:function(t){return t.components.filter(function(t){return!t.hidden})},isStuck:function(t){return!1},ABSOLUTE:!0};o.default.register("html-absolute",a),e.default=a},function(t,e,n){"use strict";function r(t,e,n){var r=t.unitScale;e.set("scale",{x:r,y:r}),e.set("translate",{x:0,y:0})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this.model_layer.model,n=e.width,o=e.height,i=this.target_element,a=this.model_layer;if(n&&o&&i&&i.offsetWidth&&i.offsetHeight)switch(t){case"center":!function(t,e,n){var r=t.unitScale,o=e.model,i=o.width,a=o.height;e.set("scale",{x:r,y:r}),e.set("translate",{x:Math.max((n.offsetWidth-i*r)/2,0),y:Math.max((n.offsetHeight-a*r)/2,0)})}(this,a,i);break;case"both":!function(t,e,n){var r=e.model,o=r.width,i=r.height,a=n.offsetWidth,u=n.offsetHeight;e.set("scale",{x:a/o,y:u/i}),e.set("translate",{x:0,y:0})}(0,a,i);break;case"width":!function(t,e,n){var r=n.offsetWidth/e.get("width");e.set("scale",{x:r,y:r}),e.set("translate",{x:0,y:0})}(0,a,i);break;case"height":!function(t,e,n){var r=n.offsetHeight/e.get("height");e.set("scale",{x:r,y:r}),e.set("translate",{x:0,y:0})}(0,a,i);break;case"ratio":!function(t,e,n){var r=e.model,o=r.width,i=r.height,a=n.offsetWidth,u=n.offsetHeight,s=a/o,c=u/i,l=Math.min(s,c);e.set("scale",{x:l,y:l}),e.set("translate",{x:(a-o*l)/2,y:(u-i*l)/2})}(0,a,i);break;case"none":default:r(this,a)}else r(this,a)}},function(t,e,n){"use strict";function r(t,e,n,r,o,i){var u=e.x,s=e.y,c=Math.atan2(n.y-s,n.x-u);switch(t.beginPath(),t.translate(u,s),t.rotate(c),o){case"oval":t.ellipse(0,0,i.X,i.Y,0,0,2*Math.PI),t.fill();break;case"diamond":t.moveTo(-i.X,0),t.lineTo(0,-i.Y),t.lineTo(i.X,0),t.lineTo(0,i.Y),t.fill();break;case"arrow":t.moveTo(0,0),t.lineTo(a*i.X,-i.Y),t.lineTo(a*i.X,i.Y),t.fill();break;case"sharp-arrow":t.moveTo(0,0),t.lineTo(a*i.X,-i.Y),t.lineTo(-i.X/1.5+a*i.X,0),t.lineTo(a*i.X,i.Y),t.fill();break;case"open-arrow":t.moveTo(a*i.X+r,-i.Y),t.lineTo(r,0),t.lineTo(a*i.X+r,i.Y),t.stroke()}t.rotate(-c),t.translate(-u,-s),t.closePath()}function o(t,e){var n={};switch(e*=1.2,t){case"size1":n.X=e,n.Y=e;break;case"size2":n.X=1.5*e,n.Y=e;break;case"size3":n.X=2*e,n.Y=e;break;case"size4":n.X=e,n.Y=1.5*e;break;case"size5":n.X=1.5*e,n.Y=1.5*e;break;case"size6":n.X=2*e,n.Y=1.5*e;break;case"size7":n.X=e,n.Y=2*e;break;case"size8":n.X=1.5*e,n.Y=2*e;break;case"size9":n.X=2*e,n.Y=2*e;break;default:n.X=1.5*e,n.Y=1.5*e}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.containedInPath=function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=0;o<n.length-1;o++)if(function(t,e,n,r,o){var a=i+o,u=n.x,s=n.y,c=r.x,l=r.y;if(Math.abs(u-c)>a&&Math.abs(s-l)>a){var f=(l-s)/(c-u),h=s-f*u;if(Math.abs(e-(f*t+h))>a)return!1}var p,d,y,v;return u>c?(d=u,p=c):(d=c,p=u),s>l?(v=s,y=l):(v=l,y=s),!(d+i<t||p-i>t||v+i<e||y-i>e)}(t,e,n[o],n[o+1],r))return!0;return!1},e.getTipNeckPos=function(t,e,n,r){if("arrow"!=t.slice(-5))return n;n.x,n.y;var o=Math.atan2(r.y-n.y,r.x-n.x),i=1.5*e;return{x:n.x+Math.cos(o)*i,y:n.y+Math.sin(o)*i}},e.drawEndTips=function(t,e,n){var i=n.lineWidth,a=void 0===i?u:i,s=n.strokeStyle,c=void 0===s?"#000000":s,l=n.lineCap,f=void 0!==l&&l,h=n.alpha,p=void 0===h?1:h,d=n.begin,y=void 0===d?"none":d,v=n.end,g=void 0===v?"none":v,b=n.beginSize,_=void 0===b?"size5":b,m=n.endSize,w=void 0===m?"size5":m;if(("none"!=y||"none"!=g)&&(a=Number(a)||u,t.lineCap=f,t.lineWidth=a,t.strokeStyle=c,t.fillStyle=c,t.globalAlpha*=p,"none"!=y&&r(t,e[0],e[1],a,y,o(_,a)),"none"!=g)){var x=e.length;r(t,e[x-1],e[x-2],a,g,o(w,a))}};var i=5,a=Math.sqrt(3),u=2},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=t.model,r=n.cx,o=n.cy,i=n.rx,a=n.ry,u=2*Math.PI*e,s=r+i*Math.cos(u),c=o+a*Math.sin(u);return t.transcoordS2T(s,c)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u={ondragstart:function(t,e,n){n.mutatePath(null,function(n){n.splice(e+1,0,t)})},ondragmove:function(t,e,n){n.mutatePath(null,function(n){n[e+1]=t})},ondragend:function(t,e,n){}},s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_draw",value:function(t){var e=this.model.path,n=void 0===e?[]:e;if(!(n.length<=1)){t.beginPath(),t.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)t.lineTo(n[r].x,n[r].y);t.closePath()}}},{key:"contains",value:function(t,e){var n=this.model.path,r=!1;return n.forEach(function(o,i){var a=(i+n.length+1)%n.length,u=o.x,s=o.y,c=n[a].x,l=n[a].y;s>e!=l>e&&t<(c-u)*(e-s)/(l-s)+u&&(r=!r)}),r}},{key:"mutable",get:function(){return!0}},{key:"pathExtendable",get:function(){return!0}},{key:"path",get:function(){return this.model.path},set:function(t){this.set("path",t)}},{key:"controls",get:function(){var t=this.path;return t.map(function(e,n){var r=t[n+1>=t.length?0:n+1];return{x:(e.x+r.x)/2,y:(e.y+r.y)/2,handler:u}})}}]),e}();e.default=s,i.default.memoize(s.prototype,"controls",!1),i.default.register("polygon",s)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(81)),u={ondragstart:function(t,e,n){n.mutatePath(null,function(n){n.splice(e,0,t)})},ondragmove:function(t,e,n){n.mutatePath(null,function(n){n[e]=t})},ondragend:function(t,e,n){}},s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"pathExtendable",get:function(){return!0}},{key:"path",get:function(){return this.model.path},set:function(t){this.set("path",t)}},{key:"controls",get:function(){for(var t=this.path,e=[],n=0;n<t.length-1;n++){var r=t[n],o=t[n+1];0==n&&e.push({x:r.x,y:r.y,handler:u}),e.push({x:(r.x+o.x)/2,y:(r.y+o.y)/2,handler:u}),n==t.length-2&&e.push({x:o.x,y:o.y,handler:u})}return e}}]),e}();e.default=s,i.default.memoize(s.prototype,"controls",!1),i.default.register("polyline",s)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u=r(n(4)),s=n(1),c={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"image-selector",label:"image-src",name:"src",property:{displayField:"id",displayFullUrl:!0,baseUrlAlias:"$base_url",defaultStorage:"scene-image",storageFilters:{type:Array,value:[{name:"category",value:"image"}]},useUpload:!0}}],"value-property":"src"},l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,u.default)(a.default)),o(e,[{key:"dispose",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this),this._offcanvas=null,this._image=null}},{key:"_draw",value:function(t){var n=this.model,r=n.left,o=n.top,i=n.width,a=n.height,u=n.isGray,s=void 0!==u&&u,c=n.alpha,l=void 0===c?1:c,f=n.src;if(this.prepareIf(!this._image&&f),t.beginPath(),t.globalAlpha*=l,this._image&&this._image.complete)if(s&&this._offcanvas)t.drawImage(this._offcanvas,r,o,i,a);else try{t.drawImage(this._image,r,o,i,a)}catch(n){t.drawImage(e.noimage,r,o,i,a)}else t.drawImage(e.noimage,r,o,i,a)}},{key:"prepare",value:function(t,e){var n=this,r=this.model.src;if(r){this._image=new Image;try{"data"!==String(r).substring(0,4)?this._image.crossOrigin="use-credentials":this._image.crossOrigin=null,this._image.src="string"==typeof r?this.app.url(r):r}catch(t){return void e(t)}this._image.onload=function(){if(n.get("isGray")){var e=n._image.width,r=n._image.height;n._offcanvas=i.default.createCanvas(e,r);var o=n._offcanvas.getContext("2d");o.drawImage(n._image,0,0);var a=function(t,e,n){try{var r=t.getImageData(0,0,e,n)}catch(t){return(0,s.error)("Get Image Data Error: "+t.message),null}for(var o=r.data,i=0;i<e*n*4;i+=4){var a=o[i],u=o[i+1],c=o[i+2],l=parseInt((a+u+c)/3);r.data[i]=l,r.data[i+1]=l,r.data[i+2]=l}return r}(o,e,r);o.putImageData(a,0,0)}t(n)},this._image.onerror=function(t){e(t)}}else t(this)}},{key:"onchange",value:function(t,e){(t.hasOwnProperty("src")||t.hasOwnProperty("isGray"))&&(this._offcanvas=null,this._image=null,this.prepareIf(t.src))}},{key:"nature",get:function(){return c}},{key:"hasTextProperty",get:function(){return!1}},{key:"src",get:function(){return this.get("src")},set:function(t){this.set("src",t)}}],[{key:"noimage",get:function(){return e.NOIMAGE||((e.NOIMAGE=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABIBAMAAAD7Se1QAAAAIVBMVEUAAABHcEwBAQEREREBAQEEBAQGBgYLCwsDAwMDAwMICAi6HF9tAAAAC3RSTlNNAEAERiMYCS41Eac10lYAAAEgSURBVHhe7dY9asQwEAXgh7DNertNiJy48pIitY3SB7bYdk0ukL1BDDmA9gZecoH4pmFQ3MQayUMguPBrNPD4wD9TCMvJmt3M/AtYwXOlXiWgqADVCUBD46MAnGhMBaCiUQmAm8VA/Eh/eWl9Fn5WcxD+OLuRrUYJDKLluwH2InACUgkoACSdADxQc50Bytadb9RkM0CT13TcvlCT1HFg8UTHvasuUVACCa3El6u2UdD8LFTlKhUFFgA+d3dj10aABkUN72N3jAADCrJq7PIIsPidcxBoTHIIAjMFmyCwmGYIAA1P9gFgfCANAOsDSccCDW+uLDB+kLGg94OkZoAGkwsDDAe2DOg5oPxAg03rBR88OHpBz4N8UVeHFSwma74BTW6Ge4rIRa4AAAAASUVORK5CYII="),e.NOIMAGE}}]),e}();e.default=l,i.default.register("image-view",l)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(0)),i=r(n(4)),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,i.default)(o.default)),e}();e.default=a,o.default.register("text",a)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},a=r(n(0)),u=r(n(5)),s=r(n(4)),c={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"ref",name:"ref",property:"ref"},{type:"select",label:"fit",name:"fit",property:{options:["both","ratio"]}}],"value-property":"ref"},l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,s.default)(u.default)),o(e,[{key:"draw",value:function(t){this._drawing||(this._drawing=!0,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t),this._drawing=!1)}},{key:"_pre_draw",value:function(t){if(i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_pre_draw",this).call(this,t),this.ref){var n=this.ref.center,r=this.center,o=this.refScale;t.translate(r.x,r.y),t.scale(o.x,o.y),t.translate(-n.x,-n.y)}}},{key:"_post_draw",value:function(t){if(this.ref)return this.ref._post_draw(t);i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t)}},{key:"_draw",value:function(t){if(this.ref)return this.ref._draw(t);this.model.round;var e=this.bounds,n=e.left,r=e.top,o=e.width,i=e.height;t.beginPath(),t.rect(n,r,o,i)}},{key:"ref",get:function(){var t=this.getState("ref");return t&&"string"==typeof t?this.root.findById(t):null},set:function(t){this.setState("ref",t)}},{key:"refScale",get:function(){var t=this.ref.bounds,e=(this.ref.center,this.bounds),n=(this.center,e.width/t.width),r=e.height/t.height;switch(this.model.fit){case"both":return{x:n,y:r};case"ratio":default:return{x:Math.min(n,r),y:Math.min(n,r)}}}},{key:"nature",get:function(){return c}},{key:"hasTextProperty",get:function(){return!1}}]),e}();e.default=l,a.default.memoize(l.prototype,"ref",!1),a.default.memoize(l.prototype,"refScale",!1),a.default.register("local-ref",l)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},a=r(n(0)),u=r(n(5)),s=r(n(4)),c={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"scene-number",name:"ref",placeholder:"SCENE-1"},{type:"select",label:"fit",name:"fit",property:{options:["both","ratio"]}}],"value-property":"ref"},l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,s.default)(u.default)),o(e,[{key:"dispose",value:function(){this._releaseRef(),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"draw",value:function(t){this._drawing||(this._drawing=!0,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t),this._drawing=!1)}},{key:"_pre_draw",value:function(t){if(i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_pre_draw",this).call(this,t),this.ref){var n=this.ref.root.center,r=this.center,o=this.refScale;t.translate(r.x,r.y),o&&t.scale(o.x,o.y),t.translate(-n.x,-n.y)}}},{key:"_post_draw",value:function(t){if(this.ref)return this.ref.root._post_draw(t);i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t)}},{key:"_draw",value:function(t){if(this.ref)return this.ref.root._draw(t);this.model.round;var e=this.bounds,n=e.left,r=e.top,o=e.width,i=e.height;t.beginPath(),t.rect(n,r,o,i)}},{key:"_releaseRef",value:function(){this.__ref&&this.__ref.release&&(this.__ref._container.off("redraw",this.onredraw_ref,this),this.__ref.release()),delete this.__ref}},{key:"onredraw_ref",value:function(){this.invalidate()}},{key:"onchange",value:function(t,e,n){(e.ref||t.ref)&&this._releaseRef()}},{key:"nature",get:function(){return c}},{key:"hasTextProperty",get:function(){return!1}},{key:"refScale",get:function(){if(this.ref){var t=this.ref.root,e=t.bounds,n=(t.center,this.bounds);this.center;if(e.width&&e.height){var r=n.width/e.width,o=n.height/e.height;switch(this.model.fit){case"both":return{x:r,y:o};case"ratio":default:return{x:Math.min(r,o),y:Math.min(r,o)}}}}}},{key:"ref",get:function(){if(this.__ref||this.__waiting)return this.__ref;var t=this.app.refProvider,e=this.getState("ref");if(t&&e){var n=this;n.__waiting=!0,t.get(e,!0).then(function(t){n.__ref=t,n.__ref.on("redraw",n.onredraw_ref,n),delete n.__waiting},function(t){delete n.__waiting})}return this.__ref},set:function(t){this.setState("ref",t)}}]),e}();e.default=l,a.default.memoize(l.prototype,"ref",!1),a.default.memoize(l.prototype,"refScale",!1),a.default.register("global-ref",l)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(0)),i=r(n(4)),a=r(n(85)),u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,a.default)((0,i.default)(o.default))),e}();e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(8)),a=r(n(85)),u=n(36),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,a.default)(i.default)),o(e,[{key:"_draw",value:function(t){}},{key:"layout",get:function(){return u.Layout.get(this.get("layout"))||u.HTMLAbsoluteLayout}}]),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"_draw",value:function(t){var e=this.model.path,n=void 0===e?[]:e;if(!(n.length<=1)){t.beginPath(),t.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)t.lineTo(n[r].x,n[r].y);t.closePath(),this.drawStroke(t)}}},{key:"contains",value:function(t,e){var n=this.model.path,r=!1;return n.forEach(function(o,i){var a=(i+n.length+1)%n.length,u=o.x,s=o.y,c=n[a].x,l=n[a].y;s>e!=l>e&&t<(c-u)*(e-s)/(l-s)+u&&(r=!r)}),r}},{key:"path",get:function(){return this.model.path},set:function(t){this.set("path",t)}}]),e}();e.default=i,o.default.register("path",i)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_draw",value:function(t){var e=this.model,n=e.x1,r=e.y1,o=e.x2,i=e.y2,a=e.x3,u=e.y3;t.beginPath(),t.moveTo(n,r),t.lineTo(o,i),t.lineTo(a,u),t.closePath()}},{key:"contains",value:function(t,e){for(var n=this.model,r=[n.x1,n.y1,n.x2,n.y2,n.x3,n.y3],o=!1,i=0;i<r.length;i+=2){var a=(i+2)%r.length,u=r[i],s=r[i+1],c=r[a+1];s>e!=c>e&&t<(r[a]-u)*(e-s)/(c-s)+u&&(o=!o)}return o}},{key:"mutable",get:function(){return!0}},{key:"path",get:function(){var t=this.model;return[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2},{x:t.x3,y:t.y3}]},set:function(t){this.set({x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y,x3:t[2].x,y3:t[2].y})}}]),e}();e.default=u,i.default.memoize(u.prototype,"path",!1),i.default.register("triangle",u)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(37)),u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"ratio",name:"ratio",property:"ratio"}]},s={ondragmove:function(t,e,n){n.controls;var r=n.model,o=r.cx,i=r.rx,a=(n.transcoordP2S(t.x,t.y).x-o)/i*100;a=a>=100||a<=-100?100:Math.abs(a),n.set({ratio:a})}},c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_draw",value:function(t){var e=this.model,n=e.ratio,r=void 0===n?50:n,o=e.cx,i=e.cy,a=e.rx,u=e.ry,s=e.startAngle,c=e.endAngle,l=e.anticlockwise;t.beginPath(),t.ellipse(o,i,Math.abs(a),Math.abs(u),0,s||0,c||2*Math.PI,l),t.moveTo(o+a/100*r,i),t.ellipse(o,i,Math.abs(a/100*r),Math.abs(u/100*r),0,s||0,c||2*Math.PI,!0)}},{key:"contains",value:function(t,e){var n=this.model,r=n.cx,o=n.cy,i=n.rx,a=n.ry,u=n.ratio,s=(t-r)/(2*i-.5),c=(e-o)/(2*a-.5),l=(t-r)/(i/100*u*2-.5),f=(e-o)/(a/100*u*2-.5),h=!1;return s*s+c*c<.25&&l*l+f*f>.25&&(h=!h),h}},{key:"controls",get:function(){var t=this.model,e=t.cx,n=t.cy;return[{x:e+t.rx/100*t.ratio,y:n,handler:s}]}},{key:"nature",get:function(){return u}}]),e}();e.default=c,i.default.memoize(c.prototype,"controls",!1),i.default.register("donut",c)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(37)),u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"ratio",name:"ratio",property:"ratio"},{type:"number",label:"wing",name:"wing",property:"wing"}]},s={ondragmove:function(t,e,n){n.controls;var r=n.model,o=r.cy,i=r.ry,a=(n.transcoordP2S(t.x,t.y).y-o)/i*100+100;a>=100?a=100:a<=0&&(a=0),n.set({ratio:a})}},c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_draw",value:function(t){var e=this.model,n=e.ratio,r=void 0===n?30:n,o=e.wing,i=void 0===o?5:o,a=e.cx,u=e.cy,s=e.rx,c=e.ry;e.startAngle,e.endAngle,e.anticlockwise;if(!(i<3)){var l=1.5707963267948966,f=2*Math.PI/i,h=s-r/100*s,p=c-r/100*c;t.save(),t.beginPath(),t.translate(a,u),t.moveTo(s*Math.cos(-l),c*Math.sin(-l)),t.lineTo((s-h)*(Math.cos(f-l)+Math.cos(0-l))/2,(c-p)*(Math.sin(f-l)+Math.sin(0-l))/2);for(var d=1;d<i;d++)t.lineTo(s*Math.cos(f*d-l),c*Math.sin(f*d-l)),t.lineTo((s-h)*(Math.cos(f*(d+1)-l)+Math.cos(f*d-l))/2,(c-p)*(Math.sin(f*(d+1)-l)+Math.sin(f*d-l))/2);t.closePath(),t.restore()}}},{key:"controls",get:function(){var t=this.model,e=t.cx,n=t.cy,r=t.ry;return[{x:e,y:n-r+r*(t.ratio/100),handler:s}]}},{key:"nature",get:function(){return u}}]),e}();e.default=c,i.default.memoize(c.prototype,"controls",!1),i.default.register("star",c)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(5)),u=r(n(4)),s={mutable:!1,resizable:!0,rotatable:!1,properties:[]},c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,u.default)(a.default)),o(e,[{key:"_draw",value:function(t){var e=this.bounds,n=e.left,r=e.top,o=e.width,i=e.height;t.beginPath(),t.rect(n,r,o,i)}},{key:"text",get:function(){return this.get("id")},set:function(t){}},{key:"rotatable",get:function(){return!1}},{key:"nature",get:function(){return s}}]),e}();e.default=c,i.default.register("variable",c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(3),i=n(77);e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"animOnValueChange",value:function(t){var e=this;if(t!=this._lastValue){var n=t-(this._lastValue||0);this._lastValue=t,this._anim_alpha=-n,this.animate({step:function(t){e._anim_alpha=n*(t-1),e.invalidate()},duration:1e3,delta:"circ",options:{x:1},ease:"out"}).start()}}},{key:"dispose",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)})(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"dispose",this).call(this),delete this._value_substitutor}},{key:"onchange",value:function(t,e){t.hasOwnProperty("value")&&delete this._value_substitutor}},{key:"defaultValueSubstitutor",value:function(){return this.getState("value")}},{key:"animAlpha",get:function(){return this._anim_alpha||0}},{key:"animValue",get:function(){return(this._lastValue||0)+(this._anim_alpha||0)}},{key:"valueSubstitutor",get:function(){return this._value_substitutor||(this._value_substitutor=(0,i.buildSubstitutor)(this.getState("value"),this)||this.defaultValueSubstitutor),this._value_substitutor}},{key:"value",get:function(){return Number(this.valueSubstitutor())||0},set:function(t){delete this._value_substitutor,this.setState("value",Number((0,o.objToVal)(t)))}}]),n}()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"_convertDataFormat",value:function(t,e){var n;switch(e){case"json":n=JSON.parse(t);break;default:n=t}return n}}]),n}()}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(241);Object.defineProperty(e,"ModelLayer",{enumerable:!0,get:function(){return r(o).default}});var i=n(247);Object.defineProperty(e,"GuideLayer",{enumerable:!0,get:function(){return r(i).default}});var a=n(248);Object.defineProperty(e,"ShiftLayer",{enumerable:!0,get:function(){return r(a).default}});var u=n(249);Object.defineProperty(e,"SelectionLayer",{enumerable:!0,get:function(){return r(u).default}});var s=n(250);Object.defineProperty(e,"ModelingLayer",{enumerable:!0,get:function(){return r(s).default}});var c=n(258);Object.defineProperty(e,"TagLayer",{enumerable:!0,get:function(){return r(c).default}})},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=o(n(0)),s=(o(n(8)),o(n(14))),c=(n(1),r(n(27)),o(n(84))),l=r(n(86)),f=r(n(242)),h=n(38),p=n(2),d={x:1,y:1},y={x:0,y:0},v=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"dispose",value:function(){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this),delete this._canvas,delete this._overlay}},{key:"contains",value:function(t,e){return!0}},{key:"isRootModel",value:function(){return!0}},{key:"createElement",value:function(){var t=document.createElement("div");return t.style.position="absolute",t.style["user-select"]="none",t.style.overflow="hidden",this._canvas=u.default.createCanvas(1,1),this._canvas.style.position="absolute",t.appendChild(this._canvas),this._overlay&&t.appendChild(this._overlay),t}},{key:"resize",value:function(){this.fitSize(this.element),this.fitSize(this.canvas)}},{key:"capturePath",value:function(t,e){for(var n=this.layout.capturables(this),r=n.length-1;r>=0;r--){var o=n[r];if(o.isContainer()){var i=o.capturePath(t,e);if(i)return i}}return!1}},{key:"_post_draw",value:function(t){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_post_draw",this).call(this,t),!h.License.valid){this._watermark||(this._watermark=new Image,this._watermark.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAAAjCAMAAAC0JoimAAACQ1BMVEVHcEwODw+xHySxHySxHySxHyRYWFldR0mxHyRLS0wPEBAPEBBYWFmxHiNYWFlYWFlYWFm0HyRYWFlYWFlYWFmxHySxHySxHyRYWFkPEBAODw9YWFlYWFm9QkYPEBAPEBBYWFlYWFmxHyRYWFmxHyQPEBBYWFlYWFlYWFkPEBAPEBBYWFlYWFlYWFlYWFkOEA+xHyQPEBD///9YWFmxHyRYWFlYWFlYWFlYWFkPEBBYWFn89vaxHyRYWFlYWFmxHyRYWFkPEBAPEBAPEBCxHySxHyQOEA8OEA+xHyRYWFmxHyRYWFkOEA9YWFmxHySxHyS8PUEPEBCxHyQOEA+xHyRYWFkPEBBYWFlYWFkPEBAPEBDz3d757u4PEBAPEBAPEBCxHySxHSIPEBDTgIMPEBCxHyQPEBAPEBBYWFkOEA+xHySyHySxHyQPEBAPEBCwHCHCT1OxHySxHyQPEBDksbPeoKLKZmmxHyS6ODwPEBAOEA/XjZD/8fHnmpz/2Njll5n+7e3/09S+PkL8y8zae37ikJL2vb7wra/fiIryzs+xHyQPEBCvGR6xHSL///+wGyCsEheuFRqyHySuFxy0HyWsHSK6NzvakZTARkq3MDTuztBwEhGzJCmWGRzipKe1Ky/XhIfBSk7CT1PkrrDNZ2r14ODw09T35uf9+fnIXmLRc3Xy2NnrwcOiHB/+/Px5ExP67++ZGh3ObnHcm525MzeMFxnovb7nt7ntycqTGRtsERDRen1oEA6XGh1qERBpEQ/HVFjdAcS7AAAAfHRSTlMAEw4E93sNAaQEB9er2D4YhRIRIpyfwMQICg5Fev2i+VejKn8J3l9lM8z1iybgLr/Shfa9VimRbks+tv5Jc81ul8fSY3XoJKmV87QdHlJm769ayXYjQbY5aUZx/fvmTl3gXtH88B17KsJujRU4VZCI9qw+M+r29vPGKK/+ZLYwnwAACHRJREFUeF68lklvGkkUx4tNGBCHHIxlJINkwcG+GCQuyEiIsFkIGQUjS3bGGHucWDGxo2QOaJxv8Kp6Be/77uz7PttHm6qmCTTt4Mxh+KtV23tS/fTqva5CVPfHSuZkJuRD16vwIGDOucaNqDsyJcxQq9Vk6Clf6xtK1l1dg91hi4Isv9h7sybDw+siF6nUXWuQv9MNtMGKDB92dnZevajBeGfXcgC+uy51g+0ByB++0g2/vlqTXTc6us5B7YvqWit141QD8trOX1+p/tirmTtv2COvvfpbcf0iQwj9tGyGn3KzRqIhbXDM8tqfivZeALh6OikHa2/2Gq6JxsbBdLCfDex3V9lAr9TqUFy7YrQ8XNLntikPyUEtG0CtLhmuV9PVguqyz2CHmw36h7BfG6D+8PQi7YoYx3SJWzLq2VxQ0rE1RCRJgB+KEzhoqsnmwEN1thF8U8s2gfEU7bLp2C0txY0+cP4nNkFaPz46ELkfkEkSEFH4KTa3erTT2BvWJp77Sjajr5XNqGPjpM2T2xcX5++2qleRkYPD59uf94+IcBWbwmJT2GzF9JBjfnIZIcOqA+PYZBAtpienmcMUtcRWFrVs1khP3hnIhOpszvuWfKAvYdKwcdLpa17R+cAVcNXjZ4pxdAM4Pdt8ykCVjTE2gwMPL2DsnUZZL2YaQWGM0xQiOIwx/WaKGjZjHsw5AEhYGVvSCUw9plY2svkLr2r7QHes0sBZw/qY6Nm8fkXDjM0ej6fc4ZvYn7Uvp7E3ODuFwsPYg9AsxkPF1L1h7E9pznQ8WjDeD0CywNggmXgUTQKMt7IJn+i+r08+XdLuVwJaCfIJ39DosaRja6iRb4asB3uLrBZYvtXZbPN44Tc6CWI80Z5v5cISQISxmRnUnBkyviYbtz7K8xfHsHtK4bZJW+CqA5f8+fGT2xsDGy/5dyLXzuaP35qdvRV3KGzuidjMDD07Wpp3sXeqwZZawJN2OlnEeFXDZoz2lZIVgND3OvWVIHCnyUaevOT5DUkgQON39l4Ajcgpz78VxX92xd0z/uOuoKsFe7MWaNZh/+S8jo01VlbDNAOtLWxlF0DJlW9lQ05wFrRs7Cw5bp/Gb520sX2jxipwQNYv+M9bpNM/ZAV771lRXMf2O41bfz1u6Za4WS0AFhOKtLIZS5AvN9mETXqWn3erEt2cfya3nymN2+0twgnixksWt05s89hPZ0GFbQLjZZWNubF8o+z4nsJWL0VfBnI+hKIqm3mOVYcZek3lRNSn1oLM/hEfT5+e025fgvZ8G6XG95Lw7ZKn+Qad2EawN+6OL2A8i1j0YrNhhU2ZzE8Zpr34Zpax5XrHmIw9AFFjKAcwx9igknhkyUElgnrpuspG3jYrcUAArThgdXr2lLWvj9rqtF97nxaHMZWDRQelaEczP8waZAtSCzNNKfepKlOkwjonQAL5AuCkBgaIUB/AksomwL6KdvmUQIf/22EVtGy2oEd9h0wog+V0bHIiteJRMs0zMjKNUh5PnDkUPSOx1btZ5R3Sq8qHIg/7MpbCWG8E+Sy9ocKYy0WHCEUymUGVDcjuoXIxPDslHOjhjrbrMT3kOC2bXlaDvTkxuFtNboMN6VX2ad4B6hPOZ2re9URYP318+GSrKsAVqh68Pdl+vrHZtFrQ/y9z8z4ngkDUqOkkEI7jaAPdZ6uKAhFFiZNEsSqIYsuMozOiLFXrS9Xusgncv82Y32vbVhTHDwyuuKBZQtKGQDJICCSBZDGkSRYq0vy4YTz2YmxYX0oYmDFYgLYMKsm286sLc7oxcJ0SOo84zeyWAatxCnvxn7Z7Q9YtQMbap34lLlydry4fQPeco7vsjxZFsXu82y/mk71+f7opioerZVEsVw/7/c20X+yN5sSwmhV/HD66the0ELAi3vDt1WMyigoGKku7etz24CZ5letsj072hjvT3bI8OD4YlrPRznBnMy/L/VVRlv3J/nA43wzL/dGsLJ+uDoY7/fG/2eSMxVgiCAIApjiAZDIwGDCvYakrM2B3MTAIIFIBX1pMhTjojTAXhQxdhYQvPbEGdAFqw5Ttp0Wen/06y/MXx+tB/nh0PjjfLPP8+8npID+dPBsMlotBfjZ9nOcXq1eDwWBOU9wnV2xID+qMFKM6b3IpAiusGIYnpLwNbsZ6ka4aKDQ5K41McLoucRBpHVsDT0Mmr7RqfBPAM/iOYNWJpx1Di+dt2wIuhY9Ian1Ke58HpK9ckVTxskpq64KU0LPJ+ujoglaxPxc06b4kZW1C68cpLQ0f/80mxUElaquOG2ishnoKq9R1u1YXQEgMTmIridlmxUyNe6IRSRoQMVJX06El2ZnStHstBCiI455HPJlY5ytBx0zaGapL8PXh+GR9ne23o9//k+3Fz+N//tYQy5mJUwkklVXMyEpbmRE57eASoQUNE1K+o7u6CHpb/SwBKqZhaQ2IJaQmbYHlAMKaYbAdlngUSzUcgETh65JCzhzGJxdvxrYmLdynzBWbkLjA1jqS6rpY1GucknRczutRBD2VpS6ofIUNWQ+ziuE0eDnkKJsScCqLOTMTggqGZlYRm25CPZahJVwnCMNaJAB8fvjD1puxzX48/PD1WQ1ymuAGtqsbKgJVAkaVeIVr0JDJ2mkLzK7HN3kR87bV4nQlEAEaXZmNGrxoOCk4DQ7A0lWt6YgM8TiyE0kW4KwORHfeP37yP9imlG31nAy/jD94jQaMgC93luw1GZBlABBDhAWgEgWEAJEZuRhBphPFARCTGOQQIyy6ANil73Ae9YCAWIIUElqN5YDqqztf3L29/cD3n1Wf+P697Vu+f3/L97+srn3/onru+1v3ff/29j3ff1V9fuvud99+8x68rWiy4FP5prAZIaASdRveaf0FsOq+MCErseEAAAAASUVORK5CYII=");var n=this._watermark;t.globalAlpha=.5,t.drawImage(n,this.model.width-n.width-30,this.model.height-n.height-30)}}},{key:"_repositionOverlay",value:function(){var t=this._overlay;if(t){var e=this.model,n=e.translate,r=void 0===n?y:n,o=e.scale,i=void 0===o?d:o,a=e.rotation,u=void 0===a?0:a,s=this.bounds,c=s.left,l=s.top;s.width,s.height;t.style.left=c+"px",t.style.top=l+"px";var f="rotate("+u+"rad) scale("+i.x+", "+i.y+")";t.style["margin-left"]=r.x+"px",t.style["margin-top"]=r.y+"px",["-webkit-","-moz-","-ms-","-o-",""].forEach(function(e){t.style[e+"transform"]=f})}}},{key:"onchange",value:function(t){t.hasOwnProperty("text")&&this.set("text",null),t.hasOwnProperty("id")&&this.set("id",null),t.hasOwnProperty("class")&&this.set("class",null),this._repositionOverlay()}},{key:"onchanged",value:function(t,e,n){this.invalidate()}},{key:"onmouseenter",value:function(t,n){if(this.app&&!this.app.isEditMode&&n){var r=n.origin;if(!(r instanceof e)&&r.model.event&&r.model.event.hover){var o=r.model.event.hover;o.emphasize&&f.emphasize(r),o.infoWindow&&!r.hidden&&c.default.show(r,o.infoWindow,!0),o.target&&o.hasOwnProperty("value")&&(r._lastValue=this.root.variable(o.target),this.root.variable(o.target,o.value))}}}},{key:"onmouseleave",value:function(t,e){if(this.app&&!this.app.isEditMode&&e){var n=e.origin;if(n.model.event&&n.model.event.hover){var r=n.model.event.hover;r&&(r.emphasize&&f.normalize(n),r.infoWindow&&!n.hidden&&c.default.hide(n,r.infoWindow),r.target&&r.hasOwnProperty("value")&&(this.root.variable(r.target,n._lastValue),delete n._lastValue))}}}},{key:"onclick",value:function(t,e){if(!this.app.isEditMode&&e){var n=e.origin;if(n.model.event&&n.model.event.tap){var r=n.model.event.tap;r.infoWindow&&!n.hidden&&c.default.show(n,r.infoWindow),r&&r.target&&(/^\$/.test(r.target)?this.root.variable(r.target.substring(1),n.substitute(r.value)):"popup"==r.target?l.show(n,r.value):this.trigger(r.target,n.substitute(r.value)))}}}},{key:"stuck",get:function(){return!0}},{key:"overlay",get:function(){if(!this._overlay){var t=document.createElement("div");t.style.position="absolute",t.style["user-select"]="none",t.style["transform-origin"]="top left",this.element&&this.element.appendChild(t),p.GESTURES.forEach(function(e){t.addEventListener(e,function(t){t.stopPropagation()})}),p.KEYEVENTS.forEach(function(e){t.addEventListener(e,function(t){t.stopPropagation()})}),this._overlay=t,this._repositionOverlay()}return this._overlay}},{key:"canvas",get:function(){return this._canvas}},{key:"MPP",get:function(){var t=this.model,e=t.scale,n=void 0===e?{x:1,y:1}:e;switch(t.unit){case"mm":case"cm":return 1/this.app.PPM/n.x;case"in":return 1/this.app.PPI/n.x;case"px":default:return 1/n.x}}},{key:"eventMap",get:function(){return{"(self)":{"(all)":{change:this.onchanged,mouseenter:this.onmouseenter,mouseleave:this.onmouseleave,click:this.onclick}}}}}]),e}();e.default=v,v.Popup=l,u.default.register("model-layer",v)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.emphasize=function(t){t.hasOwnProperty("_backupStrokeStyle")||(t._backupStrokeStyle=t.model.strokeStyle,t.set("strokeStyle","#f26522"),t.hasOwnProperty("_backupLineWidth")||(t._backupLineWidth=t.model.lineWidth,t.set("lineWidth",t.model.lineWidth+5)))},e.normalize=function(t){t.hasOwnProperty("_backupStrokeStyle")&&(t.set("strokeStyle",t._backupStrokeStyle),delete t._backupStrokeStyle,t.hasOwnProperty("_backupLineWidth")&&(t.set("lineWidth",t._backupLineWidth),delete t._backupLineWidth))}},function(t,e,n){"use strict";(function(t){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=i.prototype:(null===t&&(t=new i(e)),t.length=e),t}function i(t,e,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return s(this,t)}return a(this,t,e,n)}function a(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);i.TYPED_ARRAY_SUPPORT?(t=e).__proto__=i.prototype:t=c(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(e,n),a=(t=o(t,r)).write(e,n);a!==r&&(t=t.slice(0,a));return t}(t,e,n):function(t,e){if(i.isBuffer(e)){var n=0|l(e.length);return 0===(t=o(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?o(t,0):c(t,e);if("Buffer"===e.type&&M(e.data))return c(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function s(t,e){if(u(e),t=o(t,e<0?0:0|l(e)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e){var n=e.length<0?0:0|l(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function l(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function f(t,e){if(i.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(t).length;default:if(r)return O(t).length;e=(""+e).toLowerCase(),r=!0}}function h(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function p(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:d(t,e,n,r,o);if("number"==typeof e)return e&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):d(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function d(t,e,n,r,o){function i(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}var a=1,u=t.length,s=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,u/=2,s/=2,n/=2}var c;if(o){var l=-1;for(c=n;c<u;c++)if(i(t,c)===i(e,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*a}else-1!==l&&(c-=c-l),l=-1}else for(n+s>u&&(n=u-s),c=n;c>=0;c--){for(var f=!0,h=0;h<s;h++)if(i(t,c+h)!==i(e,h)){f=!1;break}if(f)return c}return-1}function y(t,e,n,r){return A(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function v(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i=t[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(o+u<=n){var s,c,l,f;switch(u){case 1:i<128&&(a=i);break;case 2:128==(192&(s=t[o+1]))&&(f=(31&i)<<6|63&s)>127&&(a=f);break;case 3:s=t[o+1],c=t[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(a=f);break;case 4:s=t[o+1],c=t[o+2],l=t[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(a=f)}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=S));return n}(r)}function g(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function b(t,e,n,r,o,a){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function _(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function m(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function w(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function x(t,e,n,r,o){return o||w(t,0,n,4),E.write(t,e,n,r,23,4),n+4}function k(t,e,n,r,o){return o||w(t,0,n,8),E.write(t,e,n,r,52,8),n+8}function O(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function P(t){return j.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(T,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var j=n(244),E=n(245),M=n(246);e.Buffer=i,e.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},e.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),i.poolSize=8192,i._augment=function(t){return t.__proto__=i.prototype,t},i.from=function(t,e,n){return a(null,t,e,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(t,e,n){return function(t,e,n,r){return u(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}(null,t,e,n)},i.allocUnsafe=function(t){return s(null,t)},i.allocUnsafeSlow=function(t){return s(null,t)},i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,e){if(!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,a=Math.min(n,r);o<a;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!M(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=i.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!i.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},i.byteLength=f,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)h(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)h(this,e,e+3),h(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)h(this,e,e+7),h(this,e+1,e+6),h(this,e+2,e+5),h(this,e+3,e+4);return this},i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?v(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[i]);return o}(this,e,n);case"utf8":case"utf-8":return v(this,e,n);case"ascii":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}(this,e,n);case"latin1":case"binary":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}(this,e,n);case"base64":return function(t,e,n){return 0===e&&n===t.length?j.fromByteArray(t):j.fromByteArray(t.slice(e,n))}(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,r,o){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var a=o-r,u=n-e,s=Math.min(a,u),c=this.slice(r,o),l=t.slice(e,n),f=0;f<s;++f)if(c[f]!==l[f]){a=c[f],u=l[f];break}return a<u?-1:u<a?1:0},i.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},i.prototype.indexOf=function(t,e,n){return p(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return p(this,t,e,n,!1)},i.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return function(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(e.substr(2*a,2),16);if(isNaN(u))return a;t[n+a]=u}return a}(this,t,e,n);case"utf8":case"utf-8":return function(t,e,n,r){return A(O(e,t.length-n),t,n,r)}(this,t,e,n);case"ascii":return y(this,t,e,n);case"latin1":case"binary":return function(t,e,n,r){return y(t,e,n,r)}(this,t,e,n);case"base64":return function(t,e,n,r){return A(P(e),t,n,r)}(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n,r){return A(function(t,e){for(var n,r,o,i=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;i.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=i.prototype;else{var o=e-t;r=new i(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+t]}return r},i.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||g(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},i.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||g(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},i.prototype.readUInt8=function(t,e){return e||g(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return e||g(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return e||g(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return e||g(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return e||g(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||g(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},i.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||g(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return e||g(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){e||g(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){e||g(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return e||g(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return e||g(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return e||g(t,4,this.length),E.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return e||g(t,4,this.length),E.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return e||g(t,8,this.length),E.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return e||g(t,8,this.length),E.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||b(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},i.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||b(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):m(this,t,e,!0),e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):m(this,t,e,!1),e+4},i.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);b(this,t,e,n,o-1,-o)}var i=0,a=1,u=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===u&&0!==this[e+i-1]&&(u=1),this[e+i]=(t/a>>0)-u&255;return e+n},i.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);b(this,t,e,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===u&&0!==this[e+i+1]&&(u=1),this[e+i]=(t/a>>0)-u&255;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):m(this,t,e,!0),e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||b(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):m(this,t,e,!1),e+4},i.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return k(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return k(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,a=r-n;if(this===t&&n<e&&e<r)for(o=a-1;o>=0;--o)t[o+e]=this[o+n];else if(a<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},i.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var a;if("number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var u=i.isBuffer(t)?t:O(new i(t,r).toString()),s=u.length;for(a=0;a<n-e;++a)this[a+e]=u[a%s]}return this};var T=/[^+\/0-9A-Za-z-_]/g}).call(e,n(30))},function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}e.byteLength=function(t){return 3*t.length/4-r(t)},e.toByteArray=function(t){var e,n,o,u,s,c=t.length;u=r(t),s=new a(3*c/4-u),n=u>0?c-4:c;var l=0;for(e=0;e<n;e+=4)o=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],s[l++]=o>>16&255,s[l++]=o>>8&255,s[l++]=255&o;return 2===u?(o=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,s[l++]=255&o):1===u&&(o=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,s[l++]=o>>8&255,s[l++]=255&o),s},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i="",a=[],u=0,s=n-r;u<s;u+=16383)a.push(function(t,e,n){for(var r,i=[],a=e;a<n;a+=3)r=(t[a]<<16)+(t[a+1]<<8)+t[a+2],i.push(function(t){return o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]}(r));return i.join("")}(t,u,u+16383>s?s:u+16383));return 1===r?(e=t[n-1],i+=o[e>>2],i+=o[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=o[e>>10],i+=o[e>>4&63],i+=o[e<<2&63],i+="="),a.push(i),a.join("")};for(var o=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=u.length;s<c;++s)o[s]=u[s],i[u.charCodeAt(s)]=s;i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e,n){"use strict";e.read=function(t,e,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,c=s>>1,l=-7,f=n?o-1:0,h=n?-1:1,p=t[e+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=u;l>0;i=256*i+t[e+f],f+=h,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=c}return(p?-1:1)*a*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var a,u,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(e*s-1)*Math.pow(2,o),a+=f):(u=e*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;t[n+p]=255&u,p+=d,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*y}},function(t,e,n){"use strict";var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){return{left:-t.x,top:-t.y,width:d,height:O}}function i(t,e,n,r){return{left:d-t.x,top:y-t.y,origin:v-t.x,width:e-d,height:O}}function a(t,e,n,r){var o={x:-t.x+g+O/2,y:-t.y+b+(n-b)/2},i=c.default.transcoordRR(-t.x+g,-t.y+b,o,m);return{left:i.x-(n-b),top:i.y,origin:_-t.y,width:n-b,height:O}}function u(t){var e=t.get("translate");return{left:-e.x,top:-e.y,width:t.canvas.width/p.DPPX,height:t.canvas.height/p.DPPX}}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=r(n(0)),l=r(n(14)),f=r(n(83)),h=r(n(82)),p=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2)),d=20,y=0,v=20,g=0,b=20,_=20,m=90*Math.PI/180,w="m",x=0,k="9px Verdana",O=20,P="#f4f4f4",A="#999",j=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.appScale={x:1,y:1},"disabled"!==t.ruler&&(r.hruler=new f.default({left:d,top:y,origin:v,margin:x,height:O,unit:w,rotation:0,font:k,fillStyle:P,strokeStyle:A,capturable:!1}),r.vruler=new f.default({left:0,top:0,origin:_,margin:x,height:O,unit:w,rotation:m,font:k,side:"top",fillStyle:P,strokeStyle:A,capturable:!1}),r.origin_rect=new h.default({left:-v,top:-_,width:v,height:_,fillStyle:P,strokeStyle:A,lineWidth:1}),r.addComponent(r.hruler),r.addComponent(r.vruler),r.addComponent(r.origin_rect)),r.invalidate(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,l.default),s(e,[{key:"added",value:function(t){if(this.hruler){var e=this.rootModel,n=Object.assign({},e.get("translate"));n.x<d&&(n.x+=d),n.y<b&&(n.y+=b);var r=e.get("scale")||{x:1,y:1};this.appScale=r,this.hruler.set("scale",r.x),this.vruler.set("scale",r.y),e.set("translate",n),this.set("translate",n),this.screen_coord=u(this);var s=this.screen_coord,c=s.width,l=s.height;this.hruler.set(i(n,c,0,this.hruler)),this.vruler.set(a(n,0,l,this.vruler)),this.origin_rect.set(o(n))}else this.screen_coord=u(this)}},{key:"resize",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"resize",this).call(this),this.screen_coord=u(this);var t=this.screen_coord,n=t.width,r=t.height;this.hruler&&(this.hruler.set(i(this.model.translate,n,0,this.hruler)),this.vruler.set(a(this.model.translate,0,r,this.vruler)),this.origin_rect.set(o(this.model.translate)))}},{key:"_draw",value:function(t){if(this.guide){t.save();var e=this.guide,n=e.x,r=e.y,o=this.screen_coord,i=o.top,a=o.left,u=o.width,s=o.height;t.beginPath(),t.moveTo(n,i),t.lineTo(n,i+s),t.moveTo(a,r),t.lineTo(a+u,r),t.lineWidth=1,t.strokeStyle="tomato",t.setLineDash([2,3]),t.font="10px tahoma",t.fillStyle="#333";var c=this.transcoordS2C(n,r,this.rootModel);t.textBaseline=c.y>200?"bottom":"top",t.textAlign=c.x>200?"right":"left";var l=c.y>200?-5:5,f=c.x>200?-5:5,h=Math.round(n/this.appScale.x),p=Math.round(r/this.appScale.y);t.fillText(" "+h+", "+p+" ",n+f,r+l),t.stroke(),t.restore()}}},{key:"contains",value:function(t,e){return!0}},{key:"onmousedown_origin",value:function(t,e){this.rootModel.set("translate",{x:v,y:_})}},{key:"onchange_root_model",value:function(t,e,n){if(t.scale&&(this.appScale=t.scale,this.hruler&&(this.hruler.set("scale",t.scale.x),this.vruler.set("scale",t.scale.y))),t.translate&&this.set({translate:{x:t.translate.x,y:t.translate.y}}),t.scale||t.translate){if(this.screen_coord=u(this),this.hruler){var r=this.model.translate,s=this.screen_coord,c=s.width,l=s.height;this.hruler.set(i(r,c,0,this.hruler)),this.vruler.set(a(r,0,l,this.vruler)),this.origin_rect.set(o(r))}this._guide=null}this.invalidate()}},{key:"onmouseout_child",value:function(t){this._guide=null,this.invalidate()}},{key:"onmousemove_child",value:function(t,e){t.target&&"CANVAS"!==t.target.tagName?this.guide=null:this.guide=this.transcoordC2S(t.offsetX,t.offsetY)}},{key:"capturable",get:function(){return!1}},{key:"guide",get:function(){return this._guide},set:function(t){this._guide=t,this.invalidate()}},{key:"eventMap",get:function(){return{"(root)":{"(descendant)":{mousemove:this.onmousemove_child,mouseout:this.onmouseout_child,dragmove:this.onmousemove_child},"model-layer":{change:this.onchange_root_model}},"(self)":{"(descendant)":{mousedown:this.onmousedown_origin}}}}}]),e}();e.default=j,c.default.register("guide-layer",j)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(14)),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2)),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"added",value:function(t){var e=this.rootModel.get("translate");this.set("translate",e)}},{key:"_draw",value:function(t){}},{key:"contains",value:function(t,e){return!(this.app.mode!=u.MODE_SHIFT)}},{key:"onkeydown",value:function(t){32==t.keyCode&&void 0===this.before_mode&&(this.before_mode=this.app.mode,this.app.mode=u.MODE_SHIFT)}},{key:"onkeyup",value:function(t){32==t.keyCode&&(void 0!=this.before_mode&&(this.app.mode=this.before_mode),delete this.before_mode)}},{key:"ondragstart",value:function(t){this.last_position=this.transcoordC2S(t.offsetX,t.offsetY)}},{key:"ondragmove",value:function(t){var e=this.transcoordC2S(t.offsetX,t.offsetY),n=e.x,r=e.y;this.rootModel.move({x:n-this.last_position.x,y:r-this.last_position.y}),this.last_position=this.transcoordC2S(t.offsetX,t.offsetY)}},{key:"eventMap",get:function(){return{"(root)":{"(self)":{keydown:this.onkeydown,keyup:this.onkeyup}}}}}]),e}();e.default=s,i.default.register("shift-layer",s)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n,r,o){o||function(t,e,n,r){var o=t.selected,i=r?o.slice(0):[];r&&i.length>0?e=i[0].parent:e.isContainer()||(e=e.parent);var a=e.layout.capturables(e),u=!!e.layout.joinType;if(r&&n.selected.forEach(function(t){i.splice(i.indexOf(t),1)}),n.selected=[],a.forEach(function(t){t.capturable&&function(t,e,n){var r,o,i,a,u=e.sx,c=e.sy,l=e.ex,f=e.ey;if(u>l?(r=l,o=u):(r=u,o=l),c>f?(i=f,a=c):(i=c,a=f),n){var h=t.bounds,p=t.transcoordS2TR(h.left,h.top),d=t.transcoordS2TR(h.left+h.width,h.top+h.height),y=p.x,v=d.x,g=p.y,b=d.y,_=Math.min(r,y,o,v),m=Math.max(r,y,o,v),w=Math.min(i,g,a,b),x=Math.max(i,g,a,b);return!(m-_>Math.abs(o-r)+Math.abs(v-y)||x-w>Math.abs(a-i)+Math.abs(b-g))}var k=t.path;if(!k)return(0,s.error)("컴포넌트에 get path가 잘못 구현되어있음.",t),!1;for(var O=0;O<k.length;O++){var P=t.transcoordS2TR(k[O].x,k[O].y);if(r>P.x||o<P.x||i>P.y||a<P.y)return!1}return!0}(t,n,u)&&-1==i.indexOf(t)&&n.selected.push(t)}),i=i.concat(n.selected),o.length!==i.length)t.selected=i;else for(var c=0;c<i.length;c++)if(o[c]!=i[c]){t.selected=i;break}}(t,e,n,r)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=r(n(0)),u=(r(n(8)),r(n(28)),r(n(14))),s=n(1),c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),i(e,[{key:"added",value:function(t){var e=this.rootModel,n=e.get("translate"),r=e.get("scale");this.set("translate",n),this.set("scale",r)}},{key:"contains",value:function(t,e){return!1}},{key:"_draw",value:function(t){var e=this.selbox;if(e){var n=e.sx,r=e.sy,o=e.ex,i=e.ey,a=this.get("scale")||{x:1,y:1};t.beginPath(),t.rect(n,r,o-n,i-r),t.setLineDash([2/a.x,4/a.y]),t.lineWidth=1/a.x,t.strokeStyle="black",t.stroke()}}},{key:"onkeydown",value:function(t,e){e.origin;var n=e.deliverer,r=n.selected;if(1!=r.length)return!1;var o=r[0],i=o.parent;if(!i||i===n)return!1;if("Tab"==t.code){if("Tab"!=t.code)return!1;var a=i.layout.capturables(i),u=a.indexOf(o);if(-1==u){if(!i.indexOf(o))return(0,s.warn)("Container not contains [",o,"] as a component"),!1;u=0}var c=a.length;t.shiftKey?u--:u++,o=a[(u+c)%c]}else{if(!i.layout.keyNavigate)return!1;o=i.layout.keyNavigate(i,o,t)||o}n.selected=[o],t.preventDefault()}},{key:"onchange_root_model",value:function(t,e,n){t.translate&&this.set("translate",t.translate),t.scale&&this.set("scale",t.scale)}},{key:"_pendingDecision",value:function(t){this.downpoint={x:t.offsetX,y:t.offsetY}}},{key:"_selectGroupItem",value:function(t,e){for(var n=this.selected.indexOf(t),r=t.parent;r.parent.isGroup();)r=r.parent;var o=[],i=!1,a=!1;if(this.selected.forEach(function(t){var e=t.parent;if(t!==r){for(;e.parent.isGroup();)e=e.parent;e===r&&(o.push(t),i=!0)}else a=!0}),i)if(e.shiftKey){if(-1!=n)return void this._pendingDecision(e);o.push(t)}else{if(-1!=n)return void this._pendingDecision(e);o=[t]}else if(a)return void this._pendingDecision(e);this.selected=o}},{key:"onmousedown_comp",value:function(t,e){var n=e.origin;if(this.downpoint=null,t.shiftKey){if(-1!=this.selected.indexOf(n))return void this._pendingDecision(t);var r=this.selected.filter(function(t){return!t.isRootModel()&&!!t.parent}),o=r.length>0&&r[0].parent;if(o&&o!==n.parent)return void(n.parent.isGroup()&&this._pendingDecision(t));r.push(n),this.selected=r}else{if(n.parent.isGroup())return void this._selectGroupItem(n,t);if(-1!=this.selected.indexOf(n))return;this.selected=[n]}}},{key:"onmouseup_comp",value:function(t,e){if(this.downpoint&&this.downpoint.x===t.offsetX&&this.downpoint.y===t.offsetY){var n=e.origin,r=this.selected.indexOf(n);if(-1==r&&n.parent.isGroup()&&(r=this.selected.indexOf(n.parent)),-1!==r&&t.shiftKey){var o=this.selected.slice();return r>-1&&o.splice(r,1),void(this.selected=o)}n.parent.isGroup()&&(this.selected=[n])}}},{key:"ondragstart_selbox",value:function(t,e){if(e.origin.stuck){var n=this.transcoordC2S(t.offsetX,t.offsetY),r=n.x,o=n.y;this.selbox={sx:r,sy:o,selected:[]}}}},{key:"ondragmove_selbox",value:function(t,e){var n=e.origin;if(n.stuck){var r=this.transcoordC2S(t.offsetX,t.offsetY),i=r.x,a=r.y;e.deliverer;if(this.selbox){this.selbox.ex=i,this.selbox.ey=a;o(this,n,this.selbox,t.shiftKey),this.invalidate()}}}},{key:"ondragend_selbox",value:function(t,e){e.origin.stuck&&(this.last_pos=null,this.selbox=null,o(this,null,null,!1,!0),this.invalidate())}},{key:"eventMap",get:function(){return{"(root)":{"(self)":{keydown:this.onkeydown}},"model-layer":{"(self)":{change:this.onchange_root_model},"(all)":{dragstart:this.ondragstart_selbox,dragmove:this.ondragmove_selbox,dragend:this.ondragend_selbox,mousedown:this.onmousedown_comp,mouseup:this.onmouseup_comp}}}}}]),e}();e.default=c,a.default.register("selection-layer",c)},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=o(n(0)),u=(o(n(28)),o(n(14))),s=r(n(17)),c=r(n(251)),l=o(n(7)),f=o(n(15)),h=r(n(2)),p=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=new c.PathHandler(r),i=new c.ControlHandler(r),a=new c.Resizer(r),u=new c.Rotator(r);return r._modelers=[o,i,a,u],r._control_mode_modelers=[i,o,a,u],r.focusOutline=new c.FocusOutline(r),r.groupOutline=new c.GroupOutline(r),r._reversed_modelers=r._modelers.slice().reverse(),r._control_mode_reverse_modelers=r._control_mode_modelers.slice().reverse(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),i(e,[{key:"added",value:function(t){var e=this.rootModel,n=e.get("translate"),r=e.get("scale");this.set("translate",n),this.set("scale",r)}},{key:"contains",value:function(t,e){if(this._state_dragging)return!0;this.modelers.forEach(function(t){return t.reset()});for(var n=this.selected.filter(function(t){return!!t.parent}),r=this.get("scale")||{x:1,y:1},o=0;o<n.length;o++)for(var i=n[o],a=i.transcoordT2S(t,e),u=0;u<this.modelers.length;u++){var s=this.modelers[u];if(s.contains(a.x,a.y,i,r))return this.currentModeler=s,!0}return!1}},{key:"_componentDrawer",value:function(t,e,n,r){var o=[],i=e.parent;if(e.isRootModel())return t.save(),r(t,e,n),void t.restore();for(;i&&!i.isRootModel();)o.push(i),i=i.parent;t.save(),o.reverse().forEach(function(e){var n=e.rotatePoint;t.translate(n.x,n.y);var r=e.get("scale");r&&t.scale(r.x,r.y),t.rotate(e.get("rotation")),t.translate(-n.x,-n.y);var o=e.bounds;t.translate(o.left,o.top)});var a=e.rotatePoint;t.translate(a.x,a.y);var u=e.get("scale");u&&t.scale(u.x,u.y),t.rotate(e.get("rotation")),t.translate(-a.x,-a.y),r(t,e,n),t.restore()}},{key:"_pre_draw",value:function(t){var e=this.model,n=e.translate,r=e.scale,o=void 0===r?{x:1,y:1}:r,i=e.rotation;t.save(),t.beginPath(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.rect(0,0,t.canvas.width,t.canvas.height),t.fillStyle="black",t.globalAlpha=.5,t.fill(),t.restore(),n&&t.translate(n.x*h.DPPX,n.y*h.DPPX),t.scale(o.x*h.DPPX,o.y*h.DPPX),i&&t.rotate(i),t.clearRect(0,0,this.rootModel.get("width"),this.rootModel.get("height"))}},{key:"_draw",value:function(t){var e=this;t.beginPath();var n=this.get("scale")||{x:1,y:1},r=this.selected.filter(function(t){return!!t.parent});if(this.focused&&this._componentDrawer(t,this.focused,n,function(t,n,r){e.focusOutline.draw(t,n,r)}),r.length>0&&r[0].parent.isGroup()){for(var o=r[0].parent;o.parent.isGroup();)o=o.parent;this._componentDrawer(t,o,n,function(t,n,r){e.groupOutline.draw(t,n,r)})}r.forEach(function(r){e._componentDrawer(t,r,n,function(t,n,r){e.reversedModelers.forEach(function(e){return e.draw(t,n,r)})})})}},{key:"onkeydown",value:function(t){"Alt"==t.key&&(this._control_mode=!0,this.invalidate())}},{key:"onkeyup",value:function(t){"Alt"==t.key&&(this._control_mode=!1,this.invalidate())}},{key:"onselected",value:function(t,e){this.invalidate()}},{key:"onchange_model",value:function(t,e,n){n.origin===n.deliverer&&(t.translate&&this.set("translate",t.translate),void 0!==t.rotation&&this.set("rotation",t.rotation),t.scale&&this.set("scale",t.scale)),this.invalidate()}},{key:"ondblclick",value:function(t){"function"==typeof this.currentModeler.ondblclick&&this.currentModeler.ondblclick(t),this.invalidate()}},{key:"onmousedown",value:function(t){this.currentModeler.onmousedown(t),this.invalidate()}},{key:"onmouseup",value:function(t){"function"==typeof this.currentModeler.onmouseup&&this.currentModeler.onmouseup(t),this.invalidate()}},{key:"onmouseenter",value:function(t,e){this.invalidate()}},{key:"onmouseleave",value:function(t,e){this.invalidate()}},{key:"ondragstart",value:function(t){this.currentModeler.ondragstart(t),this._state_dragging=!0}},{key:"ondragmove",value:function(t){this.currentModeler.ondragmove(t),this.invalidate()}},{key:"ondragend",value:function(t){this._state_dragging=!1,this.currentModeler.ondragend(t),this.invalidate()}},{key:"ondrop",value:function(t,e){for(var n=this,r=e.origin,o=t.dataTransfer.files,i=[],a=0;a<o.length;a++)o[a].type.startsWith("image/")&&i.push(o[a]);if(!(i.length<1))if(t.altKey){var u=new FileReader;u.addEventListener("loadend",function(t){l.default.around(n.app.commander,function(){r.set("fillStyle",{type:"pattern",image:u.result,fitPattern:!0})}),n.selected=[r]}),u.readAsDataURL(i[0])}else{var c=this.rootModel.transcoordC2S(t.offsetX,t.offsetY),h=this.rootModel,p=[],d=i.length;i.forEach(function(t){var e=new FileReader;e.addEventListener("loadend",function(t){var r=s.compile({type:"image-view",top:0,left:0,width:200,height:200,src:e.result},h.app);r.center=c,c.x+=50,c.y+=50,p.push({component:r,to_container:h}),--d||(n.app.commander.execute(new f.default({changes:p})),n.selected=p.map(function(t){return t.component}))}),e.readAsDataURL(t)})}}},{key:"onwheel_scale",value:function(t,e){if(0!=t.deltaY||0!=t.deltaX){var n=e.deliverer;if(t.shiftKey){if(-1!=navigator.userAgent.indexOf("Win"))r=t.deltaY<0?1:-1;else r=t.deltaX<0?1:-1;l.default.around(this.app.commander,function(){n.selected.forEach(function(t){var e=t.get("fontSize")||h.DEFAULT.FONT_SIZE;e<1&&(e=1),e+=r,t.set("fontSize",e)})})}else{var r=t.deltaY<0?1:-1,o=n.get("scale")||{x:1,y:1},i=n.get("translate"),a=t.offsetX,u=t.offsetY,s=n.transcoordC2S(a,u),c=.1*r,f={x:o.x+c,y:o.y+c};if(r<0&&o.x<.2||r>0&&o.x>10)return;n.set("scale",f);var p=n.transcoordC2S(a,u);n.set("translate",{x:i.x+(p.x-s.x)*f.x,y:i.y+(p.y-s.y)*f.y})}}}},{key:"modelers",get:function(){return this._control_mode?this._control_mode_modelers:this._modelers}},{key:"reversedModelers",get:function(){return this._control_mode?this._control_mode_reverse_modelers:this._reversed_modelers}},{key:"eventMap",get:function(){return{"model-layer":{"(all)":{change:this.onchange_model,wheel:this.onwheel_scale,drop:this.ondrop}},"(root)":{"(self)":{selected:this.onselected,keydown:this.onkeydown,keyup:this.onkeyup}}}}}]),e}();e.default=p,a.default.register("modeling-layer",p)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(252);Object.defineProperty(e,"FocusOutline",{enumerable:!0,get:function(){return r(o).default}});var i=n(253);Object.defineProperty(e,"GroupOutline",{enumerable:!0,get:function(){return r(i).default}});var a=n(254);Object.defineProperty(e,"ControlHandler",{enumerable:!0,get:function(){return r(a).default}});var u=n(255);Object.defineProperty(e,"PathHandler",{enumerable:!0,get:function(){return r(u).default}});var s=n(256);Object.defineProperty(e,"Resizer",{enumerable:!0,get:function(){return r(s).default}});var c=n(257);Object.defineProperty(e,"Rotator",{enumerable:!0,get:function(){return r(c).default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return r(t,[{key:"draw",value:function(t,e,n){var r=e.bounds;0!=r.width&&0!=r.height&&(t.beginPath(),t.rect(r.left,r.top,r.width,r.height),t.clip(),t.beginPath(),t.strokeStyle="#f26522",t.lineWidth=4,t.shadowBlur=10,t.shadowColor="black",t.shadowOffsetX=0,t.shadowOffsetY=0,t.rect(r.left,r.top,r.width,r.height),t.stroke(),t.closePath())}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return r(t,[{key:"draw",value:function(t,e,n){var r=e.bounds;t.beginPath(),t.rect(r.left,r.top,r.width,r.height),t.setLineDash([3/n.x,4/n.y]),t.lineWidth=1/n.x,t.strokeStyle="black",t.stroke(),t.setLineDash([]),t.closePath()}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(7)),i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return r(t,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(t,e,n,r){var o=this,i=n.controls;return!!i&&(i.every(function(i,a){return Math.abs(t-i.x)<=4/r.x&&Math.abs(e-i.y)<=4/r.y&&(o.active={component:n,index:a,handler:i.handler}),!o.active}),!!this.active)}},{key:"draw",value:function(t,e,n){var r=e.controls;r&&r.forEach(function(e,r){t.beginPath(),t.lineWidth=1/n.x,t.ellipse(e.x,e.y,4/n.x,4/n.y,0,0,2*Math.PI,!0),t.fillStyle="#ff5d72",t.fill(),t.strokeStyle="#fff",t.stroke()})}},{key:"onevent",value:function(t,e){var n=this.active,r=n.handler,o=n.component,i=n.index,a=o.transcoordC2S(e.offsetX,e.offsetY);a=o.transcoordS2P(a.x,a.y),r&&"function"==typeof r[t]&&r[t](a,i,o)}},{key:"onmousedown",value:function(t){this.onevent("onmousedown",t)}},{key:"ondragstart",value:function(t){var e=this.active;e.changes=o.default.before([e.component]),this.onevent("ondragstart",t)}},{key:"ondragmove",value:function(t){this.onevent("ondragmove",t)}},{key:"ondragend",value:function(t){this.onevent("ondragend",t);var e=this.active,n=e.component,r=e.changes;o.default.after(r,n.app.commander),n.parent&&n.parent.calculateBounds&&n.parent.calculateBounds()}},{key:"selected",get:function(){return this.layer.selected}}]),t}();e.default=i},function(t,e,n){"use strict";function r(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(n(7)),a=15*Math.PI/180,u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return o(t,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(t,e,n,r){var o=this;return!!n.mutable&&(n.path.every(function(i,a){return Math.abs(t-i.x)<=4/r.x&&Math.abs(e-i.y)<=4/r.y&&(o.active={component:n,index:a}),!o.active}),!!this.active)}},{key:"draw",value:function(t,e,n){if(e.mutable&&!e.stuck){var r=e.path,o=this.active;r.forEach(function(r,i){t.beginPath(),t.ellipse(r.x,r.y,4/n.x,4/n.y,0,0,2*Math.PI,!0),t.lineWidth=1/n.x,t.strokeStyle="#656565",t.fillStyle="#fff",o&&o.component===e&&o.index===i&&(t.strokeStyle="#fa7703",o.toFill&&(t.fillStyle="#ffb80c")),t.fill(),t.stroke()})}}},{key:"ondblclick",value:function(t){var e=this.active.component;if(e.pathExtendable){var n=e.path.slice();n.length<4||(n.splice(this.active.index,1),e.path=n)}}},{key:"onmousedown",value:function(t){this.active.toFill=!0}},{key:"ondragstart",value:function(t){var e=this.active;e.changes=i.default.before([e.component])}},{key:"ondragmove",value:function(t){var e=this.active,n=e.component,o=e.index,i=n.transcoordC2S(t.offsetX,t.offsetY);if(i=n.transcoordS2P(i.x,i.y),t.shiftKey){var u=n.path.length,s=n.isLine()&&0==o?n.path[1]:n.path[(o-1+u)%u];s=n.transcoordS2P(s.x,s.y);var c=0;if(u>2){var l;n.isLine()?0==o?l=n.path[2]:1!=o&&(l=n.path[o-2]):l=n.path[(o-2+u)%u],l&&(c=r(l=n.transcoordS2P(l.x,l.y),s))}var f=Math.round((r(s,i)-c)/a)*a+c;i=function(t,e,n){return{x:Math.cos(e)*n+t.x,y:Math.sin(e)*n+t.y}}(s,f,function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}(s,i))}n.mutatePath(null,function(t){t[o]=i})}},{key:"ondragend",value:function(t){var e=this.active,n=e.component,r=e.changes;i.default.after(r,n.app.commander),n.parent&&n.parent.calculateBounds&&n.parent.calculateBounds()}},{key:"selected",get:function(){return this.layer.selected}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t,e,n){var r,o,i=t.bounds,a=i.left,y=i.top,v=i.width,g=i.height;switch(e){case u:r=a,o=y;break;case s:r=a+v/2,o=y;break;case c:r=a+v,o=y;break;case l:r=a+v,o=y+g/2;break;case f:r=a+v,o=y+g;break;case h:r=a+v/2,o=y+g;break;case p:r=a,o=y+g;break;case d:r=a,o=y+g/2}var b={x:r,y:o},_=t.transcoordT2S(n.x,n.y);return{dx:_.x-b.x,dy:_.y-b.y}}function o(t,e,n,r,o,i){var a=t.bounds,y=a.left,v=a.top,g=a.width,b=a.height,_={left:y,top:v,width:g,height:b};switch(e){case u:y+=r,v+=o,g-=r,b-=o;break;case s:v+=o,b-=o;break;case c:v+=o,g+=r,b-=o;break;case l:g+=r;break;case f:g+=r,b+=o;break;case h:b+=o;break;case p:y+=r,g-=r,b+=o;break;case d:y+=r,g-=r}if(t.mutateBounds(function(e){return Math.abs(g)<=.001&&(g=.001),Math.abs(b)<=.001&&(b=.001),t.adjustResize({left:y,top:v,width:g,height:b},_,n)},this),t.isContainer()&&t.layout.ABSOLUTE&&!t.isGroup()){var m=_.left-y,w=_.top-v;i?t.components.forEach(function(t){t.delta("tx",0),t.delta("ty",0),t.move({x:m,y:w})}):t.components.forEach(function(t){t.delta("tx",m),t.delta("ty",w)})}else{var x=i&&t.parent;x&&x.isGroup()&&group.calculateBounds()}}function i(t){var e=t.left,n=t.top,r=t.width,o=t.height,i=e+r/2,a=n+o/2,u=e+r,s=n+o;return[{x:e,y:n},{x:i,y:n},{x:u,y:n},{x:u,y:a},{x:u,y:s},{x:i,y:s},{x:e,y:s},{x:e,y:a}]}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=0,s=1,c=2,l=3,f=4,h=5,p=6,d=7,y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return a(t,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(t,e,n,r){var o=this;return!!n.resizable&&(i(n.bounds).every(function(i,a){return Math.abs(t-i.x)<=4/r.x&&Math.abs(e-i.y)<=4/r.y&&(o.active={component:n,index:a}),!o.active}),!!this.active)}},{key:"draw",value:function(t,e,n){if(!e.isLine()){var r=e.bounds;if(t.beginPath(),t.rect(r.left,r.top,r.width,r.height),t.setLineDash([3/n.x,4/n.y]),t.lineWidth=1/n.x,t.strokeStyle="black",t.stroke(),t.setLineDash([]),e.resizable){var o=this.active;i(r).forEach(function(r,i){t.beginPath(),t.rect(r.x-4/n.x,r.y-4/n.y,8/n.x,8/n.y),t.setLineDash([0,0]),t.strokeStyle="#656565",t.stroke(),t.fillStyle="#fff",o&&o.component===e&&o.index===i&&(t.strokeStyle="#fa7703",o.focus&&(t.fillStyle="#ffb80c")),t.fill(),t.stroke()})}}}},{key:"onmousedown",value:function(t){this.active.focus=!0}},{key:"ondragstart",value:function(t){var e=this.active.component;this.active.bounds=e.bounds,this.active.boundsList=this.layer.selected.filter(function(t){return t.resizable}).map(function(t){return t.bounds})}},{key:"ondragmove",value:function(t){var e=this.active,n=e.component,i=e.index,a=e.boundsList,u=e.bounds,s=this.layer.transcoordC2S(t.offsetX,t.offsetY);n.bounds=u;var c=r(n,i,s);this.layer.selected.filter(function(t){return t.resizable}).forEach(function(e,n){e.bounds=a[n],o(e,i,t.shiftKey,c.dx,c.dy,!1)})}},{key:"ondragend",value:function(t){var e=this.active,n=e.component,i=e.index,a=e.boundsList,u=e.bounds,s=this.layer.transcoordC2S(t.offsetX,t.offsetY);n.bounds=u;var c=r(n,i,s);this.layer.selected.filter(function(t){return t.resizable}).forEach(function(e,n){e.bounds=a[n],o(e,i,t.shiftKey,c.dx,c.dy,!0)}),this.active.component.app.commander.execute(null,!1)}},{key:"selected",get:function(){return this.layer.selected}}]),t}();e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=t.bounds;return{x:n.left+n.width/2,y:n.top-a/e.y}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=(r(n(0)),r(n(7)),20),u=2*Math.PI,s=Math.PI/2,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.layer=e}return i(t,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(t,e,n,r){if(!n.rotatable)return!1;var i=o(n,r);return Math.abs(t-i.x)<=4/r.x&&Math.abs(e-i.y)<=4/r.y&&(this.active={component:n},!0)}},{key:"draw",value:function(t,e,n){if(e.rotatable){t.beginPath();var r=o(e,n);t.lineWidth=1.5/n.x,t.moveTo(r.x,r.y+a/n.y),t.lineTo(r.x,r.y),t.strokeStyle="#656565",t.stroke(),t.beginPath(),t.ellipse(r.x,r.y,4/n.x,4/n.y,0,0,u,!0),t.stroke(),t.fillStyle="#fff",t.fill();var i=this.active;i&&i.component===e&&(t.strokeStyle="#fa7703",t.stroke(),i.toFill&&(t.fillStyle="#ffb80c",t.fill()))}}},{key:"onmousedown",value:function(t){this.active.toFill=!0}},{key:"ondragstart",value:function(t){var e=this.active;e.component;e.start_rotation=e.component.get("rotation"),e.rotations=this.layer.selected.filter(function(t){return t.rotatable}).map(function(t){return t.get("rotation")})}},{key:"ondragmove",value:function(t){var e=this.active.component,n=e.transcoordC2S(t.offsetX,t.offsetY);n=e.transcoordS2P(n.x,n.y);var r=e.rotatePoint,o=e.get("rotation")||0,i=Math.atan((r.y-n.y)/(r.x-n.x)),a=(i=r.x>=n.x?i-s:s+i)-o;this.layer.selected.filter(function(t){return t.rotatable}).forEach(function(e,n){var r=((e.get("rotation")||0)+a)%u;e.set("rotation",e.adjustRotation(r,t.shiftKey))})}},{key:"ondragend",value:function(t){var e=this.active,n=e.component;e.rotations;n.app.commander.execute(null,!1)}},{key:"selected",get:function(){return this.layer.selected}}]),t}();e.default=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(0)),a=r(n(14)),u=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(2)),225*Math.PI/180),s=135*Math.PI/180,c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r._anim_alpha=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),o(e,[{key:"_drawArrow",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=n.x-e.x,i=n.y-e.y,a=Math.atan2(i,o),c=n.x+r*Math.cos(a+u),l=n.y+r*Math.sin(a+u),f=n.x+r*Math.cos(a+s),h=n.y+r*Math.sin(a+s);t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.moveTo(n.x,n.y),t.lineTo(c,l),t.moveTo(n.x,n.y),t.lineTo(f,h),t.stroke()}},{key:"animOnTargetChange",value:function(t){var e=this;t!==this._lastTargets&&(this._lastTargets=t,this._anim_alpha=1,this.animate({step:function(t){e._anim_alpha=1-t*t,e.invalidate()},duration:5e3,delta:"linear",options:{x:1},ease:"out"}).start())}},{key:"_draw",value:function(t){var e=this,n=this.targets&&this.targets.filter(function(t){return t.rootModel});if(!n||0==n.length)return this._animate&&this._animate.stop(),void delete this._animate;var r=!1;n.forEach(function(n){var o=n.get("id");if(t.globalAlpha*=e._anim_alpha,o){var i="#"+o,a=n.bounds,u=a.left,s=a.top,c=n.transcoordS2C(u,s,n.rootModel),l=c.x,f=c.y;l=Math.max(l,0),f=Math.max(f-18,0),t.font="12px Arial";var h=t.measureText(i);t.fillStyle="#FF0000",t.fillRect(l,f,h.width+6,16),t.fillStyle="white",t.fillText(i,l+3,f+13),r=!0}t.lineWidth=2,t.strokeStyle="orange",n.mappings&&n.mappings.forEach(function(o){var i=e.root.findAll(o.target,n);i&&i.forEach(function(r){var o=n.center,i=r.center;o=n.transcoordS2C(o.x,o.y,n.rootModel),i=r.transcoordS2C(i.x,i.y,r.rootModel),e._drawArrow(t,o,i)}),r=!0})}),r&&this.animOnTargetChange(this.targets)}},{key:"_ontag",value:function(t){this.targets&&-1!==this.targets.lastIndexOf(t)||(this.targets=(this.targets||[]).concat(t))}},{key:"_offtag",value:function(t){if(this.targets){var e=this.targets.slice();e.splice(this.targets.lastIndexOf(t),1),this.targets=e}}},{key:"_resettag",value:function(){this.targets=[]}},{key:"ontagreset",value:function(t,e){this._resettag()}},{key:"ontag",value:function(t,e){this._ontag(e.origin)}},{key:"offtag",value:function(t,e){this._offtag(e.origin)}},{key:"onmouseenter",value:function(t,e){this._resettag(),this._ontag(e.origin)}},{key:"onmouseleave",value:function(t,e){this._resettag()}},{key:"targets",get:function(){return this._targets},set:function(t){this._targets=t&&t.filter(function(t){return!t.isLayer()}),this.invalidate()}},{key:"eventMap",get:function(){return{"model-layer":{"(descendant)":{tag:this.ontag,tagreset:this.ontagreset,mouseenter:this.onmouseenter,mouseleave:this.onmouseleave}}}}}]),e}();e.default=c,i.default.register("tag-layer",c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(260);Object.defineProperty(e,"compile",{enumerable:!0,get:function(){return function(t){return t&&t.__esModule?t:{default:t}}(r).default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(262);Object.defineProperty(e,"Engine",{enumerable:!0,get:function(){return r(o).default}});var i=n(264);Object.defineProperty(e,"UAEventHandler",{enumerable:!0,get:function(){return r(i).default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(n(263)),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(20)),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMaps=[],this.root=e,e.eventMap&&this.add(e,e.eventMap)}return r(t,[{key:"stop",value:function(){this.eventMaps.forEach(function(t){return t.eventPump.stop()})}},{key:"add",value:function(t,e){var n=this;if(this.root){for(var r in e)!function(r){var a=e[r];if("(self)"===r&&void 0===t.on)throw new Error("(self) selector not available when deliverer is not a event handlable object.");i.select(r,n.root,t).forEach(function(r){var i=new o.default(r);i.on(t,a),i.start(),n.eventMaps.push({eventPump:i,listener:t,handlerMap:e,deliverer:r})})}(r)}}},{key:"remove",value:function(t,e){for(var n=this.eventMaps.slice(0),r=0;r<n.length;r++){var o=n[r];o.listener!==t||e&&o.handlerMap!==e||(this.eventMaps.splice(r,1),o.eventPump.dispose())}}},{key:"clear",value:function(){this.eventMaps.slice(0).forEach(function(t){return t.eventPump.dispose()}),this.eventMaps=[]}},{key:"dispose",value:function(){this.stop(),this.clear()}},{key:"root",set:function(t){this._root=t},get:function(){return this._root}}]),t}();e.default=a},function(t,e,n){"use strict";function r(){var t=arguments,e=t[t.length-1],n=this.event_pump;n.listeners.forEach(function(r){!function(t,e,n,r,o){for(var a in n){var u=n[a];if(i.match(a,r.origin,e,t))for(var s in u){var c=u[s];s==r.name&&(r.listener=e,c.apply(e,o))}}}(n.deliverer,r.listener,r.cloned_handlers,e,t)})}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(20)),a=n(1),u=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===e.on)throw new Error("Deliverer should be a event handlable object.");this.deliverer=e,this.listeners=[]}return o(t,[{key:"start",value:function(){this.deliverer.on("(all)",r,{event_pump:this})}},{key:"stop",value:function(){this.deliverer.off("(all)",r)}},{key:"on",value:function(t,e){var n=Object.assign({},e);Object.keys(n).forEach(function(e){if(0==e.indexOf("?")){var r=n[e],o=e.substr(1),i=t.get(o);delete n[e],i?n[i]=r:(0,a.warn)("EventPump#on","variable #{selector} is not evaluated on listener")}}),this.listeners.push({listener:t,handlers:e,cloned_handlers:n})}},{key:"off",value:function(t,e){for(var n=0;n<this.listeners.length;n++){var r=this.listeners[n];r.listener!==t||e&&r.handlers!==e||this.listeners.splice(n,1)}}},{key:"clear",value:function(){this.listeners=[]}},{key:"dispose",value:function(){this.stop(),this.clear()}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return t.capture(e.offsetX,e.offsetY)}function a(t,e,n){if(t){n.type=e;var r="on"+e;t[r]&&t[r](n),n.isPropagationStopped()||t.trigger(e,n)}}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=(r(n(0)),r(n(8)),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2))),c={NORMAL:0,DRAGGABLE:1,DRAGGING:2},l={},f=function(){function t(e,n){o(this,t),this._type=n.type,this._ctrlKey=n.ctrlKey,this._altKey=n.altKey,this._shiftKey=n.shiftKey,this._metaKey=n.metaKey;var r=function(t,e){return e.touches?e.touches[0]?l={x:e.offsetX,y:e.offsetY}:l:{x:e.offsetX,y:e.offsetY}}(0,n);this._offsetX=r.x,this._offsetY=r.y,"wheel"==n.type?(this.deltaX=n.deltaX,this.deltaY=n.deltaY,this.deltaZ=n.deltaZ):"drop"==n.type&&(this.dataTransfer=n.dataTransfer)}return u(t,[{key:"stopPropagation",value:function(){this._stop_=!0}},{key:"isPropagationStopped",value:function(){return this._stop_}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"altKey",get:function(){return this._altKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"metaKey",get:function(){return this._metaKey}}]),t}(),h=function(){function t(e,n){var r=this;o(this,t),this.container=e,this.html_element=n,this.status=c.NORMAL,this.last_target=null,this.gesture_handlers=s.GESTURES.map(function(t){return r.gestureHandlerBuilder(t)}),this.keyevent_handlers=s.KEYEVENTS.map(function(t){return r.keyeventHandlerBuilder(t)}),s.GESTURES.forEach(function(t,e){return n.addEventListener(t,r.gesture_handlers[e])}),s.KEYEVENTS.forEach(function(t,e){return n.addEventListener(t,r.keyevent_handlers[e])}),n.ondragover=this.gestureHandlerBuilder("dragover"),n.ondrop=this.gestureHandlerBuilder("drop"),n.tabIndex=1}return u(t,[{key:"dispose",value:function(){var t=this;s.GESTURES.forEach(function(e,n){return t.html_element.removeEventListener(e,t.gesture_handlers[n])}),s.KEYEVENTS.forEach(function(e,n){return t.html_element.removeEventListener(e,t.keyevent_handlers[n])}),delete this.gesture_handlers,delete this.keyevent_handlers,delete this.last_target}},{key:"gestureHandlerBuilder",value:function(t){var e=this["on"+t].bind(this),n=this.html_element;return function(t){return!e(new f(n,t))&&t.preventDefault(),!1}}},{key:"keyeventHandlerBuilder",value:function(t){return this["on"+t].bind(this)}},{key:"ondragover",value:function(t){return a(i(this.container,t),t.type,t),!1}},{key:"ondrop",value:function(t){return a(i(this.container,t),t.type,t),!1}},{key:"onclick",value:function(t){return this.html_element.focus(),a(i(this.container,t),t.type,t),this.last_target=null,!1}},{key:"ondblclick",value:function(t){return a(i(this.container,t),t.type,t),this.last_target=null,!1}},{key:"onkeydown",value:function(t){return this.container.trigger(t.type,t),!1}},{key:"onkeyup",value:function(t){return this.container.trigger(t.type,t),!1}},{key:"onmousemove",value:function(t){switch(this.status){case c.DRAGGABLE:var e=t.offsetX-this.__dragstart_e.offsetX,n=t.offsetY-this.__dragstart_e.offsetY;if(e*e+n*n<16)break;this.status=c.DRAGGING,a(this.last_target,"dragstart",this.__dragstart_e),this.__dragmove_e=t,a(this.last_target,"dragmove",t);break;case c.DRAGGING:this.__dragmove_e=t,a(this.last_target,"dragmove",t);break;default:var r=i(this.container,t);this.last_target!=r&&(this.last_target&&a(this.last_target,"mouseleave",t),r&&a(r,"mouseenter",t)),a(r,t.type,t),this.last_target=r}return!1}},{key:"onmousedown",value:function(t){switch(this.status){case c.DRAGGING:a(this.last_target,"dragend",t),this.last_target=null,this.status=c.NORMAL;break;default:var e=i(this.container,t);this.last_target=e,this.status=c.DRAGGABLE,this.__dragstart_e=t,a(e,t.type,t)}return!1}},{key:"onmouseup",value:function(t){switch(this.status){case c.DRAGGING:a(this.last_target,"dragend",t);break;default:a(i(this.container,t),t.type,t)}return this.last_target=null,this.status=c.NORMAL,!1}},{key:"onmouseout",value:function(t){var e=i(this.container,t);switch(this.status){case c.DRAGGING:a(this.last_target,"dragend",t);break;default:if(this.last_target&&this.last_target===e)return;this.last_target&&a(this.last_target,"mouseleave",t)}return this.last_target=null,this.status=c.NORMAL,!1}},{key:"ontouchstart",value:function(t){var e=i(this.container,t);return this.last_target=e,this.status=c.DRAGGABLE,a(e,"mousedown",t),!1}},{key:"ontouchmove",value:function(t){switch(this.status){case c.DRAGGABLE:this.status=c.DRAGGING,a(this.last_target,"dragstart",t),a(this.last_target,"dragmove",t);break;case c.DRAGGING:a(this.last_target,"dragmove",t);break;default:var e=i(this.container,t);this.last_target!=e&&(this.last_target&&a(this.last_target,"mouseleave",t),e&&a(e,"mouseenter",t)),a(e,t.type,t),this.last_target=e}return!1}},{key:"ontouchend",value:function(t){switch(this.status){case c.DRAGGING:a(this.last_target,"dragend",t);break;default:var e=i(this.container,t);a(e,"mouseup",t),a(e,"click",t)}return this.last_target=null,this.status=c.NORMAL,!1}},{key:"onwheel",value:function(t){return a(i(this.container,t),t.type,t),!0}}]),t}();e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.EventMap=void 0;var o=n(29);Object.defineProperty(e,"EventMap",{enumerable:!0,get:function(){return r(o).default}});r(n(266)),r(n(267))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){function e(e){var n={left:0,top:0},r=L*function(t,e,n,r){var o,i=t.getContext();return i.save(),i.font=n,o=(0,s.default)(i,e,r,t.get("textWrap")).length,i.restore(),o}(t,e,q,H);switch(z.style.height=r+"px",k){case"top":case"hanging":break;case"bottom":case"alphabetic":n.top=V-r;break;case"middle":default:n.top=V/2-r/2}if(!y){var o=function(t,e,n,r){var o=e.split("\n"),i=r,a=t.getContext();return a.save(),a.font=n,o.forEach(function(t){var e=a.measureText(t).width;e>i&&(i=e)}),a.restore(),i}(t,e,q,H);switch(z.style.width=o+"px",w){case"right":case"end":n.left=H-o;break;case"left":case"start":break;case"center":case"justify":default:n.left=(H-o)/2}}z.style.marginLeft=n.left+"px",z.style.marginTop=n.top+"px";var i="translate("+U.x+"px, "+U.y+"px) scale("+G+") rotate("+c+"rad)";["-webkit-","-moz-","-ms-","-o-",""].forEach(function(t){z.style[t+"transform"]=i,z.style[t+"transform-origin"]=-n.left+"px "+-n.top+"px"})}if(t.hasTextProperty&&!t.textHidden){var n=t.model,r=n.text,o=void 0===r?"":r,a=n.rotation,c=void 0===a?0:a,l=n.bold,f=void 0===l?i.DEFAULT.BOLD:l,h=n.italic,p=void 0===h?i.DEFAULT.ITALIC:h,d=n.textWrap,y=void 0===d?i.DEFAULT.TEXT_WRAP:d,v=n.fontFamily,g=void 0===v?i.DEFAULT.FONT_FAMILY:v,b=n.fontColor,_=void 0===b?i.DEFAULT.FONT_COLOR:b,m=n.textAlign,w=void 0===m?i.DEFAULT.TEXT_ALIGN:m,x=n.textBaseline,k=void 0===x?i.DEFAULT.TEXT_BASELINE:x,O=n.paddingTop,P=void 0===O?0:O,A=n.paddingBottom,j=void 0===A?0:A,E=n.paddingLeft,M=void 0===E?0:E,S=n.paddingRight,T=void 0===S?0:S,C=n.fontSize,R=void 0===C?i.DEFAULT.FONT_SIZE:C,I=n.lineHeight,L=void 0===I?1.2*R:I,D=t.bounds,B=D.left,F=D.top,N=D.width,Y=D.height;t.textHidden=!0;var z=document.createElement("textarea");i.GESTURES.forEach(function(t){z.addEventListener(t,function(t){t.stopPropagation()},!0)}),i.KEYEVENTS.forEach(function(t){z.addEventListener(t,function(t){t.stopPropagation()},!0)});var U=t.transcoordS2C(B,F),W=function(t){for(var e=0,n=1,r=t;r;){e+=r.get("rotation")||0;var o=r.get("scale")||{x:1,y:1},i=o.x,a=o.y;n*=Math.max(i,a)||1,r=r.parent}return{rotation:e,scale:n}}(t),c=W.rotation,G=W.scale,H=N-M-T,X=H,V=Y-P-j;switch(z.style.position="absolute",z.style.width=X+"px",z.style.height=V+"px",z.style.paddingLeft=Math.max(M,0)+"px",z.style.paddingRight=T+"px",z.style.paddingTop=Math.max(P,0)+"px",z.style.paddingBottom=j+"px",z.value=o,z.style.fontFamily=g,z.style.fontSize=R+"px",z.style.lineHeight=L+"px",z.style.overflow="hidden",z.style.resize="none",z.style.outline="none",z.style.border=0,z.style.backgroundColor="transparent",z.style.display="inline-block",z.style.color=_,f&&(z.style.fontWeight="bold"),p&&(z.style.fontStyle="italic"),w){case"right":case"end":z.style.textAlign="right";break;case"justify":z.style.textAlign="justify";break;case"left":case"start":z.style.textAlign="left";break;case"center":default:z.style.textAlign="center"}var q=[f,p,R+"px",g].filter(function(t){return!!t}).join(" ");e(o);var K=t.root.target_element;K.appendChild(z),z.select();var Z=!1;z.onkeydown=function(t){"Escape"!=t.code&&(t.shiftKey||"Enter"!=t.code&&"NumpadEnter"!=t.code)?setTimeout(function(){e(z.value)}):(Z=Q.skipUpdate="Escape"==t.code,document.createEvent?z.dispatchEvent(Q):z.fireEvent(Q.eventType,Q))};var Q;document.createEvent?(Q=document.createEvent("HTMLEvents")).initEvent("blur",!0,!1):(Q=document.createEventObject()).eventType="blur";var J=t.root.selected;z.addEventListener("blur",function e(n){t.root.selected=J,t.textHidden=!1,z.removeEventListener("blur",e,!1),z.parentElement&&z.parentElement.removeChild(z),K.focus(),n.skipUpdate||Z||t.app.commander.execute(new u.default({changes:[{component:t,before:{text:o},after:{text:z.value}}]}))},!1)}}var i=n(2),a=r(n(29)),u=r(n(7)),s=r(n(76));a.default.register("text-editor",{"(root)":{"(self)":{keydown:function(t,e){e.origin;var n=e.deliverer.selected;return!(1!==n.length||!n[0].hasTextProperty||"Enter"!=t.code&&"NumpadEnter"!=t.code||(o(n[0]),t.preventDefault(),0))}}},"model-layer":{"(descendant)":{dblclick:function(t,e){o(e.origin)}}}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}!function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(2));var o=r(n(29)),i=r(n(88)),a=(r(n(0)),r(n(8)),r(n(28)),r(n(7))),u=r(n(15)),s=0,c=2,l=3,f=4,h=(0,n(3).debounce)(function(t,e,n){if(n)t.focused=null;else{var r=[];e[0].parent.isGroup()?t.focused=e[0].parent:(e.forEach(function(t){t.path.forEach(function(e){r.push(t.transcoordS2T(e.x,e.y))})}),t.focused=t.capturePath(r,e))}},300);o.default.register("move-handler",{"model-layer":{"(descendant)":{dragstart:function(t,e){var n=e.origin,r=e.deliverer;if(!n.stuck){var o=r.selected,u=r.selected.filter(function(t){return!t.stuck});if(o.length!==u.length&&(o=r.selected=u),0!=o.length){var c=o[0].transcoordC2S(t.offsetX,t.offsetY);c=o[0].transcoordS2P(c.x,c.y),this.last_pos=c,this.direction=s,r.focused=o[0].parent,t.altKey?(r.selected=o.map(function(t){var e=(0,i.default)(t);return t.parent.addComponent(e),e}),this.duplicates=r.selected.map(function(t){return{component:t}})):this.changes=a.default.before(o)}}},dragmove:function(t,e){var n=e.origin,r=e.deliverer;if(!n.stuck){var o=r.selected;if(0!=o.length){var i=o[0].transcoordC2S(t.offsetX,t.offsetY),a=i.x,u=i.y,p=o[0].transcoordS2P(a,u);t.shiftKey?this.direction==c&&(this.direction=s):this.direction=c;var d=p.x-this.last_pos.x,y=p.y-this.last_pos.y;if(this.direction==s){if(d*d+y*y<25)return;Math.abs(d)>Math.abs(y)?this.direction=l:this.direction=f}this.direction==l?y=0:this.direction==f&&(d=0),o.forEach(function(t){t.move({x:d,y:y})}),this.last_pos=p,h(r,o)}}},dragend:function(t,e){var n=e.origin,r=e.deliverer;if(!n.stuck){var o=r.selected;if(0!=o.length){var i=n.parent,s=r.focused||e.deliverer;if(this.changes)if(s&&s!==i){var c=this.changes.map(function(t){var e=t.component;return t.before,{component:e,to_container:s}});r.app.commander.execute(new u.default({changes:c}))}else a.default.after(this.changes,r.app.commander);else if(this.duplicates){this.duplicates=this.duplicates.map(function(t){return t.to_container=s,t});var l=new u.default({changes:this.duplicates});r.app.commander.execute(l)}o.forEach(function(t){t.parent&&t.parent.calculateBounds&&t.parent.calculateBounds()}),this.last_pos=null,this.changes=null,h(r,o,!0)}}}}},"(root)":{"(self)":{keydown:function(t,e){var n=e.origin,r=e.deliverer,o={},i=t.shiftKey?n.rootModel.MPP:1;switch(t.which){case 37:o.x=-i,o.y=0;break;case 38:o.x=0,o.y=-i;break;case 39:o.x=i,o.y=0;break;case 40:o.x=0,o.y=i;break;default:return}var u=r.selected;a.default.around(r.app.commander,function(){u.forEach(function(t){!t.stuck&&t.move(o)})})}}}})},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=r(n(27)),a=function(t){return t&&t.__esModule?t:{default:t}}(n(41)),u=r(n(2)),s=n(38),c=Math.PI/12,l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._mode=e,this.screen=a.default.screen(),this._baseUrl="undefined"!=typeof window?window.location.origin:null,this._refProvider=n,this.isEditMode&&(this._rotateStep=c,this._rotateStepForced=!1)}return o(t,[{key:"dispose",value:function(){}},{key:"_calcScreen",value:function(){var t={width:screen.width,height:screen.height};this._PPI=function(t,e,n,r){t>0||(t=1),e>0||(e=1),r||(r="d");var o=("d"==r?Math.sqrt(t*t+e*e):"w"==r?t:e)/n;return o>0?Math.round(o):0}(t.width,t.height,this.screen),this._PPM=this._PPI/25.4}},{key:"url",value:function(t){return t.replace("$base_url",this.baseUrl)}},{key:"refProvider",get:function(){return this._refProvider}},{key:"commander",set:function(t){this._commander=t},get:function(){return this._commander}},{key:"screen",get:function(){return this._screen},set:function(t){this._screen=t,this._calcScreen()}},{key:"DPPX",get:function(){return u.DPPX}},{key:"PPI",get:function(){return this._PPI}},{key:"PPM",get:function(){return this._PPM}},{key:"mode",get:function(){return this._mode},set:function(t){var e=this._mode;e!==t&&(this._mode=t,this.trigger("mode",t,e))}},{key:"isViewMode",get:function(){return this._mode==u.MODE_VIEW}},{key:"isEditMode",get:function(){return this._mode==u.MODE_EDIT}},{key:"baseUrl",get:function(){return this._baseUrl},set:function(t){this._baseUrl=t,void 0!=t&&(s.License.baseUrl=t.replace(/^(?:http(s?)\:\/\/)?/,"").replace("/rest",""))}},{key:"rotateStep",get:function(){return this._rotateStep},set:function(t){this._rotateStep=Number(t)||c}},{key:"rotateStepForced",get:function(){return this._rotateStepForced},set:function(t){this._rotateStepForced=!!t}}]),t}();e.default=l,i.mixin(l.prototype,i.event.withEvent)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(270);Object.defineProperty(e,"align",{enumerable:!0,get:function(){return r(o).default}});var i=n(271);Object.defineProperty(e,"distribute",{enumerable:!0,get:function(){return r(i).default}});var a=n(272);Object.defineProperty(e,"zorder",{enumerable:!0,get:function(){return r(a).default}});var u=n(39);Object.defineProperty(e,"add",{enumerable:!0,get:function(){return r(u).default}});var s=n(273);Object.defineProperty(e,"duplicate",{enumerable:!0,get:function(){return r(s).default}});var c=n(40);Object.defineProperty(e,"remove",{enumerable:!0,get:function(){return r(c).default}});var l=n(274);Object.defineProperty(e,"on",{enumerable:!0,get:function(){return l.on}}),Object.defineProperty(e,"once",{enumerable:!0,get:function(){return l.once}}),Object.defineProperty(e,"off",{enumerable:!0,get:function(){return l.off}});var f=n(275);Object.defineProperty(e,"fullscreen",{enumerable:!0,get:function(){return r(f).default}});var h=n(276);Object.defineProperty(e,"cut",{enumerable:!0,get:function(){return h.cut}}),Object.defineProperty(e,"copy",{enumerable:!0,get:function(){return h.copy}}),Object.defineProperty(e,"paste",{enumerable:!0,get:function(){return h.paste}});var p=n(277);Object.defineProperty(e,"toDataURL",{enumerable:!0,get:function(){return p.toDataURL}}),Object.defineProperty(e,"toBlob",{enumerable:!0,get:function(){return p.toBlob}});var d=n(279);Object.defineProperty(e,"group",{enumerable:!0,get:function(){return d.group}}),Object.defineProperty(e,"ungroup",{enumerable:!0,get:function(){return d.ungroup}});var y=n(280);Object.defineProperty(e,"symmetryX",{enumerable:!0,get:function(){return y.symmetryX}}),Object.defineProperty(e,"symmetryY",{enumerable:!0,get:function(){return y.symmetryY}});var v=n(281);Object.defineProperty(e,"change",{enumerable:!0,get:function(){return v.change}}),Object.defineProperty(e,"undoableChange",{enumerable:!0,get:function(){return v.undoableChange}}),Object.defineProperty(e,"undoableChangeBefore",{enumerable:!0,get:function(){return v.undoableChangeBefore}}),Object.defineProperty(e,"undoableChangeAfter",{enumerable:!0,get:function(){return v.undoableChangeAfter}}),Object.defineProperty(e,"undoableChangeReset",{enumerable:!0,get:function(){return v.undoableChangeReset}});var g=n(282);Object.defineProperty(e,"getIds",{enumerable:!0,get:function(){return g.getIds}}),Object.defineProperty(e,"getVariables",{enumerable:!0,get:function(){return g.getVariables}}),Object.defineProperty(e,"setVariables",{enumerable:!0,get:function(){return g.setVariables}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(-1!=l.indexOf(t)){var e=this.selected.filter(function(t){return!t.stuck});if(!(e.length<=1)){var n=this.app.commander;r.default.around(n,function(){!function(t,e){for(var n=JSON.parse(JSON.stringify(e[0].bounds)),r=n.left+n.width,l=n.top+n.height,f=0;f<e.length;f++){var h=e[f].bounds;n.left=h.left>n.left?n.left:h.left,n.top=h.top>n.top?n.top:h.top,r=h.left+h.width>r?h.left+h.width:r,l=h.top+h.height>l?h.top+h.height:l}switch(n.width=r-n.left,n.height=l-n.top,t){case o:for(var p=0;p<e.length;p++){var d=e[p].bounds;e[p].bounds={left:n.left,top:d.top,width:d.width,height:d.height}}break;case a:for(var y=0;y<e.length;y++){var v=e[y].bounds;e[y].bounds={left:n.left+n.width/2-v.width/2,top:v.top,width:v.width,height:v.height}}break;case i:for(var g=0;g<e.length;g++){var b=e[g].bounds;e[g].bounds={left:r-b.width,top:b.top,width:b.width,height:b.height}}break;case u:for(var _=0;_<e.length;_++){var m=e[_].bounds;e[_].bounds={left:m.left,top:n.top,width:m.width,height:m.height}}break;case c:for(var w=0;w<e.length;w++){var x=e[w].bounds;e[w].bounds={left:x.left,top:n.top+n.height/2-x.height/2,width:x.width,height:x.height}}break;case s:for(var k=0;k<e.length;k++){var O=e[k].bounds;e[k].bounds={left:O.left,top:l-O.height,width:O.width,height:O.height}}}}(t,e)})}}};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(7)),o="left",i="right",a="center",u="top",s="bottom",c="middle",l=[o,i,a,u,c,s]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(-1!=i.indexOf(t)){var e=this.selected;if(!(e.length<=1)){var n=this.app.commander;r.default.around(n,function(){!function(t,e){var n=e.filter(function(t){return!t.stuck}).slice(0);n.sort(function(e,n){var r=e.center,i=n.center;return t===o?r.y-i.y:r.x-i.x});for(var r=n.reduce(function(e,n){return e+(t===o?n.bounds.height:n.bounds.width)},0),i=n[0].bounds,a=n[n.length-1].bounds,u=((t===o?a.top+a.height-i.top:a.left+a.width-i.left)-r)/(n.length-1),s=t===o?i.top+i.height:i.left+i.width,c=1;c<n.length-1;c++){var l=n[c],f=l.bounds;s+=u,t===o?(f.top=s,s+=f.height):(f.left=s,s+=f.width),l.bounds=f}}(t,e)})}}};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(7)),o="VERTICAL",i=[o,"HORIZONTAL"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this.selected.filter(function(t){return!t.stuck});if(!(0==e.length||e[0].isRootModel()||e.length>1&&("forward"==t||"backward"==t))){var n,o=e[0].parent;if("forward"==t){var i=o.indexOf(e[0]);n=[{component:e[0],from_container:o,to_container:o,from_index:i,to_index:i+1}]}else if("backward"==t){var a=o.indexOf(e[0]);n=[{component:e[0],from_container:o,to_container:o,from_index:a,to_index:a-1}]}else n=e.filter(function(t){return t.parent===o}).sort(function(e,n){var r=o.indexOf(e)<o.indexOf(n);return"front"==t?r:!r}).map(function(e,n){return o.indexOf(e),{component:e,to_container:o,to_index:"front"==t?o.components.length-n-1:n}});var u=new r.default({changes:n});this.app.commander.execute(u)}};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(15))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=[];if(this.selected=this.selected.filter(function(t){return!t.isRootModel()}).map(function(e){var n=r.duplicate(e);return n.move({x:20,y:20}),t.push({component:n,to_container:e.parent}),n}),0!=t.length){var e=new o.default({changes:t});this.app.commander.execute(e)}};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(17)),o=function(t){return t&&t.__esModule?t:{default:t}}(n(15))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=function(t,e,n){switch(t){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.on(t,e,n);break;case"selected":this.on(t,e,n);break;case"mode":this.app.on(t,e,n);break;default:this.on(t,e,n)}},e.once=function(t,e,n){switch(t){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.once(t,e,n);break;case"selected":this.once(t,e,n);break;case"mode":this.app.once(t,e,n);break;default:this.once(t,e,n)}},e.off=function(t,e,n){switch(t){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.off(t,e,n);break;case"selected":this.off(t,e,n);break;case"mode":this.app.off(t,e,n);break;default:this.off(t,e,n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){function e(t){o.fit(r),document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"].forEach(function(t){return document.removeEventListener(t,e)})}var n=this.target_element,r=t||"ratio",o=this;["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"].forEach(function(t){return document.addEventListener(t,e)}),n.requestFullScreen?n.requestFullScreen():n.webkitRequestFullScreen?n.webkitRequestFullScreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=this.selected.filter(function(t){return!t.isRootModel()}).map(function(t){return t.hierarchy});if(0!=t.length)return s=0,JSON.stringify(t,null,2)}Object.defineProperty(e,"__esModule",{value:!0}),e.copy=o,e.cut=function(){s=0;var t=o.call(this);return i.default.call(this),t},e.paste=function(t){if(t)try{JSON.parse(t),s++,a.default.call(this,JSON.parse(t),{x:15*s,y:15*s})}catch(e){(0,u.error)(e,t)}};var i=r(n(40)),a=r(n(39)),u=n(1),s=0},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.toDataURL=function(t,e,n,r){var s=this.model_layer,c=s._overlay;return new Promise(function(l,f){if(s){var h=s.get("width"),p=s.get("height");n=n||h,r=r||p;var d=s.get("translate"),y=s.get("scale"),v=Math.min(n/h,r/p);n=h*v,r=p*v,s.set("translate",{x:0,y:0}),s.set("scale",{x:v/i.DPPX,y:v/i.DPPX});var g=o.default.createCanvas(n,r),b=g.getContext("2d");if(s.draw(b),s.set("translate",d),s.set("scale",y),!c)return l(g.toDataURL(t,e)),void(g=null);a.default.toPng(c,{sx:v,sy:v,width:n,height:r}).then(function(o){var i=new Image;i.onload=function(){b.drawImage(i,0,0,n,r),l(g.toDataURL(t,e)),g=null},i.src=o},function(n){(0,u.error)(n),l(g.toDataURL(t,e)),g=null})}else f("No target model")})};var o=r(n(0)),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2)),a=r(n(278)),u=n(1)},function(t,e,n){"use strict";function r(t,e){return e=e||{},function(t){void 0===t.imagePlaceholder?h.impl.options.imagePlaceholder=f.imagePlaceholder:h.impl.options.imagePlaceholder=t.imagePlaceholder;void 0===t.cacheBust?h.impl.options.cacheBust=f.cacheBust:h.impl.options.cacheBust=t.cacheBust}(e),Promise.resolve(t).then(function(t){return i(t,e.filter,!0)}).then(function(t){return l.inlineAll(t).then(function(){return t})}).then(function(t){var n=e,r=n.bgcolor,o=n.width,i=n.height,a=n.style,u=n.sx,s=void 0===u?1:u,c=n.sy,l=void 0===c?1:c,f=t.style;return r&&(f.backgroundColor=r),o&&(f.width=o+"px"),i&&(f.height=i+"px"),f["margin-left"]="0px",f["margin-top"]="0px",["-webkit-","-moz-","-ms-","-o-",""].forEach(function(t){f[t+"transform"]="rotate(0rad) translate(0px, 0px) scale("+s+", "+l+")"}),a&&Object.keys(a).forEach(function(t){f[t]=a[t]}),t}).then(function(n){return function(t,e,n){return Promise.resolve(t).then(function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(t)}).then(u.escapeXhtml).then(function(t){return'<foreignObject x="0" y="0" width="100%" height="100%">'+t+"</foreignObject>"}).then(function(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+n+'">'+t+"</svg>"}).then(function(t){return"data:image/svg+xml;charset=utf-8,"+t})}(n,e.width||u.width(t),e.height||u.height(t))})}function o(t,e){return r(t,e).then(u.makeImage).then(u.delay(100)).then(function(n){var r=function(t){var n=document.createElement("canvas");if(e.width,e.height,n.width=e.width||u.width(t),n.height=e.height||u.height(t),e.bgcolor){var r=n.getContext("2d");r.fillStyle=e.bgcolor,r.fillRect(0,0,n.width,n.height)}return n}(t);return r.getContext("2d").drawImage(n,0,0),r})}function i(t,e,n){return n||!e||e(t)?Promise.resolve(t).then(function(t){if(t instanceof HTMLCanvasElement)try{return u.makeImage(t.toDataURL())}catch(t){(0,a.warn)(t)}return t.cloneNode(!1)}).then(function(n){return function(t,e,n){var r=t.childNodes;return 0===r.length?Promise.resolve(e):function(t,e,n){var r=Promise.resolve();return e.forEach(function(e){r=r.then(function(){return i(e,n)}).then(function(e){e&&t.appendChild(e)})}),r}(e,u.asArray(r),n).then(function(){return e})}(t,n,e)}).then(function(e){return function(t,e){return e instanceof Element?Promise.resolve().then(function(){!function(t,e){t.cssText?e.cssText=t.cssText:function(t,e){u.asArray(t).forEach(function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))})}(t,e)}(window.getComputedStyle(t),e.style)}).then(function(){[":before",":after"].forEach(function(n){!function(n){var r=window.getComputedStyle(t,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var i=u.uid();e.className=e.className+" "+i;var a=document.createElement("style");a.appendChild(function(t,e,n){var r="."+t+":"+e,o=n.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(n):function(t){return u.asArray(t).map(function(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(r+"{"+o+"}")}(i,n,r)),e.appendChild(a)}}(n)})}).then(function(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}).then(function(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach(function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)}))}).then(function(){return e}):e}(t,e)}):Promise.resolve()}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=function(){function t(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function e(t,e){var n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();return function(){var t="application/font-woff";return{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[n]||""},dataAsUrl:function(t,e){return"data:"+e+";base64,"+t},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):function(t){return new Promise(function(e){for(var n=window.atob(t.toDataURL().split(",")[1]),r=n.length,o=new Uint8Array(r),i=0;i<r;i++)o[i]=n.charCodeAt(i);e(new Blob([o],{type:"image/png"}))})}(t)},resolveUrl:function(t,e){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=e,o.href=t,o.href},getAndEncode:function(t){var e=3e4;return h.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime()),new Promise(function(n){function r(t){console.error(t),n("")}var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var e=new FileReader;e.onloadend=function(){var t=e.result.split(/,/)[1];n(t)},e.readAsDataURL(o.response)}else i?n(i):r("cannot fetch resource: "+t+", status: "+o.status)},o.ontimeout=function(){i?n(i):r("timeout of "+e+"ms occured while fetching resource: "+t)},o.responseType="blob",o.timeout=e,o.open("GET",t,!0),o.send();var i;if(h.impl.options.imagePlaceholder){var a=h.impl.options.imagePlaceholder.split(/,/);a&&a[1]&&(i=a[1])}})},uid:function(){var t=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+t++}}(),delay:function(t){return function(e){return new Promise(function(n){setTimeout(function(){n(e)},t)})}},asArray:function(t){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e},escapeXhtml:function(t){return t.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=n,r.src=t})},width:function(t){var n=e(t,"border-left-width"),r=e(t,"border-right-width");return t.scrollWidth+n+r},height:function(t){var n=e(t,"border-top-width"),r=e(t,"border-bottom-width");return t.scrollHeight+n+r}}}(),s=function(){function t(t){return-1!==t.search(r)}function e(t){for(var e,n=[];null!==(e=r.exec(t));)n.push(e[1]);return n.filter(function(t){return!u.isDataUrl(t)})}function n(t,e,n,r){return Promise.resolve(e).then(function(t){return n?u.resolveUrl(t,n):t}).then(r||u.getAndEncode).then(function(t){return u.dataAsUrl(t,u.mimeType(e))}).then(function(n){return t.replace(function(t){return new RegExp("(url\\(['\"]?)("+u.escape(t)+")(['\"]?\\))","g")}(e),"$1"+n+"$3")})}var r=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(r,o,i){return t(r)?Promise.resolve(r).then(e).then(function(t){var e=Promise.resolve(r);return t.forEach(function(t){e=e.then(function(e){return n(e,t,o,i)})}),e}):Promise.resolve(r)},shouldProcess:t,impl:{readUrls:e,inline:n}}}(),c=function(){function t(){return Promise.resolve(u.asArray(document.styleSheets)).then(function(t){var e=[];return t.forEach(function(t){try{u.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),e}).then(function(t){return t.filter(function(t){return t.type===CSSRule.FONT_FACE_RULE}).filter(function(t){return s.shouldProcess(t.style.getPropertyValue("src"))})}).then(function(t){return t.map(function(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return s.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}})})}return{resolveAll:function(){return t(document).then(function(t){return Promise.all(t.map(function(t){return t.resolve()}))}).then(function(t){return t.join("\n")})},impl:{readAll:t}}}(),l=function(){function t(t){return{inline:function(e){return u.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||u.getAndEncode).then(function(e){return u.dataAsUrl(e,u.mimeType(t.src))}).then(function(e){return new Promise(function(n,r){t.onload=n,t.onerror=r,t.src=e})})}}}function e(n){return n instanceof Element?function(t){var e=t.style.getPropertyValue("background");return e?s.inlineAll(e).then(function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))}).then(function(){return t}):Promise.resolve(t)}(n).then(function(){return n instanceof HTMLImageElement?t(n).inline():Promise.all(u.asArray(n.childNodes).map(function(t){return e(t)}))}):Promise.resolve(n)}return{inlineAll:e,impl:{newImage:t}}}(),f={imagePlaceholder:void 0,cacheBust:!1},h={toSvg:r,toPng:function(t,e){return o(t,e||{}).then(function(t){return t.toDataURL()})},toJpeg:function(t,e){return e=e||{},o(t,e).then(function(t){return t.toDataURL("image/jpeg",e.quality||1)})},toBlob:function(t,e){return o(t,e||{}).then(u.canvasToBlob)},toPixelData:function(t,e){return o(t,e||{}).then(function(e){return e.getContext("2d").getImageData(0,0,u.width(t),u.height(t)).data})},impl:{fontFaces:c,images:l,util:u,inliner:s,options:{}}};e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.group=function(){var t=this.selected.filter(function(t){return!!t.parent&&!t.stuck});if(!(t.length<2)){var e=t[0].parent,n=[],r=t.sort(function(t,n){return e.components.indexOf(t)-e.components.indexOf(n)});r.forEach(function(t){n.push(t.bounds)});var u=o.default.union(n),s=t[0].transcoordP2S(u.left,u.top);s=t[0].transcoordS2T(s.x,s.y);var c=i.compile({type:"group",left:s.x,top:s.y,width:u.width,height:u.height}),l=[{component:c,to_container:e}];r.forEach(function(t){l.push({component:t,to_container:c})}),this.app.commander.execute(new a.default({changes:l})),this.selected=[c]}},e.ungroup=function(){if(0!==this.selected.length){var t=[],e=[];this.selected.forEach(function(n){if(n.isGroup()){var r=n.parent;n.components.forEach(function(n){t.push(n),e.push({component:n,to_container:r})}),e.push({component:n,to_container:null})}}),this.app.commander.execute(new a.default({changes:e})),this.selected=t}};var o=r(n(0)),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(17)),a=r(n(15))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.symmetryX=function(){i.default.around(this.app.commander,function(){var t=this.selected;if(0!=t.length){var e=t.map(function(t){return t.bounds}),n=o.default.union(e),r=n.left+n.width/2;t.map(function(t){t.symmetryX(r)})}},this)},e.symmetryY=function(){i.default.around(this.app.commander,function(){var t=this.selected;if(0!=t.length){var e=t.map(function(t){return t.bounds}),n=o.default.union(e),r=n.top+n.height/2;t.map(function(t){t.symmetryY(r)})}},this)};var o=r(n(0)),i=r(n(7))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.change=function(t,e,n){var r=this.findAll(t,n);return r.forEach(function(t){t.set(e)}),r},e.undoableChange=function(t){r.default.around(this.app.commander,t)};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(7))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.getIds=function(){return Object.values(this.indexMap).map(function(t){var e=t.model;return{key:e.id,value:e.data}}).sort(function(t,e){return t.key>e.key?1:-1})},e.getVariables=function(){return Object.values(this.indexMap).filter(function(t){return"variable"===t.get("type")}).map(function(t){var e=t.model,n=e.id,r=e.data;return e.dataType,{key:n,value:r}}).sort(function(t,e){return t.key>e.key?1:-1})},e.setVariables=function(t){var e=Object.values(this.indexMap).filter(function(t){return"variable"===t.get("type")}).reduce(function(t,e){return t[e.get("id")]=e,t},{}),n=[];t.forEach(function(t){var r=e[t.key];r?(r.data=t.value,delete e[t.key]):n.push({type:"variable",id:t.key,left:0,top:0,width:100,height:20,data:t.value})}),o.default.call(this,n,{x:-100,y:0}),this.selected=Object.values(e),i.default.call(this)};var o=r(n(39)),i=r(n(40))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n=e.model_layer.get("scale"),r=e.model_layer.get("translate");if(t){var o=JSON.parse(t);o.scale=n,o.translate=r,e.rebuildContentModel(o)}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(27)),u=r(n(284)),s=r(n(285)),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.timecapsule=new u.default(20);var n=this;this.snapshot_taker=new s.default({get state(){var t=n.container.model_layer.hierarchy;return JSON.stringify(t)}},this.timecapsule),this.snapshot_taker.take(!0)}return i(t,[{key:"dispose",value:function(){this.reset(),this.timecapsule&&this.timecapsule.dispose(),this.snapshot_taker&&this.snapshot_taker.dispose(),delete this.container,delete this.timecapsule,delete this.snapshot_taker}},{key:"execute",value:function(t,e){!1!==e&&t&&t.execute(),this.snapshot_taker.touch(),this.trigger("execute",t,!0,!1)}},{key:"undo",value:function(){this.timecapsule.backwardable&&(o(this.timecapsule.backward(),this.container),this.trigger("undo",this.undoable(),this.redoable()))}},{key:"redo",value:function(){this.timecapsule.forwardable&&(o(this.timecapsule.forward(),this.container),this.trigger("redo",this.undoable(),this.redoable()))}},{key:"undoable",value:function(){return this.timecapsule.backwardable}},{key:"redoable",value:function(){return this.timecapsule.forwardable}},{key:"reset",value:function(){this.timecapsule&&this.timecapsule.reset(),this.trigger("command-reset")}}]),t}();e.default=c,a.mixin(c.prototype,a.event.withEvent)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e=Number(e))||e<=0?((0,o.error)("TimeCapsule maxsize should be greater than 0.",e),this.maxsize=10):this.maxsize=e,this.reset(),n&&this.snapshot(n)}return r(t,[{key:"dispose",value:function(){this.reset()}},{key:"snapshot",value:function(t){this.q.splice(this.pos+1,this.q.length-this.pos+1,t),this.q.length>this.maxsize&&this.q.splice(0,this.q.length-this.maxsize),this.pos=this.q.length-1}},{key:"forward",value:function(){if(this.snapshot_taker&&this.snapshot_taker.take(),this.forwardable)return this.q[++this.pos];(0,o.warn)("Not forwardable.")}},{key:"backward",value:function(){if(this.snapshot_taker&&this.snapshot_taker.take(),this.backwardable)return this.q[--this.pos];(0,o.warn)("Not backwardable.")}},{key:"reset",value:function(){this.q=[],this.pos=-1}},{key:"current",get:function(){if(-1!==this.pos)return this.q[this.pos];(0,o.warn)("Non state has been recorded.")}},{key:"length",get:function(){return this.q.length}},{key:"forwardable",get:function(){return this.pos<this.q.length-1}},{key:"backwardable",get:function(){return this.pos>0}},{key:"snapshot_taker",get:function(){return this._snapshot_taker},set:function(t){this._snapshot_taker=t}}]),t}();e.default=i},function(t,e,n){"use strict";function r(t){!t.brake&&t.dirty&&i(t)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=(0,n(3).debounce)(function(t){t.brake||t.take()},1e3,{leading:!0,trailing:!1}),a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.brake=!1,this.dirty=!1,this.state_holder=e,this.timecapsule=n,this.timecapsule.snapshot_taker=this}return o(t,[{key:"dispose",value:function(){delete this.state_holder,delete this.timecapsule}},{key:"touch",value:function(){this.dirty=!0,r(this)}},{key:"take",value:function(t){(this.dirty||t)&&(this.timecapsule.snapshot(this.state_holder.state),this.dirty=!1)}},{key:"brake",get:function(){return this._brake},set:function(t){this._brake=!!t,r(this)}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(n(70)),a=new WeakSet,u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.counters={},this.references={},this.creator=e,this.disposer=n,a.add(this)}return r(t,null,[{key:"residents",get:function(){return a}}]),r(t,[{key:"dispose",value:function(){if(this.disposer)for(var t in this.references)this.disposer.call(null,t,this.references[t]);delete this.references,delete this.counters}},{key:"add",value:function(t,e){var n=this;return new Promise(function(r,o){var a=n.references[t];if(a)a===e?o(Error("Reference ID and target duplicate")):e?o(Error("Reference ID duplicate")):r(a);else{var u=function(e){e=(0,i.default)(e,function(){var t=this;this.release=function(){return n.release(t)}}),n.references[t]=e,n.counters[t]=1,r(e)};if(e)u(e);else{if(!n.creator)return void o(Error("Reference id("+t+") is not allowed. Reference creator should be defined."));n.creator.call(null,t,function(t){u(t)},function(t){o(t)})}}})}},{key:"get",value:function(t,e){var n=this;return new Promise(function(r,o){var i=n.references[t];i?n.counters.hasOwnProperty(t)?(n.counters[t]++,r(i)):o(Error("No Reference Count")):e?n.add(t).then(function(t){r(t)},function(t){o(t)}):o(Error("No References for "+t))})}},{key:"_id",value:function(t){for(var e in this.references)if(this.references[e]===t)return e;return-1}},{key:"release",value:function(t){var e=this._id(t),n=this.references[e];n?(this.counters[e]--,0==this.counters[e]&&(this.disposer&&this.disposer.call(null,e,n),delete this.references[e],delete this.counters[e],(0,o.debug)("RELEASED",e))):(0,o.error)("No Referenced ID")}},{key:"ids",get:function(){return Object.keys(this.references)}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t){var e="SCRIPT"==t.target.tagName?u:s,n=t.target.src||t.target.href;e[n]=!0,c.forEach(function(t,r){var o=t.resolve,a=t.scripts,l=t.styles;if(e==u){var f=a.indexOf(n);f>-1&&f<a.length-1&&i(a[f+1])}for(var h=0;h<a.length;h++)if(!u[a[h]])return;if(l)for(var p=0;p<l.length;p++)if(!s[l[p]])return;o(),c[r]=null}),c=c.filter(function(t){return t})}function o(t){var e=t.target.src,n="SCRIPT"==t.target.tagName?u:s;c.forEach(function(r,o){var i=r.reject,a=r.scripts,s=r.styles,l=!1;if(n===u){for(var f=0;f<a.length;f++)if(a[f]==e){l=!0;break}}else if(s)for(var h=0;h<s.length;h++)if(s[h]==e){l=!0;break}l&&(i(t),c[o]=null)}),c=c.filter(function(t){return t}),delete n[e],document.head.removeChild(t.target)}function i(t){u[t]=!1;var e=document.createElement("script");e.onload=r,e.onerror=o,e.type="text/javascript",e.src=t,document.head.appendChild(e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u={},s={},c=[],l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return a(t,null,[{key:"load",value:function(t,e){return"string"==typeof t&&(t=[t]),"string"==typeof e&&(e=[e]),new Promise(function(n,a){if((!t||t instanceof Array)&&(!e||e instanceof Array)){var l=!0;e&&e.forEach(function(t){s.hasOwnProperty(t)||function(t){s[t]=!1;var e=document.createElement("link");e.onload=r,e.onerror=o,e.type="text/css",e.rel="stylesheet",e.media="screen,print",e.href=t,document.head.appendChild(e)}(t),s[t]||(l=!1)});var f;if(t&&t.length>0&&t.forEach(function(t){u.hasOwnProperty(t)?u[t]||(l=!1):f=f||t}),f)i(f);else if(l)return void n();c.push({resolve:n,reject:a,scripts:t,styles:e})}else a("invalid sources for load")})}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default="0.0.0"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return r};var r=0,o=performance.now(),i=0;requestAnimationFrame(function t(){requestAnimationFrame(t),i++;var e=performance.now(),n=e-o;n<1e3||(r=Math.round(1e3*i/n),o=e,i=0)})}])});