!function e(t,n,r){function o(a,u){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./src/things-scene"));n.default=r,"undefined"!=typeof window&&(window.scene=r),void 0!==t&&(t.scene=r)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./src/things-scene":278}],2:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}function i(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(r));return i.join("")}n.byteLength=function(e){return 3*e.length/4-r(e)},n.toByteArray=function(e){var t,n,o,i,a,c=e.length;i=r(e),a=new s(3*c/4-i),n=i>0?c-4:c;var l=0;for(t=0;t<n;t+=4)o=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],a[l++]=o>>16&255,a[l++]=o>>8&255,a[l++]=255&o;return 2===i?(o=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,a[l++]=255&o):1===i&&(o=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,a[l++]=o>>8&255,a[l++]=255&o),a},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",u=[],s=0,c=n-r;s<c;s+=16383)u.push(i(e,s,s+16383>c?c:s+16383));return 1===r?(t=e[n-1],o+=a[t>>2],o+=a[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=a[t>>10],o+=a[t>>4&63],o+=a[t<<2&63],o+="="),u.push(o),u.join("")};for(var a=[],u=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)a[l]=c[l],u[c.charCodeAt(l)]=l;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){"use strict";function r(e){if(e>K)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=o.prototype,t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return s(e)}return i(e,t,n)}function i(e,t,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return U(e)?f(e,t,n):"string"==typeof e?c(e,t):h(e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n){return a(e),e<=0?r(e):void 0!==t?"string"==typeof n?r(e).fill(t,n):r(e).fill(t):r(e)}function s(e){return a(e),r(e<0?0:0|p(e))}function c(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!o.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(e,t),i=r(n),a=i.write(e,t);return a!==n&&(i=i.slice(0,a)),i}function l(e){for(var t=e.length<0?0:0|p(e.length),n=r(t),o=0;o<t;o+=1)n[o]=255&e[o];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(n||0))throw new RangeError("'length' is out of bounds");var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),r.__proto__=o.prototype,r}function h(e){if(o.isBuffer(e)){var t=0|p(e.length),n=r(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(e){if(W(e)||"length"in e)return"number"!=typeof e.length||q(e.length)?r(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=K)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K.toString(16)+" bytes");return 0|e}function d(e,t){if(o.isBuffer(e))return e.length;if(W(e)||U(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(r)return N(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return S(this,t,n);case"utf8":case"utf-8":return j(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,q(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,o){function i(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,n/=2}var c;if(o){var l=-1;for(c=n;c<u;c++)if(i(e,c)===i(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*a}else-1!==l&&(c-=c-l),l=-1}else for(n+s>u&&(n=u-s),c=n;c>=0;c--){for(var f=!0,h=0;h<s;h++)if(i(e,c+h)!==i(t,h)){f=!1;break}if(f)return c}return-1}function _(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(q(u))return a;e[n+a]=u}return a}function b(e,t,n,r){return H(N(t,e.length-n),e,n,r)}function w(e,t,n,r){return H(z(t),e,n,r)}function x(e,t,n,r){return w(e,t,n,r)}function k(e,t,n,r){return H(Y(t),e,n,r)}function O(e,t,n,r){return H(G(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?X.fromByteArray(e):X.fromByteArray(e.slice(t,n))}function j(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(o+u<=n){var s,c,l,f;switch(u){case 1:i<128&&(a=i);break;case 2:128==(192&(s=e[o+1]))&&(f=(31&i)<<6|63&s)>127&&(a=f);break;case 3:s=e[o+1],c=e[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(a=f);break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(a=f)}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return E(r)}function E(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Z));return n}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function S(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=B(e[i]);return o}function T(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return t=+t,n>>>=0,o||R(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),V.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,o){return t=+t,n>>>=0,o||R(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),V.write(e,t,n,r,52,8),n+8}function F(e){if((e=e.trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function G(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function Y(e){return X.toByteArray(F(e))}function H(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function U(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function W(e){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}function q(e){return e!==e}var X=e("base64-js"),V=e("ieee754");n.Buffer=o,n.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},n.INSPECT_MAX_BYTES=50;var K=2147483647;n.kMaxLength=K,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(e,t,n){return i(e,t,n)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(e,t,n){return u(e,t,n)},o.allocUnsafe=function(e){return s(e)},o.allocUnsafeSlow=function(e){return s(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},o.byteLength=d,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?j(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var a=i-r,u=n-t,s=Math.min(a,u),c=this.slice(r,i),l=e.slice(t,n),f=0;f<s;++f)if(c[f]!==l[f]){a=c[f],u=l[f];break}return a<u?-1:u<a?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=o.prototype,r},o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},o.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),V.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),V.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),V.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),V.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var u=o.isBuffer(e)?e:new o(e,r),s=u.length;for(a=0;a<n-t;++a)this[a+t]=u[a%s]}return this};var Q=/[^+/0-9A-Za-z-_]/g},{"base64-js":2,ieee754:4}],4:[function(e,t,n){n.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,c=s>>1,l=-7,f=n?o-1:0,h=n?-1:1,p=e[t+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=u;l>0;i=256*i+e[t+f],f+=h,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=c}return(p?-1:1)*a*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var a,u,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(t*s-1)*Math.pow(2,o),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[n+p]=255&u,p+=d,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;e[n+p]=255&a,p+=d,a/=256,c-=8);e[n+p-d]|=128*y}},{}],5:[function(e,t,n){var r=e("./_getNative")(e("./_root"),"DataView");t.exports=r},{"./_getNative":56,"./_root":93}],6:[function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=e("./_hashClear"),i=e("./_hashDelete"),a=e("./_hashGet"),u=e("./_hashHas"),s=e("./_hashSet");r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},{"./_hashClear":62,"./_hashDelete":63,"./_hashGet":64,"./_hashHas":65,"./_hashSet":66}],7:[function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=e("./_listCacheClear"),i=e("./_listCacheDelete"),a=e("./_listCacheGet"),u=e("./_listCacheHas"),s=e("./_listCacheSet");r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},{"./_listCacheClear":72,"./_listCacheDelete":73,"./_listCacheGet":74,"./_listCacheHas":75,"./_listCacheSet":76}],8:[function(e,t,n){var r=e("./_getNative")(e("./_root"),"Map");t.exports=r},{"./_getNative":56,"./_root":93}],9:[function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=e("./_mapCacheClear"),i=e("./_mapCacheDelete"),a=e("./_mapCacheGet"),u=e("./_mapCacheHas"),s=e("./_mapCacheSet");r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,t.exports=r},{"./_mapCacheClear":77,"./_mapCacheDelete":78,"./_mapCacheGet":79,"./_mapCacheHas":80,"./_mapCacheSet":81}],10:[function(e,t,n){var r=e("./_getNative")(e("./_root"),"Promise");t.exports=r},{"./_getNative":56,"./_root":93}],11:[function(e,t,n){var r=e("./_getNative")(e("./_root"),"Set");t.exports=r},{"./_getNative":56,"./_root":93}],12:[function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o;++t<n;)this.add(e[t])}var o=e("./_MapCache"),i=e("./_setCacheAdd"),a=e("./_setCacheHas");r.prototype.add=r.prototype.push=i,r.prototype.has=a,t.exports=r},{"./_MapCache":9,"./_setCacheAdd":94,"./_setCacheHas":95}],13:[function(e,t,n){function r(e){var t=this.__data__=new o(e);this.size=t.size}var o=e("./_ListCache"),i=e("./_stackClear"),a=e("./_stackDelete"),u=e("./_stackGet"),s=e("./_stackHas"),c=e("./_stackSet");r.prototype.clear=i,r.prototype.delete=a,r.prototype.get=u,r.prototype.has=s,r.prototype.set=c,t.exports=r},{"./_ListCache":7,"./_stackClear":99,"./_stackDelete":100,"./_stackGet":101,"./_stackHas":102,"./_stackSet":103}],14:[function(e,t,n){var r=e("./_root").Symbol;t.exports=r},{"./_root":93}],15:[function(e,t,n){var r=e("./_root").Uint8Array;t.exports=r},{"./_root":93}],16:[function(e,t,n){var r=e("./_getNative")(e("./_root"),"WeakMap");t.exports=r},{"./_getNative":56,"./_root":93}],17:[function(e,t,n){t.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},{}],18:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},{}],19:[function(e,t,n){var r=e("./_baseTimes"),o=e("./isArguments"),i=e("./isArray"),a=e("./isBuffer"),u=e("./_isIndex"),s=e("./isTypedArray"),c=Object.prototype.hasOwnProperty;t.exports=function(e,t){var n=i(e),l=!n&&o(e),f=!n&&!l&&a(e),h=!n&&!l&&!f&&s(e),p=n||l||f||h,d=p?r(e.length,String):[],y=d.length;for(var v in e)!t&&!c.call(e,v)||p&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||u(v,y))||d.push(v);return d}},{"./_baseTimes":38,"./_isIndex":67,"./isArguments":113,"./isArray":114,"./isBuffer":116,"./isTypedArray":126}],20:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},{}],21:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},{}],22:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},{}],23:[function(e,t,n){var r=e("./_baseAssignValue"),o=e("./eq"),i=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){var a=e[t];i.call(e,t)&&o(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},{"./_baseAssignValue":25,"./eq":110}],24:[function(e,t,n){var r=e("./eq");t.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},{"./eq":110}],25:[function(e,t,n){var r=e("./_defineProperty");t.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},{"./_defineProperty":47}],26:[function(e,t,n){var r=e("./_arrayPush"),o=e("./isArray");t.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},{"./_arrayPush":21,"./isArray":114}],27:[function(e,t,n){var r=e("./_Symbol"),o=e("./_getRawTag"),i=e("./_objectToString"),a="[object Null]",u="[object Undefined]",s=r?r.toStringTag:void 0;t.exports=function(e){return null==e?void 0===e?u:a:s&&s in Object(e)?o(e):i(e)}},{"./_Symbol":14,"./_getRawTag":58,"./_objectToString":87}],28:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./isObjectLike"),i="[object Arguments]";t.exports=function(e){return o(e)&&r(e)==i}},{"./_baseGetTag":27,"./isObjectLike":123}],29:[function(e,t,n){function r(e,t,n,a,u){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!==e&&t!==t:o(e,t,n,a,r,u))}var o=e("./_baseIsEqualDeep"),i=e("./isObjectLike");t.exports=r},{"./_baseIsEqualDeep":30,"./isObjectLike":123}],30:[function(e,t,n){var r=e("./_Stack"),o=e("./_equalArrays"),i=e("./_equalByTag"),a=e("./_equalObjects"),u=e("./_getTag"),s=e("./isArray"),c=e("./isBuffer"),l=e("./isTypedArray"),f=1,h="[object Arguments]",p="[object Array]",d="[object Object]",y=Object.prototype.hasOwnProperty;t.exports=function(e,t,n,v,g,m){var _=s(e),b=s(t),w=_?p:u(e),x=b?p:u(t),k=(w=w==h?d:w)==d,O=(x=x==h?d:x)==d,P=w==x;if(P&&c(e)){if(!c(t))return!1;_=!0,k=!1}if(P&&!k)return m||(m=new r),_||l(e)?o(e,t,n,v,g,m):i(e,t,w,n,v,g,m);if(!(n&f)){var j=k&&y.call(e,"__wrapped__"),E=O&&y.call(t,"__wrapped__");if(j||E){var M=j?e.value():e,A=E?t.value():t;return m||(m=new r),g(M,A,n,v,m)}}return!!P&&(m||(m=new r),a(e,t,n,v,g,m))}},{"./_Stack":13,"./_equalArrays":48,"./_equalByTag":49,"./_equalObjects":50,"./_getTag":60,"./isArray":114,"./isBuffer":116,"./isTypedArray":126}],31:[function(e,t,n){var r=e("./isFunction"),o=e("./_isMasked"),i=e("./isObject"),a=e("./_toSource"),u=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:u).test(a(e))}},{"./_isMasked":70,"./_toSource":104,"./isFunction":120,"./isObject":122}],32:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./isLength"),i=e("./isObjectLike"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},{"./_baseGetTag":27,"./isLength":121,"./isObjectLike":123}],33:[function(e,t,n){var r=e("./_isPrototype"),o=e("./_nativeKeys"),i=Object.prototype.hasOwnProperty;t.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},{"./_isPrototype":71,"./_nativeKeys":84}],34:[function(e,t,n){var r=e("./isObject"),o=e("./_isPrototype"),i=e("./_nativeKeysIn"),a=Object.prototype.hasOwnProperty;t.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var u in e)("constructor"!=u||!t&&a.call(e,u))&&n.push(u);return n}},{"./_isPrototype":71,"./_nativeKeysIn":85,"./isObject":122}],35:[function(e,t,n){t.exports=function(e){return function(t){return null==e?void 0:e[t]}}},{}],36:[function(e,t,n){var r=e("./identity"),o=e("./_overRest"),i=e("./_setToString");t.exports=function(e,t){return i(o(e,t,r),e+"")}},{"./_overRest":89,"./_setToString":97,"./identity":112}],37:[function(e,t,n){var r=e("./constant"),o=e("./_defineProperty"),i=e("./identity"),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;t.exports=a},{"./_defineProperty":47,"./constant":108,"./identity":112}],38:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},{}],39:[function(e,t,n){function r(e){if("string"==typeof e)return e;if(a(e))return i(e,r)+"";if(u(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}var o=e("./_Symbol"),i=e("./_arrayMap"),a=e("./isArray"),u=e("./isSymbol"),s=1/0,c=o?o.prototype:void 0,l=c?c.toString:void 0;t.exports=r},{"./_Symbol":14,"./_arrayMap":20,"./isArray":114,"./isSymbol":125}],40:[function(e,t,n){t.exports=function(e){return function(t){return e(t)}}},{}],41:[function(e,t,n){var r=e("./_arrayMap");t.exports=function(e,t){return r(t,function(t){return e[t]})}},{"./_arrayMap":20}],42:[function(e,t,n){t.exports=function(e,t){return e.has(t)}},{}],43:[function(e,t,n){var r=e("./_assignValue"),o=e("./_baseAssignValue");t.exports=function(e,t,n,i){var a=!n;n||(n={});for(var u=-1,s=t.length;++u<s;){var c=t[u],l=i?i(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),a?o(n,c,l):r(n,c,l)}return n}},{"./_assignValue":23,"./_baseAssignValue":25}],44:[function(e,t,n){var r=e("./_root")["__core-js_shared__"];t.exports=r},{"./_root":93}],45:[function(e,t,n){var r=e("./_baseRest"),o=e("./_isIterateeCall");t.exports=function(e){return r(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,u&&o(n[0],n[1],u)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}},{"./_baseRest":36,"./_isIterateeCall":68}],46:[function(e,t,n){var r=e("./eq"),o=Object.prototype,i=o.hasOwnProperty;t.exports=function(e,t,n,a){return void 0===e||r(e,o[n])&&!i.call(a,n)?t:e}},{"./eq":110}],47:[function(e,t,n){var r=e("./_getNative"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.exports=o},{"./_getNative":56}],48:[function(e,t,n){var r=e("./_SetCache"),o=e("./_arraySome"),i=e("./_cacheHas"),a=1,u=2;t.exports=function(e,t,n,s,c,l){var f=n&a,h=e.length,p=t.length;if(h!=p&&!(f&&p>h))return!1;var d=l.get(e);if(d&&l.get(t))return d==t;var y=-1,v=!0,g=n&u?new r:void 0;for(l.set(e,t),l.set(t,e);++y<h;){var m=e[y],_=t[y];if(s)var b=f?s(_,m,y,t,e,l):s(m,_,y,e,t,l);if(void 0!==b){if(b)continue;v=!1;break}if(g){if(!o(t,function(e,t){if(!i(g,t)&&(m===e||c(m,e,n,s,l)))return g.push(t)})){v=!1;break}}else if(m!==_&&!c(m,_,n,s,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},{"./_SetCache":12,"./_arraySome":22,"./_cacheHas":42}],49:[function(e,t,n){var r=e("./_Symbol"),o=e("./_Uint8Array"),i=e("./eq"),a=e("./_equalArrays"),u=e("./_mapToArray"),s=e("./_setToArray"),c=1,l=2,f="[object Boolean]",h="[object Date]",p="[object Error]",d="[object Map]",y="[object Number]",v="[object RegExp]",g="[object Set]",m="[object String]",_="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",x=r?r.prototype:void 0,k=x?x.valueOf:void 0;t.exports=function(e,t,n,r,x,O,P){switch(n){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case b:return!(e.byteLength!=t.byteLength||!O(new o(e),new o(t)));case f:case h:case y:return i(+e,+t);case p:return e.name==t.name&&e.message==t.message;case v:case m:return e==t+"";case d:var j=u;case g:var E=r&c;if(j||(j=s),e.size!=t.size&&!E)return!1;var M=P.get(e);if(M)return M==t;r|=l,P.set(e,t);var A=a(j(e),j(t),r,x,O,P);return P.delete(e),A;case _:if(k)return k.call(e)==k.call(t)}return!1}},{"./_Symbol":14,"./_Uint8Array":15,"./_equalArrays":48,"./_mapToArray":82,"./_setToArray":96,"./eq":110}],50:[function(e,t,n){var r=e("./_getAllKeys"),o=1,i=Object.prototype.hasOwnProperty;t.exports=function(e,t,n,a,u,s){var c=n&o,l=r(e),f=l.length;if(f!=r(t).length&&!c)return!1;for(var h=f;h--;){var p=l[h];if(!(c?p in t:i.call(t,p)))return!1}var d=s.get(e);if(d&&s.get(t))return d==t;var y=!0;s.set(e,t),s.set(t,e);for(var v=c;++h<f;){var g=e[p=l[h]],m=t[p];if(a)var _=c?a(m,g,p,t,e,s):a(g,m,p,e,t,s);if(!(void 0===_?g===m||u(g,m,n,a,s):_)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(y=!1)}return s.delete(e),s.delete(t),y}},{"./_getAllKeys":54}],51:[function(e,t,n){var r=e("./_basePropertyOf")({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});t.exports=r},{"./_basePropertyOf":35}],52:[function(e,t,n){var r={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};t.exports=function(e){return"\\"+r[e]}},{}],53:[function(e,t,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],54:[function(e,t,n){var r=e("./_baseGetAllKeys"),o=e("./_getSymbols"),i=e("./keys");t.exports=function(e){return r(e,i,o)}},{"./_baseGetAllKeys":26,"./_getSymbols":59,"./keys":127}],55:[function(e,t,n){var r=e("./_isKeyable");t.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},{"./_isKeyable":69}],56:[function(e,t,n){var r=e("./_baseIsNative"),o=e("./_getValue");t.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},{"./_baseIsNative":31,"./_getValue":61}],57:[function(e,t,n){var r=e("./_overArg")(Object.getPrototypeOf,Object);t.exports=r},{"./_overArg":88}],58:[function(e,t,n){var r=e("./_Symbol"),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=r?r.toStringTag:void 0;t.exports=function(e){var t=i.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[u]=n:delete e[u]),o}},{"./_Symbol":14}],59:[function(e,t,n){var r=e("./_arrayFilter"),o=e("./stubArray"),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,u=a?function(e){return null==e?[]:(e=Object(e),r(a(e),function(t){return i.call(e,t)}))}:o;t.exports=u},{"./_arrayFilter":18,"./stubArray":131}],60:[function(e,t,n){var r=e("./_DataView"),o=e("./_Map"),i=e("./_Promise"),a=e("./_Set"),u=e("./_WeakMap"),s=e("./_baseGetTag"),c=e("./_toSource"),l=c(r),f=c(o),h=c(i),p=c(a),d=c(u),y=s;(r&&"[object DataView]"!=y(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=y(new o)||i&&"[object Promise]"!=y(i.resolve())||a&&"[object Set]"!=y(new a)||u&&"[object WeakMap]"!=y(new u))&&(y=function(e){var t=s(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case d:return"[object WeakMap]"}return t}),t.exports=y},{"./_DataView":5,"./_Map":8,"./_Promise":10,"./_Set":11,"./_WeakMap":16,"./_baseGetTag":27,"./_toSource":104}],61:[function(e,t,n){t.exports=function(e,t){return null==e?void 0:e[t]}},{}],62:[function(e,t,n){var r=e("./_nativeCreate");t.exports=function(){this.__data__=r?r(null):{},this.size=0}},{"./_nativeCreate":83}],63:[function(e,t,n){t.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},{}],64:[function(e,t,n){var r=e("./_nativeCreate"),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===o?void 0:n}return i.call(t,e)?t[e]:void 0}},{"./_nativeCreate":83}],65:[function(e,t,n){var r=e("./_nativeCreate"),o=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},{"./_nativeCreate":83}],66:[function(e,t,n){var r=e("./_nativeCreate"),o="__lodash_hash_undefined__";t.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?o:t,this}},{"./_nativeCreate":83}],67:[function(e,t,n){var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.exports=function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}},{}],68:[function(e,t,n){var r=e("./eq"),o=e("./isArrayLike"),i=e("./_isIndex"),a=e("./isObject");t.exports=function(e,t,n){if(!a(n))return!1;var u=typeof t;return!!("number"==u?o(n)&&i(t,n.length):"string"==u&&t in n)&&r(n[t],e)}},{"./_isIndex":67,"./eq":110,"./isArrayLike":115,"./isObject":122}],69:[function(e,t,n){t.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},{}],70:[function(e,t,n){var r=e("./_coreJsData"),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();t.exports=function(e){return!!o&&o in e}},{"./_coreJsData":44}],71:[function(e,t,n){var r=Object.prototype;t.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},{}],72:[function(e,t,n){t.exports=function(){this.__data__=[],this.size=0}},{}],73:[function(e,t,n){var r=e("./_assocIndexOf"),o=Array.prototype.splice;t.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},{"./_assocIndexOf":24}],74:[function(e,t,n){var r=e("./_assocIndexOf");t.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},{"./_assocIndexOf":24}],75:[function(e,t,n){var r=e("./_assocIndexOf");t.exports=function(e){return r(this.__data__,e)>-1}},{"./_assocIndexOf":24}],76:[function(e,t,n){var r=e("./_assocIndexOf");t.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},{"./_assocIndexOf":24}],77:[function(e,t,n){var r=e("./_Hash"),o=e("./_ListCache"),i=e("./_Map");t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},{"./_Hash":6,"./_ListCache":7,"./_Map":8}],78:[function(e,t,n){var r=e("./_getMapData");t.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},{"./_getMapData":55}],79:[function(e,t,n){var r=e("./_getMapData");t.exports=function(e){return r(this,e).get(e)}},{"./_getMapData":55}],80:[function(e,t,n){var r=e("./_getMapData");t.exports=function(e){return r(this,e).has(e)}},{"./_getMapData":55}],81:[function(e,t,n){var r=e("./_getMapData");t.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},{"./_getMapData":55}],82:[function(e,t,n){t.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},{}],83:[function(e,t,n){var r=e("./_getNative")(Object,"create");t.exports=r},{"./_getNative":56}],84:[function(e,t,n){var r=e("./_overArg")(Object.keys,Object);t.exports=r},{"./_overArg":88}],85:[function(e,t,n){t.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},{}],86:[function(e,t,n){var r=e("./_freeGlobal"),o="object"==typeof n&&n&&!n.nodeType&&n,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o&&r.process,u=function(){try{return a&&a.binding&&a.binding("util")}catch(e){}}();t.exports=u},{"./_freeGlobal":53}],87:[function(e,t,n){var r=Object.prototype.toString;t.exports=function(e){return r.call(e)}},{}],88:[function(e,t,n){t.exports=function(e,t){return function(n){return e(t(n))}}},{}],89:[function(e,t,n){var r=e("./_apply"),o=Math.max;t.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,u=o(i.length-t,0),s=Array(u);++a<u;)s[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=n(s),r(e,this,c)}}},{"./_apply":17}],90:[function(e,t,n){t.exports=/<%-([\s\S]+?)%>/g},{}],91:[function(e,t,n){t.exports=/<%([\s\S]+?)%>/g},{}],92:[function(e,t,n){t.exports=/<%=([\s\S]+?)%>/g},{}],93:[function(e,t,n){var r=e("./_freeGlobal"),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},{"./_freeGlobal":53}],94:[function(e,t,n){var r="__lodash_hash_undefined__";t.exports=function(e){return this.__data__.set(e,r),this}},{}],95:[function(e,t,n){t.exports=function(e){return this.__data__.has(e)}},{}],96:[function(e,t,n){t.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},{}],97:[function(e,t,n){var r=e("./_baseSetToString"),o=e("./_shortOut")(r);t.exports=o},{"./_baseSetToString":37,"./_shortOut":98}],98:[function(e,t,n){var r=800,o=16,i=Date.now;t.exports=function(e){var t=0,n=0;return function(){var a=i(),u=o-(a-n);if(n=a,u>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},{}],99:[function(e,t,n){var r=e("./_ListCache");t.exports=function(){this.__data__=new r,this.size=0}},{"./_ListCache":7}],100:[function(e,t,n){t.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},{}],101:[function(e,t,n){t.exports=function(e){return this.__data__.get(e)}},{}],102:[function(e,t,n){t.exports=function(e){return this.__data__.has(e)}},{}],103:[function(e,t,n){var r=e("./_ListCache"),o=e("./_Map"),i=e("./_MapCache"),a=200;t.exports=function(e,t){var n=this.__data__;if(n instanceof r){var u=n.__data__;if(!o||u.length<a-1)return u.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(u)}return n.set(e,t),this.size=n.size,this}},{"./_ListCache":7,"./_Map":8,"./_MapCache":9}],104:[function(e,t,n){var r=Function.prototype.toString;t.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},{}],105:[function(e,t,n){var r=e("./_copyObject"),o=e("./_createAssigner"),i=e("./keysIn"),a=o(function(e,t,n,o){r(t,i(t),e,o)});t.exports=a},{"./_copyObject":43,"./_createAssigner":45,"./keysIn":128}],106:[function(e,t,n){var r=e("./_apply"),o=e("./_baseRest"),i=e("./isError"),a=o(function(e,t){try{return r(e,void 0,t)}catch(e){return i(e)?e:new Error(e)}});t.exports=a},{"./_apply":17,"./_baseRest":36,"./isError":119}],107:[function(e,t,n){var r=e("./toInteger"),o="Expected a function";t.exports=function(e,t){var n;if("function"!=typeof t)throw new TypeError(o);return e=r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}},{"./toInteger":137}],108:[function(e,t,n){t.exports=function(e){return function(){return e}}},{}],109:[function(e,t,n){var r=e("./isObject"),o=e("./now"),i=e("./toNumber"),a="Expected a function",u=Math.max,s=Math.min;t.exports=function(e,t,n){function c(t){var n=v,r=g;return v=g=void 0,x=t,_=e.apply(r,n)}function l(e){return x=e,b=setTimeout(p,t),k?c(e):_}function f(e){var n=e-x,r=t-(e-w);return O?s(r,m-n):r}function h(e){var n=e-w,r=e-x;return void 0===w||n>=t||n<0||O&&r>=m}function p(){var e=o();if(h(e))return d(e);b=setTimeout(p,f(e))}function d(e){return b=void 0,P&&v?c(e):(v=g=void 0,_)}function y(){var e=o(),n=h(e);if(v=arguments,g=this,w=e,n){if(void 0===b)return l(w);if(O)return b=setTimeout(p,t),c(w)}return void 0===b&&(b=setTimeout(p,t)),_}var v,g,m,_,b,w,x=0,k=!1,O=!1,P=!0;if("function"!=typeof e)throw new TypeError(a);return t=i(t)||0,r(n)&&(k=!!n.leading,m=(O="maxWait"in n)?u(i(n.maxWait)||0,t):m,P="trailing"in n?!!n.trailing:P),y.cancel=function(){void 0!==b&&clearTimeout(b),x=0,v=w=g=b=void 0},y.flush=function(){return void 0===b?_:d(o())},y}},{"./isObject":122,"./now":129,"./toNumber":138}],110:[function(e,t,n){t.exports=function(e,t){return e===t||e!==e&&t!==t}},{}],111:[function(e,t,n){var r=e("./_escapeHtmlChar"),o=e("./toString"),i=/[&<>"']/g,a=RegExp(i.source);t.exports=function(e){return(e=o(e))&&a.test(e)?e.replace(i,r):e}},{"./_escapeHtmlChar":51,"./toString":139}],112:[function(e,t,n){t.exports=function(e){return e}},{}],113:[function(e,t,n){var r=e("./_baseIsArguments"),o=e("./isObjectLike"),i=Object.prototype,a=i.hasOwnProperty,u=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!u.call(e,"callee")};t.exports=s},{"./_baseIsArguments":28,"./isObjectLike":123}],114:[function(e,t,n){var r=Array.isArray;t.exports=r},{}],115:[function(e,t,n){var r=e("./isFunction"),o=e("./isLength");t.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},{"./isFunction":120,"./isLength":121}],116:[function(e,t,n){var r=e("./_root"),o=e("./stubFalse"),i="object"==typeof n&&n&&!n.nodeType&&n,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,u=a&&a.exports===i?r.Buffer:void 0,s=(u?u.isBuffer:void 0)||o;t.exports=s},{"./_root":93,"./stubFalse":132}],117:[function(e,t,n){var r=e("./_baseKeys"),o=e("./_getTag"),i=e("./isArguments"),a=e("./isArray"),u=e("./isArrayLike"),s=e("./isBuffer"),c=e("./_isPrototype"),l=e("./isTypedArray"),f="[object Map]",h="[object Set]",p=Object.prototype.hasOwnProperty;t.exports=function(e){if(null==e)return!0;if(u(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||l(e)||i(e)))return!e.length;var t=o(e);if(t==f||t==h)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(p.call(e,n))return!1;return!0}},{"./_baseKeys":33,"./_getTag":60,"./_isPrototype":71,"./isArguments":113,"./isArray":114,"./isArrayLike":115,"./isBuffer":116,"./isTypedArray":126}],118:[function(e,t,n){var r=e("./_baseIsEqual");t.exports=function(e,t){return r(e,t)}},{"./_baseIsEqual":29}],119:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./isObjectLike"),i=e("./isPlainObject"),a="[object DOMException]",u="[object Error]";t.exports=function(e){if(!o(e))return!1;var t=r(e);return t==u||t==a||"string"==typeof e.message&&"string"==typeof e.name&&!i(e)}},{"./_baseGetTag":27,"./isObjectLike":123,"./isPlainObject":124}],120:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./isObject"),i="[object AsyncFunction]",a="[object Function]",u="[object GeneratorFunction]",s="[object Proxy]";t.exports=function(e){if(!o(e))return!1;var t=r(e);return t==a||t==u||t==i||t==s}},{"./_baseGetTag":27,"./isObject":122}],121:[function(e,t,n){var r=9007199254740991;t.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},{}],122:[function(e,t,n){t.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},{}],123:[function(e,t,n){t.exports=function(e){return null!=e&&"object"==typeof e}},{}],124:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./_getPrototype"),i=e("./isObjectLike"),a="[object Object]",u=Function.prototype,s=Object.prototype,c=u.toString,l=s.hasOwnProperty,f=c.call(Object);t.exports=function(e){if(!i(e)||r(e)!=a)return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==f}},{"./_baseGetTag":27,"./_getPrototype":57,"./isObjectLike":123}],125:[function(e,t,n){var r=e("./_baseGetTag"),o=e("./isObjectLike"),i="[object Symbol]";t.exports=function(e){return"symbol"==typeof e||o(e)&&r(e)==i}},{"./_baseGetTag":27,"./isObjectLike":123}],126:[function(e,t,n){var r=e("./_baseIsTypedArray"),o=e("./_baseUnary"),i=e("./_nodeUtil"),a=i&&i.isTypedArray,u=a?o(a):r;t.exports=u},{"./_baseIsTypedArray":32,"./_baseUnary":40,"./_nodeUtil":86}],127:[function(e,t,n){var r=e("./_arrayLikeKeys"),o=e("./_baseKeys"),i=e("./isArrayLike");t.exports=function(e){return i(e)?r(e):o(e)}},{"./_arrayLikeKeys":19,"./_baseKeys":33,"./isArrayLike":115}],128:[function(e,t,n){var r=e("./_arrayLikeKeys"),o=e("./_baseKeysIn"),i=e("./isArrayLike");t.exports=function(e){return i(e)?r(e,!0):o(e)}},{"./_arrayLikeKeys":19,"./_baseKeysIn":34,"./isArrayLike":115}],129:[function(e,t,n){var r=e("./_root");t.exports=function(){return r.Date.now()}},{"./_root":93}],130:[function(e,t,n){var r=e("./before");t.exports=function(e){return r(2,e)}},{"./before":107}],131:[function(e,t,n){t.exports=function(){return[]}},{}],132:[function(e,t,n){t.exports=function(){return!1}},{}],133:[function(e,t,n){var r=e("./assignInWith"),o=e("./attempt"),i=e("./_baseValues"),a=e("./_customDefaultsAssignIn"),u=e("./_escapeStringChar"),s=e("./isError"),c=e("./_isIterateeCall"),l=e("./keys"),f=e("./_reInterpolate"),h=e("./templateSettings"),p=e("./toString"),d=/\b__p \+= '';/g,y=/\b(__p \+=) '' \+/g,v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,g=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/($^)/,_=/['\n\r\u2028\u2029\\]/g;t.exports=function(e,t,n){var b=h.imports._.templateSettings||h;n&&c(e,t,n)&&(t=void 0),e=p(e),t=r({},t,b,a);var w,x,k=r({},t.imports,b.imports,a),O=l(k),P=i(k,O),j=0,E=t.interpolate||m,M="__p += '",A=RegExp((t.escape||m).source+"|"+E.source+"|"+(E===f?g:m).source+"|"+(t.evaluate||m).source+"|$","g"),S="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(A,function(t,n,r,o,i,a){return r||(r=o),M+=e.slice(j,a).replace(_,u),n&&(w=!0,M+="' +\n__e("+n+") +\n'"),i&&(x=!0,M+="';\n"+i+";\n__p += '"),r&&(M+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),j=a+t.length,t}),M+="';\n";var T=t.variable;T||(M="with (obj) {\n"+M+"\n}\n"),M=(x?M.replace(d,""):M).replace(y,"$1").replace(v,"$1;"),M="function("+(T||"obj")+") {\n"+(T?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(w?", __e = _.escape":"")+(x?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+M+"return __p\n}";var C=o(function(){return Function(O,S+"return "+M).apply(void 0,P)});if(C.source=M,s(C))throw C;return C}},{"./_baseValues":41,"./_customDefaultsAssignIn":46,"./_escapeStringChar":52,"./_isIterateeCall":68,"./_reInterpolate":92,"./assignInWith":105,"./attempt":106,"./isError":119,"./keys":127,"./templateSettings":134,"./toString":139}],134:[function(e,t,n){var r=e("./escape"),o={escape:e("./_reEscape"),evaluate:e("./_reEvaluate"),interpolate:e("./_reInterpolate"),variable:"",imports:{_:{escape:r}}};t.exports=o},{"./_reEscape":90,"./_reEvaluate":91,"./_reInterpolate":92,"./escape":111}],135:[function(e,t,n){var r=e("./debounce"),o=e("./isObject"),i="Expected a function";t.exports=function(e,t,n){var a=!0,u=!0;if("function"!=typeof e)throw new TypeError(i);return o(n)&&(a="leading"in n?!!n.leading:a,u="trailing"in n?!!n.trailing:u),r(e,t,{leading:a,maxWait:t,trailing:u})}},{"./debounce":109,"./isObject":122}],136:[function(e,t,n){var r=e("./toNumber"),o=1/0,i=1.7976931348623157e308;t.exports=function(e){return e?(e=r(e))===o||e===-o?(e<0?-1:1)*i:e===e?e:0:0===e?e:0}},{"./toNumber":138}],137:[function(e,t,n){var r=e("./toFinite");t.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},{"./toFinite":136}],138:[function(e,t,n){var r=e("./isObject"),o=e("./isSymbol"),i=NaN,a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.exports=function(e){if("number"==typeof e)return e;if(o(e))return i;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):u.test(e)?i:+e}},{"./isObject":122,"./isSymbol":125}],139:[function(e,t,n){var r=e("./_baseToString");t.exports=function(e){return null==e?"":r(e)}},{"./_baseToString":39}],140:[function(e,t,n){"use strict";function r(e,t){return function(n){return 1-e(1-n,t)}}function o(e,t){return function(n){return n<.5?e(2*n,t)/2:(2-e(2*(1-n),t))/2}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=e.duration,n=void 0===t?1e3:t,a=(e.delay,e.step),u=e.delta,s=e.ease,c=e.options,l=e.repeat,f=void 0!==l&&l;"string"==typeof u&&(u=i.default[u]),"out"==s?u=r(u,c):"inout"==s&&(u=o(u,c));var h=!1;return{start:function(){var e=this;if(h)return this;h=!0;var t=0;return requestAnimationFrame(function r(){if(h){0==t&&(t=performance.now());var o=(performance.now()-t)/n,i=f?o%1:Math.min(o,1);a(u(i,c)),!(o>=1)||f&&h||(e.stop(),t=0),h&&requestAnimationFrame(r)}}),this},stop:function(){return h=!1,this}}};var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./delta"))},{"./delta":148}],141:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return function(n){return 1-e(1-n,t)}}function i(e,t){return function(n){return n<.5?e(2*n,t)/2:(2-e(2*(1-n),t))/2}}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("../delta")),s=function(){function e(t,n){r(this,e),this.client=t,this.config=n,this._started=!1;var a=this.config,s=a.delta,c=void 0===s?"linear":s,l=a.options,f=a.ease;"string"==typeof c&&(this.delta=u.default[c]),"out"==f?this.delta=o(c,l):"inout"==f&&(this.delta=i(c,l)),this.init()}return a(e,[{key:"dispose",value:function(){this.stop(),delete this.client}},{key:"init",value:function(){}},{key:"start",value:function(){var e=this;if(!this._started){var t=this.config,n=t.duration,r=void 0===n?2e3:n,o=t.delay,i=void 0===o?0:o,a=t.repeat,u=void 0!==a&&a;this._started=!0,setTimeout(function(){var t=0;e._raf=requestAnimationFrame(function n(){if(e._started){0==t&&(t=performance.now(),e.client.touch());var o=(performance.now()-t)/r,i=u?o%1:Math.min(o,1);e.step(e.delta(i)),e.client&&e.client.invalidate(),!(o>=1)||u&&e._started||(e.stop(),t=0),e._started&&(e._raf=requestAnimationFrame(n))}})},i)}}},{key:"stop",value:function(){this._raf&&cancelAnimationFrame(this._raf),this._raf=null,this._started=!1}},{key:"started",get:function(){return this._started},set:function(e){this.started!=!!e&&(e?this.start():this.stop())}}]),e}();n.default=s},{"../delta":148}],142:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./animation")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"step",value:function(e){var t,n=this.config.scale,r=2*((void 0===n?1.3:n)-1);t=e<.5?1+r*e:1+(1-e)*r,this.client.delta("sx",t),this.client.delta("sy",t)}}]),t}();n.default=s},{"./animation":141}],143:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./animation")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"step",value:function(e){var t=this.config,n=t.x,r=void 0===n?0:n,o=t.y,i=void 0===o?0:o;this.client.delta("tx",e*r),this.client.delta("ty",e*i)}}]),t}();n.default=s},{"./animation":141}],144:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./animation")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"step",value:function(e){var t=this.config.rideOn,n=this.client;if(t&&n&&n.root){var r=n.center,o=n.root.findById(t);if(o){var i=o.outline(e),r=n.transcoordS2T(r.x,r.y);o&&(n.delta("tx",i.x-r.x),n.delta("ty",i.y-r.y))}}}}]),t}();n.default=s},{"./animation":141}],145:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./animation")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"step",value:function(e){var t=this.config.theta,n=void 0===t?6.28:t;this.client.delta("theta",e*n)}}]),t}();n.default=s},{"./animation":141}],146:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./animation")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"step",value:function(e){var t=this.config.theta,n=void 0===t?.2617993877991494:t,r=4*n,o=e*r;e<.25?o*=-1:e<.75?o-=2*n:o=r-o,this.client.delta("theta",o)}}]),t}();n.default=s},{"./animation":141}],147:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=c[t.type];return n?new n(e,t):null};var o=r(e("./animations/rotation")),i=r(e("./animations/vibration")),a=r(e("./animations/heartbeat")),u=r(e("./animations/moving")),s=r(e("./animations/outline")),c={rotation:o.default,vibration:i.default,heartbeat:a.default,moving:u.default,outline:s.default}},{"./animations/heartbeat":142,"./animations/moving":143,"./animations/outline":144,"./animations/rotation":145,"./animations/vibration":146}],148:[function(e,t,n){"use strict";function r(e){return e}function o(e){return Math.pow(e,2)}function i(e){return 1-Math.sin(Math.acos(e))}function a(e,t){return Math.pow(e,2)*((t.x+1)*e-t.x)}function u(e){for(var t=0,n=1;1;t+=n,n/=2)if(e>=(7-4*t)/11)return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(n,2)}function s(e,t){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t.x/3*e)}Object.defineProperty(n,"__esModule",{value:!0}),n.linear=r,n.quad=o,n.circ=i,n.back=a,n.bounce=u,n.elastic=s,n.default={linear:r,quad:o,circ:i,back:a,bounce:u,elastic:s}},{}],149:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./compile");Object.defineProperty(n,"compile",{enumerable:!0,get:function(){return r(o).default}})},{"./compile":147}],150:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./command")),s=(e("../core/utils"),function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"execute",value:function(){this.params.changes.forEach(function(e){return e.component.set(e.after)})}}],[{key:"before",value:function(e){return e.map(function(e){return{component:e}})}},{key:"after",value:function(e,t){t.execute(null,!1)}},{key:"around",value:function(e,t,n,r){n.call(r),t.execute(null,!1)}}]),t}());n.default=s},{"../core/utils":216,"./command":152}],151:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){if(e.isRootModel())return e.bounds;var t=e.bounds,n=e.rotatePoint,r=n;return r=e.transcoordS2T(r.x,r.y),{left:r.x-(n.x-t.left),top:r.y-(n.y-t.top),width:t.width,height:t.height}}function s(e,t){if(t.isRootModel())return e.bounds;var n=e.bounds,r=e.rotatePoint,o=t.transcoordT2S(r.x,r.y),i=t.bounds;return{left:o.x-(r.x-n.left)-i.left,top:o.y-(r.y-n.top)-i.top,width:n.width,height:n.height}}function c(e){for(var t=0;e&&!e.isRootModel();)t+=e.get("rotation")||0,e=e.parent;return t%(2*Math.PI)}function l(e,t){return((e.get("rotation")||0)-c(t))%(2*Math.PI)}Object.defineProperty(n,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=(r(e("../components/component")),r(e("./command"))),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,h.default),f(t,[{key:"execute",value:function(){this.params.changes.forEach(function(e){var t=e.component,n=e.to_container,r=e.to_index,o=e.to_left,i=e.to_top,a=(e.hint,u(t)),f=c(t);if(t.removeSelf(!n),t.bounds=a,t.set("rotation",f),n){t.set("rotation",l(t,n));var h=s(t,n);e.to_left=void 0!==o?o:h.left,e.to_top=void 0!==i?i:h.top,t.bounds={left:e.to_left,top:e.to_top,width:h.width,height:h.height},void 0===r?n.addComponent(t):n.insertComponentAt(t,r)}})}}]),t}();n.default=p},{"../components/component":155,"./command":152}],152:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.params=Object.assign({},t)}return o(e,[{key:"excute",value:function(){}}]),e}();n.default=i},{}],153:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var n=t.model_layer.get("scale"),r=t.model_layer.get("translate");if(e){var o=JSON.parse(e);o.scale=n,o.translate=r,t.rebuildContentModel(o)}}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../core")),s=r(e("../core/timecapsule")),c=r(e("../core/snapshot-taker")),l=function(){function e(t){o(this,e),this.container=t,this.timecapsule=new s.default(20);var n=this;this.snapshot_taker=new c.default({get state(){var e=n.container.model_layer.hierarchy;return JSON.stringify(e)}},this.timecapsule),this.snapshot_taker.take(!0)}return a(e,[{key:"dispose",value:function(){this.reset(),this.timecapsule.dispose(),this.snapshot_taker.dispose(),delete this.container,delete this.timecapsule,delete this.snapshot_taker}},{key:"execute",value:function(e,t){!1!==t&&e&&e.execute(),this.snapshot_taker.touch(),this.trigger("execute",e,!0,!1)}},{key:"undo",value:function(){this.timecapsule.backwardable&&(i(this.timecapsule.backward(),this.container),this.trigger("undo",this.undoable(),this.redoable()))}},{key:"redo",value:function(){this.timecapsule.forwardable&&(i(this.timecapsule.forward(),this.container),this.trigger("redo",this.undoable(),this.redoable()))}},{key:"undoable",value:function(){return this.timecapsule.backwardable}},{key:"redoable",value:function(){return this.timecapsule.forwardable}},{key:"reset",value:function(){this.timecapsule.reset(),this.trigger("command-reset")}}]),e}();n.default=l,u.mixin(l.prototype,u.event.withEvent)},{"../core":206,"../core/snapshot-taker":213,"../core/timecapsule":215}],154:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.createCanvas=void 0;"undefined"==typeof document?n.createCanvas=function(e,t){return new Canvas(e,t)}:n.createCanvas=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}},{}],155:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=o(e("lodash/isEqual")),c=r(e("../model/selector")),l=r(e("../core")),f=r(e("../animation")),h=o(e("../effect")),p=r(e("../core/utils")),d=e("../core/logger"),y=r(e("../core/memoize")),v=o(e("../animation/animate")),g=e("../effect/shadow"),m=o(e("./geometry/union")),_=e("./canvas/canvas"),b=e("./drawer/fill"),w=o(e("./outline/path-outline")),x=o(e("./drawer/stroke")),k=o(e("./drawer/effect")),O=o(e("./drawer/format")),P=e("./drawer/text"),j=o(e("./mutater/path")),E=o(e("./mutater/bounds")),M=o(e("./text/substitutor")),A=e("./data/data"),S=e("./geometry/transcoord"),T=o(e("./html/reposition")),C=o(e("./retention/retention-manager")),I={},R={mutable:!1,resizable:!0,rotatable:!0,properties:[]},L=[],D={theta:0,tx:0,ty:0,sx:1,sy:1},F=new WeakMap,B=0,N=function(){function e(t,n){a(this,e),this._app=n,this._model=t||{},this._delta=p.clone(D),n&&this.animation&&(this.animation.started=!0),this.clearCache(),C.default.add(this),F.set(this,B++)}return u(e,null,[{key:"register",value:function(e,t){if(!t)return I[e];I[e]=t}},{key:"residents",get:function(){return F}}]),u(e,[{key:"created",value:function(){}},{key:"added",value:function(e){}},{key:"removed",value:function(e){}},{key:"ready",value:function(){}},{key:"touch",value:function(){this.updatedAt=performance.now()}},{key:"clearCache",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];y.clear.apply(y,[this].concat(t))}},{key:"removeSelf",value:function(e){e?this.dispose():this.parent&&this.parent.removeComponent(this)}},{key:"dispose",value:function(){this._animation&&(this._animation.dispose(),delete this._animation),this.disposeMappings(),this.parent&&this.parent.removeComponent(this),delete this._text_substitutor,delete this._value_substitutor,this._disposed=!0,this.retention&&C.default.touch()}},{key:"isLayer",value:function(){return!1}},{key:"isGroup",value:function(){return!1}},{key:"isContainer",value:function(){return!1}},{key:"isLine",value:function(){return!1}},{key:"isRoot",value:function(){return!1}},{key:"isRootModel",value:function(){return!1}},{key:"is3dish",value:function(){return!1}},{key:"isTemplate",value:function(){return!!this.get("templatePrefix")}},{key:"isHTMLElement",value:function(){return!1}},{key:"get",value:function(e){return this._model[e]}},{key:"set",value:function(e,t){if("string"==typeof e)return this.set(i({},e,t));var n={},r={},o=!1,e=p.clone(e),a=this;return Object.getOwnPropertyNames(e).forEach(function(t){var i=a._model[t],u=e[t];(0,s.default)(i,u)||(r[t]=i,n[t]=u,a._model[t]=u,o=!0)}),o&&(this.clearCache(),n.hasOwnProperty("text")&&delete this._text_substitutor,n.hasOwnProperty("value")&&delete this._value_substitutor,n.hasOwnProperty("retention")&&C.default.add(this),n.hasOwnProperty("fillStyle")&&this.onchangeFill(n,r),n.hasOwnProperty("mappings")&&this.onchangeMappings(n,r),n.hasOwnProperty("data")&&this.onchangeData(n,r),this.onchange&&this.onchange(n,r),this.trigger("change",n,r)),this}},{key:"getContext",value:function(){return this._parent.getContext()}},{key:"outline",value:function(e){return(0,w.default)(this,e||0)}},{key:"contains",value:function(e,t){return!1}},{key:"adjustResize",value:function(e,t,n){if(n){var r=this.bounds,o=r.height/r.width,i=e.width-r.width,a=e.height-r.height;i*o>a?a=i*o:i=a/o;var u=e.left-r.left,s=e.top-r.top;return 0!=u&&0!=s?(s=-a,u=-i):0!=u?u=-i:0!=s&&(s=-a),{left:r.left+u,top:r.top+s,width:r.width+i,height:r.height+a}}return e}},{key:"adjustRotation",value:function(e,t){if(t||this.app.rotateStepForced){var n=this.app.rotateStep;return Math.floor((e+n/2)/n)*n}return e}},{key:"findFirst",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(e.apply(void 0,[this].concat(n)))return this}},{key:"findAll",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"string"==typeof e?c.select(e,this,n[0]||this):"function"==typeof e&&e.apply(void 0,[this].concat(n))?[this]:void 0}},{key:"capture",value:function(e,t){if(!this.capturable)return!1;var n=this.transcoordP2S(e,t);return this.contains(n.x,n.y)?this:void 0}},{key:"prepare",value:function(e,t){e(this)}},{key:"prepareIf",value:function(e){var t=this;e&&this.prepare&&this.prepare(function(e){t.invalidate()},function(e){(0,d.error)(e)})}},{key:"draw",value:function(e){e.save(),this._pre_draw(e),this._draw(e),this._post_draw(e),e.restore()}},{key:"delta",value:function(e,t){if(void 0===t)return e?this._delta[e]:this._delta;this._delta[e]=t}},{key:"_pre_draw",value:function(e){var t=this.rotatePoint,n=this.model,r=n.scale,o=n.rotation,i=n.shadow,a=n.hidden,u=(r&&r.x||1)*this._delta.sx,s=(r&&r.y||1)*this._delta.sy,c=(o||0)+this._delta.theta,l=this._delta,f=l.tx,h=void 0===f?0:f,p=l.ty,d=void 0===p?0:p;(h||d)&&e.translate(h,d),(1!=u||1!=s||c)&&(e.translate(t.x,t.y),1==u&&1==s||e.scale(u,s),c&&e.rotate(c),e.translate(-t.x,-t.y)),i&&(0,g.setShadow)(e,i,this),a&&(e.globalAlpha*=.5)}},{key:"_draw",value:function(e){}},{key:"_post_draw",value:function(e){this.drawText(e)}},{key:"drawText",value:function(e){!this.textHidden&&this.text&&this.hasTextProperty&&(0,P.drawText)(e,this.textBounds,this.textLines(e),this.model)}},{key:"drawStroke",value:function(e){(0,x.default)(e,this.model)}},{key:"drawFill",value:function(e){this.fillStyle&&"transparent"!=this.fillStyle&&((0,b.drawFill)(e,this.bounds,this.center,this.model,this),(0,g.resetShadow)(e))}},{key:"animate",value:function(e){return this._animate&&this._animate.stop(),this._animate=(0,v.default)(e),this._animate}},{key:"move",value:function(e){var t=e.x,n=e.y,r=this.path,o=t,i=n;this.path=r.map(function(e){return{x:e.x+o,y:e.y+i}})}},{key:"symmetryX",value:function(e){"number"!=typeof e&&(e=this.center.x);var t=this.model.rotation,n=this.fillStyle;if(this.set("rotation",2*Math.PI-t),n&&"gradient"===n.type&&"linear"===n.gradientType){var r=p.clone(n);r.rotation=(Math.PI-parseFloat(n.rotation||0))%(2*Math.PI),this.set("fillStyle",r)}this.path=this.path.map(function(t){return{x:2*e-t.x,y:t.y}})}},{key:"symmetryY",value:function(e){this.symmetryX(),this.set("rotation",(Math.PI+this.model.rotation)%(2*Math.PI)),e&&this.move({x:0,y:2*(e-this.center.y)})}},{key:"effect",value:function(e,t){return(0,h.default)(this,e,t)}},{key:"invalidate",value:function(){this.parent&&this.parent.invalidate()}},{key:"defaultTextSubstitutor",value:function(){return String(this.get("text")||"")}},{key:"defaultValueSubstitutor",value:function(){return this.get("value")}},{key:"textLines",value:function(e){return(0,P.textLines)(e||this.getContext(),this.textBounds.width,this.font,this.text,this.get("textWrap"))}},{key:"trim",value:function(){delete this._model[""],"chartjs"!==this._model.type&&delete this._model.chart}},{key:"serialize",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify.apply(JSON,[this.hierarchy].concat(t))}},{key:"nature",get:function(){return R}},{key:"disposed",get:function(){return!!this._disposed}},{key:"retention",get:function(){return Number(this.get("retention"))||0}},{key:"hasTextProperty",get:function(){return!0}},{key:"app",get:function(){return!this._app&&this.parent&&(this._app=this.parent.app),this._app}},{key:"model",get:function(){return this._model}},{key:"hierarchy",get:function(){var e=p.clone(this._model);return this.volatile.forEach(function(t){delete e[t]}),e}},{key:"volatile",get:function(){return L}},{key:"textHidden",get:function(){return!!this._textHidden},set:function(e){this._textHidden=!!e,this.invalidate()}},{key:"root",get:function(){return this.isRoot()?this:this.parent&&this.parent.root}},{key:"rootModel",get:function(){return this.isRootModel()?this:this.parent&&this.parent.rootModel}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"center",get:function(){var e=this.bounds;return{x:e.left+e.width/2,y:e.top+e.height/2}},set:function(e){var t=this.center;if(Math.round(100*e.x)/100!=Math.round(100*t.x)/100||Math.round(100*e.y)/100!=Math.round(100*t.y)/100){var n=e.x-t.x,r=e.y-t.y;this.path=this.path.map(function(e){return{x:e.x+n,y:e.y+r}})}}},{key:"location",get:function(){return this.center},set:function(e){this.center=e}},{key:"dimension",get:function(){return this.get("dimension")},set:function(e){this.set("dimension",e)}},{key:"bounds",get:function(){var e,t,n,r,o=this.path;e=t=o[0].x,n=r=o[0].y;for(var i=1;i<o.length;i++){var a=o[i];a.x<e?e=a.x:a.x>t&&(t=a.x),a.y<n?n=a.y:a.y>r&&(r=a.y)}return{left:e,top:n,width:t-e,height:r-n}},set:function(e){var t=this.bounds;if(Math.round(100*e.width)/100!=Math.round(100*t.width)/100||Math.round(100*e.height)/100!=Math.round(100*t.height)/100||Math.round(100*e.left)/100!=Math.round(100*t.left)/100||Math.round(100*e.top)/100!=Math.round(100*t.top)/100){var n={x:0==t.width?1:e.width/t.width,y:0==t.height?1:e.height/t.height};this.path=this.path.map(function(r){return{x:e.left+(r.x-t.left)*n.x,y:e.top+(r.y-t.top)*n.y}})}}},{key:"path",get:function(){return(0,d.error)("  get path   .",this),[]},set:function(e){(0,d.error)("  get path   .",this)}},{key:"anchors",get:function(){return[]}},{key:"strokeStyle",get:function(){return this.get("strokeStyle")},set:function(e){this.set("strokeStyle",e)}},{key:"fillStyle",get:function(){return this.get("fillStyle")},set:function(e){this.set("fillStyle",e)}},{key:"fontColor",get:function(){return this.get("fontColor")},set:function(e){this.set("fontColor",String(p.objToVal(e)))}},{key:"rotation",get:function(){return this.get("rotation")},set:function(e){this.set("rotation",Number(p.objToVal(e)))}},{key:"mutable",get:function(){return R.mutable}},{key:"resizable",get:function(){return R.resizable&&!this.stuck}},{key:"rotatable",get:function(){return R.rotatable&&!this.stuck}},{key:"capturable",get:function(){return!1!==this.get("capturable")}},{key:"stuck",get:function(){return!!(this.parent&&this.parent.layout.isStuck(this)||this.get("locked"))}},{key:"hidden",get:function(){return this.app.isViewMode&&this.get("hidden")},set:function(e){this.set("hidden",e)}},{key:"animation",get:function(){if(this.app.isViewMode&&!this.isTemplate()){if(!this._animation){var e=this.model.animation;e&&e.oncreate&&(this._animation=f.compile(this,e.oncreate))}return this._animation}}},{key:"started",set:function(e){this.animation&&(this.animation.started=e)}},{key:"font",get:function(){return(0,P.font)(this.model)}},{key:"lineHeight",get:function(){var e=this.get("lineHeight");return e||1.2*this.fontSize}},{key:"textSubstitutor",get:function(){return this._text_substitutor||(this._text_substitutor=(0,M.default)(this.get("text"),this)||this.defaultTextSubstitutor),this._text_substitutor}},{key:"valueSubstitutor",get:function(){return this._value_substitutor||(this._value_substitutor=(0,M.default)(this.get("value"),this)||this.defaultValueSubstitutor),this._value_substitutor}},{key:"text",get:function(){var e=this.get("textFormat");return e?(0,O.default)(e,this.textSubstitutor()):this.textSubstitutor()},set:function(e){delete this._text_substitutor,this.set("text",String(p.objToVal(e)))}},{key:"textBounds",get:function(){var e=this.model,t=e.paddingTop,n=void 0===t?0:t,r=e.paddingLeft,o=void 0===r?0:r,i=e.paddingRight,a=void 0===i?0:i,u=e.paddingBottom,s=void 0===u?0:u,c=this.bounds,l=c.left,f=c.top,h=c.width,p=c.height;return{left:l+o,top:f+n,width:Math.max(h-o-a,0),height:Math.max(p-n-s,0)}}},{key:"rotatePoint",get:function(){return this.center}},{key:"value",get:function(){return this.valueSubstitutor()},set:function(e){delete this._value_substitutor,this.set("value",p.objToVal(e))}},{key:"data",get:function(){return this._model.data},set:function(e){this.set("data",e),this.touch()}},{key:"mappings",get:function(){return!this._mappings&&this.parent&&this.buildMappings(),this._mappings}},{key:"controls",get:function(){}}]),e}();n.default=N,N.union=m.default,N.transcoordR=S.transcoordR,N.transcoordRR=S.transcoordRR,N.createCanvas=_.createCanvas,N.memoize=y.intercept,N.mixin=l.mixin,N.drawText=P.drawText,N.font=P.font,N.textLines=P.textLines,N.drawStroke=x.default,N.drawFill=b.drawFill,N.reposition=T.default,N.RetentionManager=C.default,Object.assign(N.prototype,{drawEffect:k.default,prepareFill:b.prepareFill,prepareFillIf:b.prepareFillIf,onchangeFill:b.onchangeFill,mutateBounds:E.default,mutatePath:j.default,onchangeMappings:A.onchangeMappings,onchangeData:A.onchangeData,buildMappings:A.buildMappings,executeMappings:A.executeMappings,disposeMappings:A.disposeMappings,transcoordS2P:S.transcoordS2P,transcoordP2S:S.transcoordP2S,transcoordS2T:S.transcoordS2T,transcoordT2S:S.transcoordT2S,transcoordS2TR:S.transcoordS2TR,transcoordS2O:S.transcoordS2O,transcoordC2S:S.transcoordC2S,transcoordS2C:S.transcoordS2C}),["rotatePoint","font","lineHeight","retention"].forEach(function(e){return N.memoize(N.prototype,e,!1)}),["bounds","center","textBounds"].forEach(function(e){return N.memoize(N.prototype,e,!0)}),N.mixin(N.prototype,l.event.withEvent)},{"../animation":149,"../animation/animate":140,"../core":206,"../core/logger":208,"../core/memoize":209,"../core/utils":216,"../effect":218,"../effect/shadow":219,"../model/selector":255,"./canvas/canvas":154,"./data/data":158,"./drawer/effect":161,"./drawer/fill":162,"./drawer/format":163,"./drawer/stroke":165,"./drawer/text":167,"./geometry/transcoord":170,"./geometry/union":171,"./html/reposition":176,"./mutater/bounds":186,"./mutater/path":187,"./outline/path-outline":189,"./retention/retention-manager":194,"./text/substitutor":200,"lodash/isEqual":118}],156:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=r(e("./component")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../model/selector")),f=e("../layout"),h=r(e("./mixins/rect-path")),p=[],d=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._components=[],r}return a(t,(0,h.default)(c.default)),u(t,[{key:"dispose",value:function(){this.components.slice().forEach(function(e){return e.dispose()}),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"isContainer",value:function(){return!0}},{key:"containable",value:function(e){return"variable"!==e.get("type")}},{key:"reflow",value:function(){this.layout.reflow(this),this.components&&this.components.forEach(function(e){e.isContainer()&&e.reflow()})}},{key:"addComponent",value:function(e){var t=e.parent;if(t){if(this===t)return;t.removeComponent(e)}var n=this._components.push(e)-1;e.parent=this,e.added(this),this.trigger("add",this,e,n),e.delegate_on(this),e.trigger("added",this,e,n),this.root&&this.root.isReady&&e.ready()}},{key:"removeComponent",value:function(e){var t=this._components.indexOf(e);-1!=t&&(this._components.splice(t,1),e.parent=null,e.removed(this),this.trigger("remove",this,e),e.trigger("removed",this,e),e.delegate_off(this))}},{key:"insertComponentAt",value:function(e,t){var n=e.parent;n&&n.removeComponent(e);var r=this._components.splice(0,t);this._components=r.concat(e,this._components),t=this._components.indexOf(e),e.parent=this,e.added(this),this.trigger("add",this,e,t),e.delegate_on(this),e.trigger("added",this,e,t)}},{key:"add",value:function(e){var t=this;return e instanceof Array?(e.forEach(function(e){-1==t._components.indexOf(e)&&t.addComponent(e)}),this):this.add.call(this,[e])}},{key:"remove",value:function(e){var t=this;return e instanceof Array?this._components?(e.forEach(function(e){t.removeComponent(e)}),this):this:this.remove.call(this,[e])}},{key:"getAt",value:function(e){if(this._components)return this._components[e]}},{key:"forEach",value:function(e,t){this._components&&this._components.forEach(e,t)}},{key:"traverse",value:function(e,t){e.call(t,this),this._components&&this._components.forEach(function(n){n.isContainer()?n.traverse(e,t):e.call(t,n)})}},{key:"indexOf",value:function(e){return(this._components||p).indexOf(e)}},{key:"size",value:function(){return(this._components||p).length}},{key:"moveChildAt",value:function(e,t){var n=this.indexOf(t);if(-1!=n){var r=this._components.splice(0,n),o=this._components.splice(1);this._components=r.concat(o),e=Math.max(0,e),e=Math.min(e,this._components.length),r=this._components.splice(0,e),this._components=r.concat(t,this._components)}}},{key:"moveChildForward",value:function(e){var t=this.indexOf(e);-1!=t&&t!=this.size()-1&&(this._components[t]=this._components[t+1],this._components[t+1]=e)}},{key:"moveChildBackward",value:function(e){var t=this.indexOf(e);-1!=t&&0!=t&&(this._components[t]=this._components[t-1],this._components[t-1]=e)}},{key:"moveChildToFront",value:function(e){var t=this.indexOf(e);if(-1!=t&&t!=this.size()-1){var n=this._components.splice(0,t),r=this._components.splice(1);this._components=n.concat(r,this._components)}}},{key:"moveChildToBack",value:function(e){var t=this.indexOf(e);if(-1!=t&&0!=t){var n=this._components.splice(0,t),r=this._components.splice(0);this._components=this._components.concat(n,r)}}},{key:"symmetryX",value:function(e){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"symmetryX",this).call(this,e),this.components.map(function(e){e.symmetryX(0)})}},{key:"findAll",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"==typeof e)return l.select(e,this,n[0]||this);if("function"==typeof e){for(var o=[],i=this.components.length-1;i>=0;i--){var a,u=(a=this.components[i]).findAll.apply(a,[e].concat(n));u&&(o=o.concat(u))}return e.apply(void 0,[this].concat(n))&&o.push(this),o}}},{key:"findFirst",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"==typeof e)return l.select(e,this,n[0])[0];if("function"==typeof e){for(var o=this.components.length-1;o>=0;o--){var i,a=(i=this.components[o]).findFirst.apply(i,[e].concat(n));if(null!=a)return a}return e.apply(void 0,[this].concat(n))?this:null}}},{key:"findById",value:function(e){return this.root.findById(e)}},{key:"contains",value:function(e,t){var n=this.model,r=n.left,o=n.top,i=n.width,a=n.height,u=n.lineWidth,s=void 0===u?0:u,c=this.stuck?0:10+s/2;return e<Math.max(r+i,r)+c&&e>Math.min(r+i,r)-c&&t<Math.max(o+a,o)+c&&t>Math.min(o+a,o)-c}},{key:"capture",value:function(e,t){var n=this.transcoordP2S(e,t);if(!this.contains(n.x,n.y))return!1;var r=this.bounds;n.x-=r.left,n.y-=r.top;for(var o=this.layout.capturables(this),i=o.length-1;i>=0;i--){var a=o[i].capture(n.x,n.y);if(a)return a}return this.capturable&&this}},{key:"capturePath",value:function(e,t){if(t){if(t.indexOf(this)>-1)return!1;for(var n=0;n<t.length;n++)if(!this.containable(t[n]))return!1}for(var r=[],o=this.bounds,i=o.left,a=o.top,u=o.width,s=o.height,c=0;c<e.length;c++){var l=this.transcoordP2S(e[c].x,e[c].y);if(l.x<i||l.x>i+u||l.y<a||l.y>a+s)return!1;l.x-=i,l.y-=a,r.push(l)}for(var f=this.layout.capturables(this),h=f.length-1;h>=0;h--){var p=f[h];if(p.isContainer()){var d=p.capturePath(r,t);if(d)return d}}return this.focusible&&this}},{key:"_draw",value:function(e){var t=this.bounds,n=t.left,r=void 0===n?0:n,o=t.top,i=void 0===o?0:o,a=t.width,u=t.height;e.beginPath(),e.rect(r,i,a,u),this.drawFill(e),this.drawStroke(e)}},{key:"_post_draw",value:function(e){var t=this.model,n=t.top,r=t.left;t.scale;e.translate(r,n),this.layout.drawables(this).forEach(function(t){t.draw(e)}),e.translate(-r,-n),this.drawText(e)}},{key:"trim",value:function(){this.components.forEach(function(e){e.trim()}),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trim",this).call(this)}},{key:"hasTextProperty",get:function(){return!1}},{key:"components",get:function(){return this._components}},{key:"focusible",get:function(){return!0}},{key:"layout",get:function(){return f.Layout.get(this.get("layout"))||f.AbsoluteLayout}},{key:"hierarchy",get:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hierarchy",this);return this.components&&(e.components=this.components.map(function(e){return e.hierarchy})),e}}]),t}();n.default=d,["layout"].forEach(function(e){return c.default.memoize(d.prototype,e,!1)}),c.default.register("container",d)},{"../layout":247,"../model/selector":255,"./component":155,"./mixins/rect-path":184}],157:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){switch(e){case"ref":case"fillStyle":case"strokeStyle":return"string";default:return}}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=r(e("./evaluator")),s=r(e("../../core/obj-accessor")),c=function(){function e(t,n){o(this,e),this.owner=n,this.model=t}return a(e,[{key:"dispose",value:function(){delete this._model,delete this.owner,delete this.evaluator,delete this.accessor}},{key:"model",get:function(){return this._model},set:function(e){e.target;var t=e.property,n=e.rule,r=e.param,o=e.accessor;this._model=e,this.evaluator=(0,u.default)(this,this.owner,n,r,i(t)),this.accessor=(0,s.default)(o)}},{key:"target",get:function(){return this.model.target}},{key:"property",get:function(){return this.model.property}},{key:"param",get:function(){return this.model.param}}]),e}();n.default=c},{"../../core/obj-accessor":211,"./evaluator":159}],158:[function(e,t,n){"use strict";function r(){var e=this;this.mappings&&this.mappings.forEach(function(t){try{var n=t.accessor(e.data);if("(root)"==t.target){if((i=Object.keys(n||{}).map(function(t){return e.root.findOrCreate(t)}).filter(function(e){return!!e})).length>0){var r=t.evaluator(n);i.forEach(function(e){return e[t.property]=r[e.get("id")]})}}else{var i=e.root.findAll(t.target,e);if(i.length>0){var a=t.evaluator(n);i.forEach(function(e){return e[t.property]=a})}}}catch(n){(0,o.error)(n,e,t)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.executeMappings=r,n.onchangeData=function(e,t){r.call(this)},n.buildMappings=function(){var e=this;if(this._model.mappings)return!this._model.mappings instanceof Array?((0,o.error)("Mappings model is invalid (should be a Array) ..",this._model.mappings),void(this._mappings=[])):void(this._mappings=(this._model.mappings||[]).map(function(t){return new i.default(t,e)}));this._mappings=[]},n.disposeMappings=function(){this._mappings&&this._mappings.forEach(function(e){return e.dispose()}),delete this._mappings},n.onchangeMappings=function(e,t){this.disposeMappings(),r.call(this)};var o=e("../../core/logger"),i=function(e){return e&&e.__esModule?e:{default:e}}(e("./data-mapping"))},{"../../core/logger":208,"./data-mapping":157}],159:[function(require,module,exports){"use strict";function tostring(e){return String((0,_utils.objToVal)(e)||"")}function tonumber(e){return Number((0,_utils.objToVal)(e))}function value(e){return e}function valueString(e){return tostring(e)}function valueNumber(e){return tonumber(e)}function map(e){if(this.param)return e=tostring(e),this.param.hasOwnProperty(e)?this.param[e]:this.param.default}function range(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",n=this.param;if(n){for(var r in n){var o=r.split("~"),i=_slicedToArray(o,2),a=i[0],u=i[1],s=!!a,c=!!u;if("number"===t?(a=parseFloat(a),u=parseFloat(u),e=tonumber(e)):(a=String(a),u=String(u),e=tostring(e)),s&&!c&&e>=a)return n[r];if(!s&&c&&e<a)return n[r];if(e>=a&&e<u)return n[r]}return n.default}}function radian(e){return tonumber(e)*Math.PI/180}function noop(){}function build(script){var evaluator;try{return eval("evaluator = function(value, type) {"+script+"}"),evaluator}catch(e){return(0,_logger.error)(e),noop}}function buildEvaluator(e,t,n,r,o){switch(n){case"value":return"text"===o||"string"===o?valueString.bind(e):"number"===o?valueNumber.bind(e):value.bind(t);case"map":return map.bind(e);case"range":return range.bind(e);case"radian":return radian.bind(e);case"eval":return build(r).bind(t);default:return value.bind(t)}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=buildEvaluator;var _logger=require("../../core/logger"),_utils=require("../../core/utils")},{"../../core/logger":208,"../../core/utils":216}],160:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./ellipse")),l={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"ratio",name:"ratio",property:"ratio"}]},f={ondragmove:function(e,t,n){n.controls;var r=n.model,o=r.cx,i=r.rx,a=(n.transcoordP2S(e.x,e.y).x-o)/i*100;a=a>=100||a<=-100?100:Math.abs(a),n.set({ratio:a})}},h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"_draw",value:function(e){var t=this.model,n=t.ratio,r=void 0===n?50:n,o=t.cx,i=t.cy,a=t.rx,u=t.ry,s=t.startAngle,c=t.endAngle,l=t.anticlockwise;e.beginPath(),e.ellipse(o,i,Math.abs(a),Math.abs(u),0,s||0,c||2*Math.PI,l),e.moveTo(o+a/100*r,i),e.ellipse(o,i,Math.abs(a/100*r),Math.abs(u/100*r),0,s||0,c||2*Math.PI,!0)}},{key:"contains",value:function(e,t){var n=this.model,r=n.cx,o=n.cy,i=n.rx,a=n.ry,u=n.ratio,s=(e-r)/(2*i-.5),c=(t-o)/(2*a-.5),l=(e-r)/(i/100*u*2-.5),f=(t-o)/(a/100*u*2-.5),h=!1;return s*s+c*c<.25&&l*l+f*f>.25&&(h=!h),h}},{key:"controls",get:function(){var e=this.model,t=e.cx,n=e.cy;return[{x:t+e.rx/100*e.ratio,y:n,handler:f}]}},{key:"nature",get:function(){return l}}]),t}();n.default=h,s.default.memoize(h.prototype,"controls",!1),s.default.register("donut",h)},{"./component":155,"./ellipse":168}],161:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=this;this._model.effects&&this._model.effects.forEach(function(n){t.effect(e,n)})}},{}],162:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.drawFill=function(e,t,n,o,a){var u=o.alpha,s=void 0===u?1:u,c=a.fillStyle;if(e.globalAlpha*=s,c)if("string"==typeof c)e.fillStyle=c,e.fill();else if("object"==(void 0===c?"undefined":r(c)))if("gradient"==c.type){e.translate(n.x,n.y);var l=void 0,f=t.width,h=t.height;if("linear"==c.gradientType){var p=3.141592653589793,d=c.rotation;if(d>=.436332&&d<=1.13446||d>=2.00713&&d<=2.70526||d>=3.57792&&d<=4.27606||d>=5.14872&&d<=5.84685){var y=Math.sqrt(Math.pow((f-4)/2,2)+Math.pow((h-4)/2,2));y-=y-(f+h)/3,l=e.createLinearGradient(y*Math.cos(d+p),y*Math.sin(d+p),y*Math.cos(d),y*Math.sin(d))}else l=e.createLinearGradient((f-4)/2*Math.cos(d+p),(h-4)/2*Math.sin(d+p),(f-4)/2*Math.cos(d),(h-4)/2*Math.sin(d))}else if("radial"==c.gradientType){var v=.95*Math.sqrt(Math.pow((f-4)/2,2)+Math.pow((h-4)/2,2));switch(c.center){case"center":l=e.createRadialGradient(0,0,0,0,0,v);break;case"left-top":l=e.createRadialGradient(-f/2,-h/2,0,-f/2,-h/2,2*v);break;case"right-top":l=e.createRadialGradient(f/2,-h/2,0,f/2,-h/2,2*v);break;case"left-bottom":l=e.createRadialGradient(-f/2,h/2,0,-f/2,h/2,2*v);break;case"right-bottom":l=e.createRadialGradient(f/2,h/2,0,f/2,h/2,2*v);break;default:l=e.createRadialGradient(0,0,0,0,0,v)}}c.colorStops.forEach(function(e){if(e.position>=0&&e.position<=1)try{l.addColorStop(e.position,e.color)}catch(t){(0,i.warn)("Invalid Color for colorstop : ",e.color),l.addColorStop(e.position,"#fff")}}),e.fillStyle=l,e.fill(),e.translate(-n.x,-n.y)}else if("pattern"==c.type&&c.image){if(a.prepareFillIf(!a._pattern_image_origin),!a._pattern_image)return;if(c.fitPattern)return void e.drawImage(a._pattern_image,0,0,a._pattern_image.width,a._pattern_image.height,t.left,t.top,t.width,t.height);var g=c.offsetX||0,m=c.offsetY||0,_=0,b=0;switch(c.align){case"center":_=t.width/2-(c.width?c.width/2:0),b=t.height/2+(c.height?c.height/2:0);break;case"left-top":break;case"left-bottom":b=c.height?t.height%c.height:t.height;break;case"right-top":_=c.width?t.width%c.width:t.width;break;case"right-bottom":_=c.width?t.width%c.width:t.width,b=c.height?t.height%c.height:t.height;break;case"left":b=t.height/2+(c.height?c.height/2:0);break;case"right":_=c.width?t.width%c.width:t.width,b=t.height/2+(c.height?c.height/2:0);break;case"top":_=t.width/2-(c.width?c.width/2:0);break;case"bottom":_=t.width/2-(c.width?c.width/2:0),b=c.height?t.height%c.height:t.height}var w=t.left+g+_,x=t.top+m+b;e.translate(w,x),e.fillStyle=e.createPattern(a._pattern_image,"repeat"),e.fill(),e.translate(-w,-x)}},n.prepareFill=function(e,t){var n=this.fillStyle;if(n&&"pattern"==n.type&&n.image){if("string"!=typeof n.image)return this._pattern_image_origin=this._pattern_image=n.image,void e(this);this._pattern_image=null,this._pattern_image_origin=new Image;var r=this;this._pattern_image_origin.onload=function(){if(n.fitPattern||!n.width&&!n.height)return r._pattern_image=r._pattern_image_origin,void e(this);var t=n.width||this.width,i=n.height||this.height;n.fitPattern&&(t=r.bounds.width,i=r.bounds.height);var a=(0,o.createCanvas)(t,i);a.getContext("2d").drawImage(this,0,0,this.width,this.height,0,0,t,i),r._pattern_image=a,e(this)},this._pattern_image_origin.onerror=function(e){t(e)};try{"data"!==String(n.image).substring(0,4)?this._pattern_image_origin.crossOrigin="use-credentials":this._pattern_image_origin.crossOrigin=null,this._pattern_image_origin.src=this.app.url(n.image)}catch(e){t(e)}}else e(this)},n.prepareFillIf=function(e){var t=this;e&&this.prepareFill(function(e){t.invalidate()},function(e){(0,i.error)(e)})},n.onchangeFill=function(e,t){var n=this.fillStyle;"pattern"===n.type?this.prepareFillIf(n.image):this._pattern_image&&(this._pattern_image=null,this._pattern_image_origin=null)};var o=e("../canvas/canvas"),i=e("../../core/logger")},{"../../core/logger":208,"../canvas/canvas":154}],163:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){if(!e||isNaN(+t))return t;var n,r,o,i,a,u,s,c,l,f=e.length,h=e.search(/[0-9\-\+#]/),p=h>0?e.substring(0,h):"",d=e.split("").reverse().join(""),y=d.search(/[0-9\-\+#]/),v=f-y,g=e.substring(v,v+1),m=v+("."===g||","===g?1:0),_=y>0?e.substring(m,f):"";if(e=e.substring(h,m),t="-"===e.charAt(0)?-t:+t,n=t<0?t=-t:0,r=e.match(/[^\d\-\+#]/g),o=r&&r[1]&&r[0]||",",e=e.split("."),t=t.toFixed(e[1]&&e[1].length),t=+t+"",a=e[1]&&e[1].lastIndexOf("0"),(!(s=t.split("."))[1]||s[1]&&s[1].length<=a)&&(t=(+t).toFixed(a+1)),c=e[0].split(o),e[0]=c.join(""),(i=e[0]&&e[0].indexOf("0"))>-1)for(;s[0].length<e[0].length-i;)s[0]="0"+s[0];else 0==+s[0]&&(s[0]="");if(t=t.split("."),t[0]=s[0],u=c[1]&&c[c.length-1].length){for(d="",v=(l=t[0]).length%u,f=l.length,m=0;m<f;m++)d+=l.charAt(m),!((m-v+1)%u)&&m<f-u&&(d+=o);t[0]=d}t[1]=e[1]&&t[1]?"."+t[1]:"","0"!==(r=t.join(""))&&""!==r||(n=!1);var b;return b="+"==e[0].substring(0,1)?n?"-":"+":n?"-":"",p+(b+r)+_}},{}],164:[function(e,t,n){"use strict";function r(e,t,n,r,o){var i=a+o,u=n.x,s=n.y,c=r.x,l=r.y;if(Math.abs(u-c)>i&&Math.abs(s-l)>i){var f=(l-s)/(c-u),h=s-f*u;if(Math.abs(t-(f*e+h))>i)return!1}var p,d,y,v;return u>c?(d=u,p=c):(d=c,p=u),s>l?(v=s,y=l):(v=l,y=s),!(d+a<e)&&(!(p-a>e)&&(!(v+a<t)&&!(y-a>t)))}function o(e,t,n,r,o,i){var a=t.x,s=t.y,c=Math.atan2(n.y-s,n.x-a);switch(e.beginPath(),e.translate(a,s),e.rotate(c),o){case"oval":e.ellipse(0,0,i.X,i.Y,0,0,2*Math.PI),e.fill();break;case"diamond":e.moveTo(-i.X,0),e.lineTo(0,-i.Y),e.lineTo(i.X,0),e.lineTo(0,i.Y),e.fill();break;case"arrow":e.moveTo(0,0),e.lineTo(u*i.X,-i.Y),e.lineTo(u*i.X,i.Y),e.fill();break;case"sharp-arrow":e.moveTo(0,0),e.lineTo(u*i.X,-i.Y),e.lineTo(-i.X/1.5+u*i.X,0),e.lineTo(u*i.X,i.Y),e.fill();break;case"open-arrow":e.moveTo(u*i.X+r,-i.Y),e.lineTo(r,0),e.lineTo(u*i.X+r,i.Y),e.stroke()}e.rotate(-c),e.translate(-a,-s),e.closePath()}function i(e,t){var n={};switch(t*=1.2,e){case"size1":n.X=t,n.Y=t;break;case"size2":n.X=1.5*t,n.Y=t;break;case"size3":n.X=2*t,n.Y=t;break;case"size4":n.X=t,n.Y=1.5*t;break;case"size5":n.X=1.5*t,n.Y=1.5*t;break;case"size6":n.X=2*t,n.Y=1.5*t;break;case"size7":n.X=t,n.Y=2*t;break;case"size8":n.X=1.5*t,n.Y=2*t;break;case"size9":n.X=2*t,n.Y=2*t;break;default:n.X=1.5*t,n.Y=1.5*t}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.containedInPath=function(e,t,n){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=0;i<n.length-1;i++)if(r(e,t,n[i],n[i+1],o))return!0;return!1},n.getTipNeckPos=function(e,t,n,r){if("arrow"!=e.slice(-5))return n;n.x,n.y;var o=Math.atan2(r.y-n.y,r.x-n.x),i=1.5*t;return{x:n.x+Math.cos(o)*i,y:n.y+Math.sin(o)*i}},n.drawEndTips=function(e,t,n){var r=n.lineWidth,a=void 0===r?s:r,u=n.strokeStyle,c=void 0===u?"#000000":u,l=n.lineCap,f=void 0!==l&&l,h=n.alpha,p=void 0===h?1:h,d=n.begin,y=void 0===d?"none":d,v=n.end,g=void 0===v?"none":v,m=n.beginSize,_=void 0===m?"size5":m,b=n.endSize,w=void 0===b?"size5":b;if(("none"!=y||"none"!=g)&&(a=Number(a)||s,e.lineCap=f,e.lineWidth=a,e.strokeStyle=c,e.fillStyle=c,e.globalAlpha*=p,"none"!=y&&o(e,t[0],t[1],a,y,i(_,a)),"none"!=g)){var x=t.length;o(e,t[x-1],t[x-2],a,g,i(w,a))}};var a=5,u=Math.sqrt(3),s=2},{}],165:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=t.strokeStyle,r=t.lineDash,o=t.lineWidth,i=t.lineCap,a=t.lineJoin,u=t.alpha;if(n&&0!=o){if(i&&(e.lineCap=i),r){var s="round"==i;switch(r){case"solid":r=[0,0];break;case"round-dot":r=s?[0,2*o]:[o,o];break;case"square-dot":r=s?[o,2*o]:[2*o,o];break;case"dash":r=s?[3*o,2.5*o]:[4*o,1.5*o];break;case"dash-dot":r=s?[3*o,3*o,0,3*o]:[4*o,2*o,o,2*o];break;case"long-dash":r=s?[5*o,4*o]:[6*o,3*o];break;case"long-dash-dot":r=s?[5*o,3*o,0,3*o]:[6*o,2*o,o,2*o];break;case"long-dash-dot-dot":r=s?[5*o,2*o,0,2*o,0,2*o]:[6*o,o,o,o,o,o]}e.setLineDash(r)}e.globalAlpha*=u,e.strokeStyle=n,e.lineWidth=o,e.lineJoin=a,e.stroke()}}},{}],166:[function(e,t,n){"use strict";function r(e,t,n){if(t.length<2)return t;for(var r=2;r<t.length;r++){var o=t.substring(0,r);if(!(e.measureText(o).width<n))break}return t.substring(0,r-1)}function o(e,t,n){var o,i,a=t.split(" "),u=[],s=[];for(o=0,i=1;i<=a.length;i++)if(s=a.slice(o,i),e.measureText(s.join(" ")).width>n){if(i-o==1){var c=r(e,s[0],n);u.push([c]),a.splice(o,1,c,s[0].substring(c.length))}else{for(;""==a[i-1];)i++;u.push(a.slice(o,--i))}o=i}return i-o>1&&u.push(s),0==u.length&&u.push([""]),u}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n,r){var i=String(t).split("\n");return r?[].concat.apply([],i.map(function(t){return o(e,t,n)})):i.map(function(e){return e.split(" ")})}},{}],167:[function(e,t,n){"use strict";function r(e){var t=e.fontFamily,n=void 0===t?o.DEFAULT.FONT_FAMILY:t,r=e.bold,i=void 0===r?o.DEFAULT.BOLD:r,a=e.italic,u=void 0===a?o.DEFAULT.ITALIC:a,s=e.fontSize,c=void 0===s?o.DEFAULT.FONT_SIZE:s,l=[];return i&&l.push("bold"),u&&l.push("italic"),l.push(c+"px"),l.push(n),l.join(" ")}Object.defineProperty(n,"__esModule",{value:!0}),n.textLines=function(e,t,n,r,o){if(!r)return[];e.save(),e.font=n;var a=(0,i.default)(e,r,t,!!o);return e.restore(),a},n.font=r,n.drawText=function(e,t,n,i){var a=i.alpha,u=void 0===a?o.DEFAULT.FONT_COLOR:a,s=i.fontColor,c=void 0===s?o.DEFAULT.FONT_COLOR:s,l=i.textAlign,f=void 0===l?o.DEFAULT.TEXT_ALIGN:l,h=i.textBaseline,p=void 0===h?o.DEFAULT.TEXT_BASELINE:h,d=i.fontSize,y=void 0===d?o.DEFAULT.FONT_SIZE:d,v=i.lineHeight,g=void 0===v?1.2*y:v;e.save(),e.beginPath();var m=t.left,_=t.top,b=t.width,w=t.height;e.font=r(i);var x,k=n.length*g;switch(p){case"top":x=_,e.textBaseline="top";break;case"bottom":x=_+w-k+g,e.textBaseline="bottom";break;case"middle":default:x=_+w/2-k/2+g/2,e.textBaseline="middle"}var O;switch(f){case"left":O=m,e.textAlign="left";break;case"right":O=m+b,e.textAlign="right";break;case"justify":O=m,e.textAlign="left";break;case"center":default:O=m+b/2,e.textAlign="center"}e.globalAlpha*=u,e.fillStyle=c,"justify"!=f?n.forEach(function(t,n){e.fillText(t.join(" "),O,x+n*g)}):n.forEach(function(t,n){var r=x+n*g;if(1==t.length)e.fillText(t[0],O,r);else{var o=t.map(function(t){return e.measureText(t).width}),i=o.reduce(function(e,t){return e+t},0),a=(b-i)/(t.length-1),u=O;t.forEach(function(t,n){e.fillText(t,u,r),u+=o[n]+a})}}),e.restore()};var o=e("../../const"),i=function(e){return e&&e.__esModule?e:{default:e}}(e("./text-wrapper"))},{"../../const":203,"./text-wrapper":166}],168:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./shape")),l=r(e("./outline/ellipse-outline")),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"_draw",value:function(e){var t=this.model,n=t.cx,r=t.cy,o=t.rx,i=t.ry,a=t.startAngle,u=t.endAngle,s=t.anticlockwise;e.beginPath(),e.ellipse(n,r,Math.abs(o),Math.abs(i),0,a||0,u||2*Math.PI,s)}},{key:"contains",value:function(e,t){var n=this.model,r=n.cx,o=n.cy,i=(e-r)/(2*n.rx-.5),a=(t-o)/(2*n.ry-.5);return i*i+a*a<.25}},{key:"outline",value:function(e){return(0,l.default)(this,e)}},{key:"path",get:function(){var e=this.model,t=e.cx,n=e.cy,r=e.rx,o=e.ry;return[{x:t-r,y:n-o},{x:t+r,y:n-o},{x:t+r,y:n+o},{x:t-r,y:n+o}]},set:function(e){var t=e[0],n=e[2];this.set({cx:t.x+(n.x-t.x)/2,cy:t.y+(n.y-t.y)/2,rx:(n.x-t.x)/2,ry:(n.y-t.y)/2})}}]),t}();n.default=f,s.default.memoize(f.prototype,"path",!1),s.default.register("ellipse",f)},{"./component":155,"./outline/ellipse-outline":188,"./shape":197}],169:[function(e,t,n){"use strict";function r(e,t,n){var r=e.unitScale;t.set("scale",{x:r,y:r}),t.set("translate",{x:0,y:0})}function o(e,t,n){var r=t.model,o=r.width,i=r.height,a=n.offsetWidth,u=n.offsetHeight;t.set("scale",{x:a/o,y:u/i}),t.set("translate",{x:0,y:0})}function i(e,t,n){var r=e.unitScale,o=t.model,i=o.width,a=o.height;t.set("scale",{x:r,y:r}),t.set("translate",{x:Math.max((n.offsetWidth-i*r)/2,0),y:Math.max((n.offsetHeight-a*r)/2,0)})}function a(e,t,n){var r=n.offsetWidth/t.get("width");t.set("scale",{x:r,y:r}),t.set("translate",{x:0,y:0})}function u(e,t,n){var r=n.offsetHeight/t.get("height");t.set("scale",{x:r,y:r}),t.set("translate",{x:0,y:0})}function s(e,t,n){var r=t.model,o=r.width,i=r.height,a=n.offsetWidth,u=n.offsetHeight,s=a/o,c=u/i,l=Math.min(s,c);t.set("scale",{x:l,y:l}),t.set("translate",{x:(a-o*l)/2,y:(u-i*l)/2})}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=this.model_layer.model,n=t.width,c=t.height,l=this.target_element,f=this.model_layer;if(n&&c&&l&&l.offsetWidth&&l.offsetHeight)switch(e){case"center":i(this,f,l);break;case"both":o(this,f,l);break;case"width":a(this,f,l);break;case"height":u(this,f,l);break;case"ratio":s(this,f,l);break;case"none":default:r(this,f,l)}else r(this,f,l)}},{}],170:[function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:1,y:1};return e-=n.x,t-=n.y,{x:(e*Math.cos(-r)-t*Math.sin(-r)+n.x)/o.x,y:(e*Math.sin(-r)+t*Math.cos(-r)+n.y)/o.y}}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:1,y:1};return e-=n.x,t-=n.y,{x:(e*Math.cos(r)-t*Math.sin(r)+n.x)*o.x,y:(e*Math.sin(r)+t*Math.cos(r)+n.y)*o.y}}Object.defineProperty(n,"__esModule",{value:!0}),n.transcoordR=r,n.transcoordRR=o,n.transcoordP2S=function(e,t,n){if(!this.parent)return{x:e,y:t};var o=this.model,i=o.rotation,a=void 0===i?0:i,u=o.scale,s=void 0===u?{x:1,y:1}:u;if(this.isLayer()){var c=this.model.translate,l=r(e,t,c,a,s);return c&&(l.x-=c.x/(s?s.x:1),l.y-=c.y/(s?s.y:1)),l}var f=r(e,t,n=n||this.rotatePoint,a,s);return{x:f.x+(n.x-n.x/s.x),y:f.y+(n.y-n.y/s.y)}},n.transcoordS2P=function(e,t,n){if(!this.parent)return{x:e,y:t};var r=this.model,i=r.rotation,a=void 0===i?0:i,u=r.scale,s=void 0===u?{x:1,y:1}:u;if(this.isLayer()){var c=this.model.translate,l=o(e,t,void 0,a,s);return c&&(l.x+=c.x,l.y+=c.y),l}var f=o(e,t,n=n||this.rotatePoint,a,s);return{x:f.x-(n.x-n.x/s.x),y:f.y-(n.y-n.y/s.y)}},n.transcoordS2TR=function(e,t,n){var n=n||this.rootModel,r=this.transcoordS2T(e,t,n);return o(r.x,r.y,void 0,n.get("rotation")||0)},n.transcoordS2T=function(e,t,n){for(var n=n||this.rootModel,r=[],o=this.parent;o&&o!==n;o=o.parent)r.push(o);var i=this.transcoordS2P(e,t);return r.forEach(function(e){var t=e.model.scale,n=e.bounds;if(t){var r=e.rotatePoint;i.x+=(r.x-n.left)*t.x,i.y+=(r.y-n.top)*t.y}else i.x+=n.left,i.y+=n.top;i=e.transcoordS2P(i.x,i.y)}),i},n.transcoordT2S=function(e,t,n){for(var n=n||this.rootModel,r=[],o=this.parent;o&&o!==n;o=o.parent)r.splice(0,0,o);var i={x:e,y:t};return r.forEach(function(e){var t=e.model.scale;i=e.transcoordP2S(i.x,i.y);var n=e.bounds;if(t){var r=e.rotatePoint;i.x-=(r.x-n.left)/t.x,i.y-=(r.y-n.top)/t.y}else i.x-=n.left,i.y-=n.top}),this.transcoordP2S(i.x,i.y)},n.transcoordS2O=function(e,t,n){var r=this.rootModel,o=this.transcoordS2T(e,t,r);return n.transcoordT2S(o.x,o.y,r)},n.transcoordC2S=function(e,t,n){if(!n)for(n=this;n&&!n.isLayer();)n=n.parent;var o=n.model,i=o.translate,a=o.scale,u=r(e,t,i,o.rotation,a);return i&&(u.x-=i.x/(a?a.x:1),u.y-=i.y/(a?a.y:1)),n===this?u:this.transcoordT2S(u.x,u.y,n)},n.transcoordS2C=function(e,t,n){if(!n)for(n=this;n&&!n.isLayer();)n=n.parent;if(n!==this)r=this.transcoordS2T(e,t,n);else var r={x:e,y:t};var i=n.model,a=i.translate,u=i.rotation,s=i.scale;return r=o(r.x,r.y,void 0,u,s),a&&(r.x+=a.x,r.y+=a.y),r};!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../../const"))},{"../../const":203}],171:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t,n,r,o;return e.forEach(function(e){void 0===t?(t=e.left,n=e.top,r=e.left+e.width,o=e.top+e.height):(t=Math.min(e.left,t),n=Math.min(e.top,n),r=Math.max(e.left+e.width,r),o=Math.max(e.top+e.height,o))}),{left:t,top:n,width:r-t,height:o-n}}},{}],172:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=r(e("./component")),l=r(e("./shape")),f=r(e("./mixins/rect-path")),h={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"scene-number",name:"ref",placeholder:"SCENE-1"},{type:"select",label:"fit",name:"fit",property:{options:["both","ratio"]}}]},p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,f.default)(l.default)),u(t,[{key:"dispose",value:function(){this._releaseRef(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"draw",value:function(e){this._drawing||(this._drawing=!0,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this,e),this._drawing=!1)}},{key:"_pre_draw",value:function(e){if(s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_pre_draw",this).call(this,e),this.ref){var n=this.ref.root.center,r=this.center,o=this.refScale;e.translate(r.x,r.y),o&&e.scale(o.x,o.y),e.translate(-n.x,-n.y)}}},{key:"_post_draw",value:function(e){if(this.ref)return this.ref.root._post_draw(e);s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_post_draw",this).call(this,e)}},{key:"_draw",value:function(e){if(this.ref)return this.ref.root._draw(e);this.model.round;var t=this.bounds,n=t.left,r=t.top,o=t.width,i=t.height;e.beginPath(),e.rect(n,r,o,i)}},{key:"_releaseRef",value:function(){this.__ref&&this.__ref.release&&(this.__ref._container.off("redraw",this.onredraw_ref,this),this.__ref.release()),delete this.__ref}},{key:"onredraw_ref",value:function(){this.invalidate()}},{key:"onchange",value:function(e,t,n){(t.ref||e.ref)&&this._releaseRef()}},{key:"nature",get:function(){return h}},{key:"hasTextProperty",get:function(){return!1}},{key:"ref",get:function(){if(this.hasOwnProperty("__ref"))return this.__ref;var e=this.app.refProvider;return e&&this.model.ref?(this.__ref=e.get(this.model.ref,!0),this.__ref._container.on("redraw",this.onredraw_ref,this)):this.__ref=null,this.__ref},set:function(e){this.set("ref",e)}},{key:"refScale",get:function(){if(this.ref){var e=this.ref.root,t=e.bounds,n=(e.center,this.bounds);this.center;if(t.width&&t.height){var r=n.width/t.width,o=n.height/t.height;switch(this.model.fit){case"both":return{x:r,y:o};case"ratio":default:return{x:Math.min(r,o),y:Math.min(r,o)}}}}}}]),t}();n.default=p,c.default.memoize(p.prototype,"ref",!1),c.default.memoize(p.prototype,"refScale",!1),c.default.register("global-ref",p)},{"./component":155,"./mixins/rect-path":184,"./shape":197}],173:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var u=i.set;void 0!==u&&u.call(o,r)}return r},l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=r(e("../components/container")),h=r(e("./component")),p=["left","top","width","height","rotation","animation"],d=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f.default),s(t,[{key:"isGroup",value:function(){return!0}},{key:"get",value:function(e){return this._model[e]}},{key:"set",value:function(e,n){if("string"==typeof e)return this.set(o({},e,n));var r=p.reduce(function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t},{});return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,r)}},{key:"capture",value:function(e,n){var r=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"capture",this).call(this,e,n);if(!this.app.isEditMode)return r;if(this.parent.isGroup())return r&&r!==this&&r;for(var o=0;o<this.root.selected.length;o++){for(var i=this.root.selected[o];i!==this&&(i.isGroup()||i.parent.isGroup());)i=i.parent;if(i===this)return r&&r!==this&&r}return r&&r!==this&&this}},{key:"calculateBounds",value:function(){this.clearCache(),this.__MUTATING__=!0,this.mutateBounds(function(e){var t=h.default.union(this.components.map(function(e){return e.bounds}));return this.components.forEach(function(e){var n=e.bounds;e.bounds={left:n.left-t.left,top:n.top-t.top,width:n.width,height:n.height}}),{left:e.left+t.left,top:e.top+t.top,width:t.width,height:t.height}},this),this.__MUTATING__=!1,this.parent.isGroup()&&this.parent.calculateBounds()}},{key:"_draw",value:function(e){}},{key:"_post_draw",value:function(e){var t=this.model,n=t.top,r=t.left;t.scale;e.translate(r,n),this.layout.drawables(this).forEach(function(t){t.draw(e)}),e.translate(-r,-n)}},{key:"bounds",set:function(e){if(this.__MUTATING__)c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bounds",e,this);else{var n=this.bounds,r={x:e.width/n.width,y:e.height/n.height};this.path=this.path.map(function(t){return{x:e.left+(t.x-n.left)*r.x,y:e.top+(t.y-n.top)*r.y}}),this.components&&this.components.forEach(function(e){if(e.mutable)e.mutatePath(null,function(e){return e.map(function(e){return{x:e.x*r.x,y:e.y*r.y}})});else{var t=e.bounds,n=e.center,o={x:n.x*(1-r.x),y:n.y*(1-r.y)},i=-(o.x-t.width*(1-r.x)/2),a=-(o.y-t.height*(1-r.y)/2);e.bounds={left:t.left+i,top:t.top+a,width:t.width*r.x,height:t.height*r.y}}})}},get:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bounds",this)}},{key:"focusible",get:function(){return!1}}]),t}();n.default=d,h.default.register("group",d)},{"../components/container":156,"./component":155}],174:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./container")),c=r(e("./mixins/html-element")),l=e("../layout"),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,c.default)(s.default)),u(t,[{key:"_draw",value:function(e){}},{key:"layout",get:function(){return l.Layout.get(this.get("layout"))||l.HTMLAbsoluteLayout}}]),t}();n.default=f},{"../layout":247,"./container":156,"./mixins/html-element":183}],175:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e("./component")),s=r(e("./mixins/rect-path")),c=r(e("./mixins/html-element")),l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,c.default)((0,s.default)(u.default))),t}();n.default=l},{"./component":155,"./mixins/html-element":183,"./mixins/rect-path":184}],176:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=e.model,n=t.rotation,i=void 0===n?0:n,a=t.scale,u=void 0===a?o:a,s=(t.translate,t.bold),c=void 0===s?r.DEFAULT.BOLD:s,l=t.italic,f=void 0===l?r.DEFAULT.ITALIC:l,h=t.fontFamily,p=void 0===h?r.DEFAULT.FONT_FAMILY:h,d=t.fontColor,y=void 0===d?r.DEFAULT.FONT_COLOR:d,v=t.textAlign,g=void 0===v?r.DEFAULT.TEXT_ALIGN:v,m=t.paddingTop,_=void 0===m?0:m,b=t.paddingBottom,w=void 0===b?0:b,x=t.paddingLeft,k=void 0===x?0:x,O=t.paddingRight,P=void 0===O?0:O,j=t.fontSize,E=void 0===j?r.DEFAULT.FONT_SIZE:j,M=t.fillStyle,A=t.lineWidth,S=void 0===A?0:A,T=t.strokeStyle,C=void 0===T?r.DEFAULT.STROKE_STYLE:T,I=t.lineDash,R=void 0===I?r.DEFAULT.LINE_DASH:I,L=t.hidden,D=e.bounds,F=D.left,B=D.top,N=D.width,z=D.height;e.element.hidden=L;var G=e.element.style,Y=(Number(e.parent?e.parent.get("lineWidth")||0:0)+S)/2;switch(G.fontFamily=p,G.fontSize=E+"px",G.position="absolute",G.left=F-Y+"px",G.top=B-Y+"px",G.width=N-S-k-P+"px",G.height=z-S-_-w+"px",G.outline="none",G.paddingTop=_+"px",G.paddingRight=P+"px",G.paddingBottom=w+"px",G.paddingLeft=k+"px",G.border=S+"px",G.borderColor=C,G.borderStyle=R,G.backgroundColor=M,G.display="inline-block",G.color=y,c&&(G.fontWeight="bold"),f&&(G.fontStyle="italic"),g){case"end":g="right";break;case"start":g="left"}G.textAlign=g;var H=e.delta(),U=(u&&u.x||1)*H.sx,W=(u&&u.y||1)*H.sy,q=(i||0)+H.theta,X=H.tx||0,V=H.ty||0;["-webkit-","-moz-","-ms-","-o-",""].forEach(function(e){G[e+"transform"]="rotate("+q+"rad) translate("+X+", "+V+") scale("+U+", "+W+")"})};var r=e("../../const"),o={x:1,y:1}},{"../../const":203}],177:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){try{var r=e.getImageData(0,0,t,n)}catch(e){return(0,p.error)("Get Image Data Error: "+e.message),null}for(var o=r.data,i=0;i<t*n*4;i+=4){var a=o[i],u=o[i+1],s=o[i+2],c=parseInt((a+u+s)/3);r.data[i]=c,r.data[i+1]=c,r.data[i+2]=c}return r}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=r(e("./component")),f=r(e("./shape")),h=r(e("./mixins/rect-path")),p=e("../core/logger"),d={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"image-selector",label:"image-src",name:"src",property:{displayField:"id",displayFullUrl:!0,baseUrlAlias:"$base_url",defaultStorage:"scene-image",storageFilters:{type:Array,value:[{name:"category",value:"image"}]},useUpload:!0}}]},y=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,h.default)(f.default)),s(t,[{key:"dispose",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this._offcanvas=null,this._image=null}},{key:"_draw",value:function(e){var n=this.model,r=n.left,o=n.top,i=n.width,a=n.height,u=n.isGray,s=void 0!==u&&u,c=n.alpha,l=void 0===c?1:c,f=n.src;if(this.prepareIf(!this._image&&f),e.beginPath(),e.globalAlpha*=l,this._image&&this._image.complete)if(s&&this._offcanvas)e.drawImage(this._offcanvas,r,o,i,a);else try{e.drawImage(this._image,r,o,i,a)}catch(n){e.drawImage(t.noimage,r,o,i,a)}else e.drawImage(t.noimage,r,o,i,a)}},{key:"prepare",value:function(e,t){var n=this,r=this.model.src;if(r){this._image=new Image;try{"data"!==String(r).substring(0,4)?this._image.crossOrigin="use-credentials":this._image.crossOrigin=null,this._image.src="string"==typeof r?this.app.url(r):r}catch(e){return void t(e)}this._image.onload=function(){if(n.get("isGray")){var t=n._image.width,r=n._image.height;n._offcanvas=l.default.createCanvas(t,r);var o=n._offcanvas.getContext("2d");o.drawImage(n._image,0,0);var i=u(o,t,r);o.putImageData(i,0,0)}e(n)},this._image.onerror=function(e){t(e)}}else e(this)}},{key:"onchange",value:function(e,t){(e.hasOwnProperty("src")||e.hasOwnProperty("isGray"))&&(this._offcanvas=null,this._image=null,this.prepareIf(e.src))}},{key:"nature",get:function(){return d}},{key:"hasTextProperty",get:function(){return!1}}],[{key:"noimage",get:function(){return t.NOIMAGE||(t.NOIMAGE=new Image,t.NOIMAGE.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABIBAMAAAD7Se1QAAAAIVBMVEUAAABHcEwBAQEREREBAQEEBAQGBgYLCwsDAwMDAwMICAi6HF9tAAAAC3RSTlNNAEAERiMYCS41Eac10lYAAAEgSURBVHhe7dY9asQwEAXgh7DNertNiJy48pIitY3SB7bYdk0ukL1BDDmA9gZecoH4pmFQ3MQayUMguPBrNPD4wD9TCMvJmt3M/AtYwXOlXiWgqADVCUBD46MAnGhMBaCiUQmAm8VA/Eh/eWl9Fn5WcxD+OLuRrUYJDKLluwH2InACUgkoACSdADxQc50Bytadb9RkM0CT13TcvlCT1HFg8UTHvasuUVACCa3El6u2UdD8LFTlKhUFFgA+d3dj10aABkUN72N3jAADCrJq7PIIsPidcxBoTHIIAjMFmyCwmGYIAA1P9gFgfCANAOsDSccCDW+uLDB+kLGg94OkZoAGkwsDDAe2DOg5oPxAg03rBR88OHpBz4N8UVeHFSwma74BTW6Ge4rIRa4AAAAASUVORK5CYII="),t.NOIMAGE}}]),t}();n.default=y,l.default.register("image-view",y)},{"../core/logger":208,"./component":155,"./mixins/rect-path":184,"./shape":197}],178:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./component");Object.defineProperty(n,"Component",{enumerable:!0,get:function(){return r(o).default}});var i=e("./container");Object.defineProperty(n,"Container",{enumerable:!0,get:function(){return r(i).default}});var a=e("./root-container");Object.defineProperty(n,"RootContainer",{enumerable:!0,get:function(){return r(a).default}});var u=e("./shape");Object.defineProperty(n,"Shape",{enumerable:!0,get:function(){return r(u).default}});var s=e("./line");Object.defineProperty(n,"Line",{enumerable:!0,get:function(){return r(s).default}});var c=e("./ellipse");Object.defineProperty(n,"Ellipse",{enumerable:!0,get:function(){return r(c).default}});var l=e("./rect");Object.defineProperty(n,"Rect",{enumerable:!0,get:function(){return r(l).default}});var f=e("./polygon");Object.defineProperty(n,"Polygon",{enumerable:!0,get:function(){return r(f).default}});var h=e("./polyline");Object.defineProperty(n,"Polyline",{enumerable:!0,get:function(){return r(h).default}});var p=e("./ruler");Object.defineProperty(n,"Ruler",{enumerable:!0,get:function(){return r(p).default}});var d=e("./image-view");Object.defineProperty(n,"ImageView",{enumerable:!0,get:function(){return r(d).default}});var y=e("./text");Object.defineProperty(n,"Text",{enumerable:!0,get:function(){return r(y).default}});var v=e("./group");Object.defineProperty(n,"Group",{enumerable:!0,get:function(){return r(v).default}});var g=e("./local-ref");Object.defineProperty(n,"LocalRef",{enumerable:!0,get:function(){return r(g).default}});var m=e("./global-ref");Object.defineProperty(n,"GlobalRef",{enumerable:!0,get:function(){return r(m).default}});var _=e("./info-window");Object.defineProperty(n,"InfoWindow",{enumerable:!0,get:function(){return r(_).default}});var b=e("./html-overlay-element");Object.defineProperty(n,"HTMLOverlayElement",{enumerable:!0,get:function(){return r(b).default}});var w=e("./html-overlay-container");Object.defineProperty(n,"HTMLOverlayContainer",{enumerable:!0,get:function(){return r(w).default}});var x=e("./path");Object.defineProperty(n,"Path",{enumerable:!0,get:function(){return r(x).default}});var k=e("./triangle");Object.defineProperty(n,"Triangle",{enumerable:!0,get:function(){return r(k).default}});var O=e("./donut");Object.defineProperty(n,"Donut",{enumerable:!0,get:function(){return r(O).default}});var P=e("./star");Object.defineProperty(n,"Star",{enumerable:!0,get:function(){return r(P).default}});var j=e("./variable");Object.defineProperty(n,"Variable",{enumerable:!0,get:function(){return r(j).default}});var E=e("./mixins/rect-path");Object.defineProperty(n,"RectPath",{enumerable:!0,get:function(){return r(E).default}});var M=e("./mixins/value-holder");Object.defineProperty(n,"ValueHolder",{enumerable:!0,get:function(){return r(M).default}});var A=e("./mixins/data-source");Object.defineProperty(n,"DataSource",{enumerable:!0,get:function(){return r(A).default}})},{"./component":155,"./container":156,"./donut":160,"./ellipse":168,"./global-ref":172,"./group":173,"./html-overlay-container":174,"./html-overlay-element":175,"./image-view":177,"./info-window":179,"./line":180,"./local-ref":181,"./mixins/data-source":182,"./mixins/rect-path":184,"./mixins/value-holder":185,"./path":190,"./polygon":191,"./polyline":192,"./rect":193,"./root-container":195,"./ruler":196,"./shape":197,"./star":198,"./text":199,"./triangle":201,"./variable":202}],179:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n=e.split(/\s+/),r=n.indexOf(t);return-1!=r?n.splice(r,1):n.splice(-1,0,t),n.join(" ")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(e("lodash/template")),l=r(e("./component")),f=r(e("./shape")),h=r(e("./mixins/rect-path")),p=e("../const"),d={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"textarea",label:"front-side-template",name:"frontSideTemplate",property:{language:"html"}},{type:"textarea",label:"back-side-template",name:"backSideTemplate",property:{language:"html"}},{type:"textarea",label:"style",name:"style",property:{language:"css"}}]},y='\n<div class="info-window-btns">\n  <button>&#88</button>\n  <button>&#8652</button>\n</div>\n<div class="info-window-content">\n',v=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,h.default)(f.default)),s(t,[{key:"dispose",value:function(){var e=this;this.infoWindows.map(function(e){return e.component}).forEach(function(t){return e._removeInfoWindow(t)})}},{key:"_findInfoWindowByComponent",value:function(e){return this.infoWindows.find(function(t){return t.component===e})}},{key:"_addInfoWindow",value:function(e,t,n){this._findInfoWindowByComponent(e)||this._windows.push({component:e,window:t,styleElement:n})}},{key:"_removeInfoWindow",value:function(e){var t=this._findInfoWindowByComponent(e);if(t){var n=t.window,r=t.styleElement;n&&n.parentNode.removeChild(n),r&&document.head.removeChild(r);var o=this.infoWindows.lastIndexOf(t);this.infoWindows.splice(o,1)}}},{key:"_draw",value:function(e){var n=this.bounds,r=n.left,o=n.top,i=n.width,a=n.height;e.beginPath(),e.drawImage(t.image,r,o,i,a)}},{key:"infoWindows",get:function(){return this._windows||(this._windows=[]),this._windows}},{key:"templates",get:function(){var e=this._model,t=e.frontSideTemplate,n=void 0===t?"":t,r=e.backSideTemplate,o=void 0===r?"":r;return[(0,c.default)(y+n+"\n</div>\n"),(0,c.default)(y+o+"\n</div>\n")]}},{key:"style",get:function(){return'\n.flip {\n  backface-visibility:             hidden;\n      -moz-backface-visibility:    hidden;\n      -ms-backface-visibility:     hidden;\n      -o-backface-visibility:      hidden;\n      -webkit-backface-visibility: hidden;\n  border-radius: 7px;\n  height: auto;\n  font: normal 14px helvetica, arial, san serif;\n  position: absolute;\n  opacity:.9;\n  transform-origin:             50% 50% 0px;\n      -moz-transform-origin:    50% 50% 0px;\n      -ms-transform-origin:     50% 50% 0px;\n      -o-transform-origin:      50% 50% 0px;\n      -webkit-transform-origin: 50% 50% 0px;\n  transition: all 2s;\n      -moz-transition:    all 2s;\n      -ms-transition:     all 2s;\n      -o-transition:      all 2s;\n      -webkit-transition: all 2s;\n  min-width: 100px;min-height:50px;\n  background-color:#3e424e;\n  box-shadow: 2px 3px 2px 0px rgba(0,0,0,0.15);\n}\n\n#side-1 {\n  transform:             rotateY( 0deg );\n      -moz-transform:    rotateY( 0deg );\n      -ms-transform:     rotateY( 0deg );\n      -o-transform:      rotateY( 0deg );\n      -webkit-transform: rotateY( 0deg );\n}\n.flip:after{\n   content:"";\n   display:block;\n   position: absolute;\n   opacity:.9;\n   width: 0;\n   height: 0;\n}\n.flip.arrow-top:after{\n   left:45%;\n   top:-17px;\n   border-left:10px solid transparent;\n   border-bottom:18px solid #323b44;\n   border-right:10px solid transparent;\n}\n.flip.arrow-right:after{\n   left:100%;\n   top:48%;\n   border-top:10px solid transparent;\n   border-left:18px solid #323b44;\n   border-bottom:10px solid transparent;\n}\n.flip.arrow-bottom:after{\n   left:45%;\n   top:100%;\n   border-left:10px solid transparent;\n   border-top:18px solid #323b44;\n   border-right:10px solid transparent;\n}\n.flip.arrow-left:after{\n   right:100%;\n   top:48%;\n   border-top:10px solid transparent;\n   border-right:18px solid #323b44;\n   border-bottom:10px solid transparent;\n}\n\n#side-2 {\n  transform:             rotateY( 180deg );\n      -moz-transform:    rotateY( 180deg );\n      -ms-transform:     rotateY( 180deg );\n      -o-transform:      rotateY( 180deg );\n      -webkit-transform: rotateY( 180deg );\n}\n\n.flip-side-1 {\n  transform:             rotateY( 0deg ) !important;\n      -moz-transform:    rotateY( 0deg ) !important;\n      -ms-transform:     rotateY( 0deg ) !important;\n      -o-transform:      rotateY( 0deg ) !important;\n      -webkit-transform: rotateY( 0deg ) !important;\n}\n\n.flip-side-2 {\n  transform:             rotateY( 180deg ) !important;\n      -moz-transform:    rotateY( 180deg ) !important;\n      -ms-transform:     rotateY( 180deg ) !important;\n      -o-transform:      rotateY( 180deg ) !important;\n      -webkit-transform: rotateY( 180deg ) !important;\n}\n\n.info-window-btns{\n  position:absolute;\n  top:-7px;\n  right:5px;\n  overflow:hidden;\n}\n.info-window-content{\n  padding:10px;\n  color:#efefef;\n  font-size:13px;\n  line-height:1.4;\n}\n.info-window-btns button{\n  width:20px;height:20px;\n  float:right;\n  border:0;\n  border-radius:12px;\n  background-color:#2a7da1;\n  margin-right:3px;padding:2px 4px;\n  text-align:center;\n  cursor:pointer;\n  font-size:12px;\n  color:#fff\n}\n.info-window-btns button:hover{\n  background-color:#60bb23;\n}\n'+this.get("style")}},{key:"hasTextProperty",get:function(){return!1}},{key:"nature",get:function(){return d}}],[{key:"hide",value:function(e,t){if(t){var n=e.root.findById(t);n?n._removeInfoWindow(e):console.warn("InfoWindow Not Found.",t)}}},{key:"show",value:function(e,n){if(n){var r=e.root.findById(n);if(r){if(!r._findInfoWindowByComponent(e)){var o=r.templates,i=r.style,a=e.bounds,s=a.left,c=a.top,l=a.width,f=a.height,h=document.createElement("span");h.style.position="absolute";var d=document.createElement("style");d.type="text/css",d.styleSheet?d.styleSheet.cssText=i:d.appendChild(document.createTextNode(i)),document.head.appendChild(d);var y=document.createElement("div");y.id="side-1",y.className="flip",y.style.display="inline-block",y.innerHTML=o[0](e);var v=document.createElement("div");v.id="side-2",v.className="flip",v.style.display="inline-block",v.innerHTML=o[1](e),p.GESTURES.forEach(function(e){y.addEventListener(e,function(e){e.stopPropagation()}),v.addEventListener(e,function(e){e.stopPropagation()})}),p.KEYEVENTS.forEach(function(e){y.addEventListener(e,function(e){e.stopPropagation()}),v.addEventListener(e,function(e){e.stopPropagation()})});var g=e.root.target_element;h.appendChild(y),h.appendChild(v),g.appendChild(h),r._addInfoWindow(e,h,d),y.querySelector(".info-window-btns > :nth-child(2)").addEventListener("click",function(e){e.preventDefault(),v.className=u(v.className,"flip-side-1"),y.className=u(y.className,"flip-side-2")},!1),y.querySelector(".info-window-btns > :nth-child(1)").addEventListener("click",function(r){r.preventDefault(),t.hide(e,n)},!1),v.querySelector(".info-window-btns > :nth-child(2)").addEventListener("click",function(e){e.preventDefault(),v.className=u(v.className,"flip-side-1"),y.className=u(y.className,"flip-side-2")},!1),v.querySelector(".info-window-btns > :nth-child(1)").addEventListener("click",function(r){r.preventDefault(),t.hide(e,n)},!1);var m=y.offsetWidth,_=y.offsetHeight,b=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,w=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,x=g.getBoundingClientRect(),k=x.left,O=x.top,P=e.transcoordS2C(s+l/2,c);if(P.x-m/2+m+k<b&&_+20<P.y+O)return h.style.marginLeft=P.x-m/2+"px",h.style.marginTop=P.y-_-20+"px",y.className+=" arrow-bottom",void(v.className+=" arrow-bottom");if((P=e.transcoordS2C(s+l/2,c+f)).x-m/2+m+k<b&&w>P.y+_+O+20)return h.style.marginLeft=P.x-m/2+"px",h.style.marginTop=P.y+20+"px",y.className+=" arrow-top",void(v.className+=" arrow-top");if((P=e.transcoordS2C(s,c+f/2)).x+k>m+20)return h.style.marginLeft=P.x-m-20+"px",h.style.marginTop=P.y-_/2+"px",y.className+=" arrow-right",void(v.className+=" arrow-right");P=e.transcoordS2C(s+l,c+f/2),h.style.marginLeft=P.x+20+"px",h.style.marginTop=P.y-_/2+"px",y.className+=" arrow-left",v.className+=" arrow-left"}}else console.warn("InfoWindow Not Found.",n)}else console.warn("InfoWindow not defined.")}},{key:"image",get:function(){return t._image||(t._image=new Image,t._image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAY1BMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIAbxiAAAAIHRSTlMA+gPshCwwWFzYCeLRm7QRG6rLeDZI9JOJJDtjb1HAf1sAT80AAAQQSURBVHhe7MCBAAAAAMKw/KkzOMG2BAAAAKeu3lUohIEggO7jQi5qHqpgwML5/6+0F0y02z31FlvMMLKt86QMQ1ined2Evih1hFFjLfRWjgzDOGZ6JSiM00B9EuHALtQxJLiQBmqSBCeSUEuEGzs1BDjSaHxWOKK5Eyz/4SoMV/hp4+vtcPkdwZD/udwevNg7t1xXYRiKmkB7C+ENlPLq8fxHeX+RGjWQ1D45ldcIulBIvCvYJGBEadyTzxAcfY57NBjpLScOO/bzugcTHe7IMwiSLMcdHZhocMcMgTLjjgZM7F1bCJZ2v27ARGzYDwIk2Z+JYGJ/iiwQLMv+JAEThjkmRG64Q0Q+gIiIiIiIiIiIyFy0KRFt0bOJZAWSUigmkQaJaXhENiRnYBEpkZySRSRGcmIWEaQnYhHRSI5mESmQnIJFZIqQmGhiEYEbEnPjGlEGjYTogW/WUkOXENENSqZfEXmDiIiIiIiIiIiIiIiIiIiImq5ETIpRpBpjJCMeKy6Ri0ZS9MQjkmkkJs1YRDokp2MRyZGclkUkQnIiEQltaX3Lzb6yiGTpl2y/avqSAxGgelCOKI+Kc2isL0TUSsZ4EREREREREREREREREREREfnIQzXrNWSRTeNxnlOwIgueIr6AAyE+CpiqMEUK71IDO4E+LluEKYKnKcMUifEsTZgiJZ5lDVNkwJPcqzBFoPF/HplfxL/w6b4EPGv1h18Weya1TL8iIiIeiIiIiIiIiEjkPefxV+5YA9PPHylB+u5aqgZ39H+jKOxrqtu+pkzvr9YbzoZ6w2OFkzcrA3yE4WZlSSyFk54VoA/wR43+FaD+r9w32QdWvgvjp2ty2xq8qHPHmtyPFxfrK3hw1ejERlAlfR/Ame2OTow05d4rOLLSlHtDVhI0uRO01JeZ405op6zgNNXT+bIRfpIgn+AkU4pOxBscohojdCHu4RRzjC5EYwVHqRONDkSnEvK/CB3QSU32IRW3ZPnj9iEVoGCNTLVrh8ia1x+6wq8xvB5mz8pxu7oPwIn9lcR0AiuX1+1KX+BXqdvXzWsAC0NsGjzZsS/2Bd6yRA5RgIHkXNhSD3whASZ8rrB9mItuEAizac0fDlHxDMEwpQfD1tW4y3Hjfy5s9nOHH3uwWA+EqEJBWCjoTL/S5toBB/7hu6zer74NgqSP39zJU+qQX3ix763mHTqvIVRUVprCljlElRkEjBqNYevH8veBJ2xhiyhE8YctmhDFH7ZoQhR/2KIJUfxhiyRE8YctmhDFH7ZoQhR/2OIJUfxhC9Ppf/t1jgJACERRsHGyYRZB0Ujvf0xD8w6kP7y6RZmgf/oTFTtbbzJVxZWo2Nlqw6TVy5GowNl6ssm7v50obamfSxQAAAAAAAsKLM15fb3vpQAAAABJRU5ErkJggg=="),t._image}}]),t}();n.default=v,["templates","style"].forEach(function(e){return l.default.memoize(v.prototype,e,!1)}),l.default.register("info-window",v)},{"../const":203,"./component":155,"./mixins/rect-path":184,"./shape":197,"lodash/template":133}],180:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./component")),s=e("./drawer/line"),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"isLine",value:function(){return!0}},{key:"_draw",value:function(e){var t=this.model,n=t.begin,r=void 0===n?"none":n,o=t.end,i=void 0===o?"none":o,a=t.lineWidth,u=this.drawPath;(0,s.drawEndTips)(e,u,this.model),e.beginPath();var c=(0,s.getTipNeckPos)(r,a,u[0],u[1]),l=(0,s.getTipNeckPos)(i,a,u[u.length-1],u[u.length-2]);e.moveTo(c.x,c.y);for(var f=1;f<u.length-1;f++)e.lineTo(u[f].x,u[f].y);e.lineTo(l.x,l.y),this.drawStroke(e)}},{key:"contains",value:function(e,t){var n=this.model.lineWidth;return(0,s.containedInPath)(e,t,this.drawPath,n)}},{key:"drawPath",get:function(){return this.path}},{key:"resizable",get:function(){return!1}},{key:"mutable",get:function(){return!0}},{key:"rotatable",get:function(){return!1}},{key:"path",get:function(){var e=this.model;return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2}]},set:function(e){var t=e[0],n=e[1];this.set({x1:t.x,y1:t.y,x2:n.x,y2:n.y})}}]),t}();n.default=c,c.getTipNeckPos=s.getTipNeckPos,c.containedInPath=s.containedInPath,c.drawEndTips=s.drawEndTips,u.default.memoize(c.prototype,"path",!1),u.default.register("line",c)},{"./component":155,"./drawer/line":164}],181:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=r(e("./component")),l=r(e("./shape")),f=r(e("./mixins/rect-path")),h={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"ref",name:"ref",property:"ref"},{type:"select",label:"fit",name:"fit",property:{options:["both","ratio"]}}]},p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,f.default)(l.default)),u(t,[{key:"draw",value:function(e){this._drawing||(this._drawing=!0,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this,e),this._drawing=!1)}},{key:"_pre_draw",value:function(e){if(s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_pre_draw",this).call(this,e),this.ref){var n=this.ref.center,r=this.center,o=this.refScale;e.translate(r.x,r.y),e.scale(o.x,o.y),e.translate(-n.x,-n.y)}}},{key:"_post_draw",value:function(e){if(this.ref)return this.ref._post_draw(e);s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_post_draw",this).call(this,e)}},{key:"_draw",value:function(e){if(this.ref)return this.ref._draw(e);this.model.round;var t=this.bounds,n=t.left,r=t.top,o=t.width,i=t.height;e.beginPath(),e.rect(n,r,o,i)}},{key:"ref",get:function(){var e=this.model.ref;return e&&"string"==typeof e?this.root.findById(e):null},set:function(e){this.set("ref",e)}},{key:"refScale",get:function(){var e=this.ref.bounds,t=(this.ref.center,this.bounds),n=(this.center,t.width/e.width),r=t.height/e.height;switch(this.model.fit){case"both":return{x:n,y:r};case"ratio":default:return{x:Math.min(n,r),y:Math.min(n,r)}}}},{key:"nature",get:function(){return h}},{key:"hasTextProperty",get:function(){return!1}}]),t}();n.default=p,c.default.memoize(p.prototype,"ref",!1),c.default.memoize(p.prototype,"refScale",!1),c.default.register("local-ref",p)},{"./component":155,"./mixins/rect-path":184,"./shape":197}],182:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.default=function(e){return function(t){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),a(n,[{key:"_convertDataFormat",value:function(e,t){var n;switch(t){case"json":n=JSON.parse(e);break;default:n=e}return n}}]),n}()}},{}],183:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=function(e){return e&&e.__esModule?e:{default:e}}(e("../html/reposition"));n.default=function(e){return function(t){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),a(n,[{key:"isHTMLElement",value:function(){return!0}},{key:"setElementProperties",value:function(e){throw new Error("Not Implemented Yet")}},{key:"createElement",value:function(){this.element=document.createElement(this.tagName),this.element&&(this.setElementProperties(this.element),this.parent.isHTMLElement&&this.parent.isHTMLElement()?this.parent.element.appendChild(this.element):this.root.model_layer.overlay.appendChild(this.element),(0,s.default)(this),this.oncreate_element&&this.oncreate_element(this.element))}},{key:"disposeElement",value:function(){var e=this.element;e&&e.parentElement&&e.parentElement.removeChild(e),delete this.element}},{key:"ready",value:function(){!this.element&&this.createElement()}},{key:"added",value:function(){this.element&&(this.parent.isHTMLElement&&this.parent.isHTMLElement()?this.parent.element.appendChild(this.element):this.root.model_layer.overlay.appendChild(this.element),(0,s.default)(this))}},{key:"dispose",value:function(){this.disposeElement(this),u(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"dispose",this).call(this)}},{key:"onchange",value:function(e,t){this.element&&this.setElementProperties(this.element),this.element&&(0,s.default)(this)}},{key:"element",get:function(){return this._element},set:function(e){this._element=e}},{key:"tagName",get:function(){return this.get("type")}},{key:"hasTextProperty",get:function(){return!0}},{key:"textHidden",get:function(){return!0}}]),n}()}},{"../html/reposition":176}],184:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../../core/memoize"));n.default=function(e){var t=function(t){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),a(n,[{key:"contains",value:function(e,t){var n=this.model,r=n.left,o=n.top,i=n.width,a=n.height,u=n.lineWidth,s=(void 0===u?0:u)/2;return e<Math.max(r+i,r)+s&&e>Math.min(r+i,r)-s&&t<Math.max(o+a,o)+s&&t>Math.min(o+a,o)-s}},{key:"path",set:function(e){var t=e[0],n=e[2],r=this.model;r.width,r.height;this.set({left:t.x,top:t.y,width:n.x-t.x,height:n.y-t.y})},get:function(){var e=this.model,t=e.left,n=void 0===t?0:t,r=e.top,o=void 0===r?0:r,i=e.width,a=void 0===i?0:i,u=e.height,s=void 0===u?0:u;return[{x:n,y:o},{x:n+a,y:o},{x:n+a,y:o+s},{x:n,y:o+s}]}}]),n}();return u.intercept(t.prototype,"path",!1),t}},{"../../core/memoize":209}],185:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var u=i.set;void 0!==u&&u.call(o,r)}return r},s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=e("../../core/utils");n.default=function(e){return function(t){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),a(n,[{key:"animOnValueChange",value:function(e){var t=this;if(e!=this._lastValue){var n=e-(this._lastValue||0);this._lastValue=e,this._anim_alpha=-n,this.animate({step:function(e){t._anim_alpha=n*(e-1),t.invalidate()},duration:1e3,delta:"circ",options:{x:1},ease:"out"}).start()}}},{key:"defaultValueSubstitutor",value:function(){return Number(this.get("value")||0)}},{key:"animAlpha",get:function(){return this._anim_alpha||0}},{key:"animValue",get:function(){return(this._lastValue||0)+(this._anim_alpha||0)}},{key:"value",get:function(){return Number(s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"value",this))||0},set:function(e){u(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"value",Number((0,c.objToVal)(e)),this)}}]),n}()}},{"../../core/utils":216}],186:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=this.bounds,o=this.rotatePoint,i=this.get("rotation"),a=this.get("scale");if(e){var u=e.call(t,n);u&&(n=u)}var s=n,c=s.left,l=s.top,f=[{x:c,y:l},{x:c+s.width,y:l+s.height}],h=(f=f.map(function(e){return r.default.transcoordRR(e.x,e.y,o,i,a)}))[0],p=f[1];o={x:(h.x+p.x)/2,y:(h.y+p.y)/2},h=(f=f.map(function(e){return r.default.transcoordR(e.x,e.y,o,i,a)}))[0],p=f[1],this.bounds={left:h.x,top:h.y,width:p.x-h.x,height:p.y-h.y}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("../component"))},{"../component":155}],187:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){var r=this,o=this.path,i=this.rotatePoint;this.get("rotation"),this.get("scale"),e&&(o=e.call(n,o));var a=o.map(function(e){return r.transcoordS2P(e.x,e.y)});t&&(o=t.call(n,a))&&(a=o);var u,s,c,l,f={x:0,y:0};u=s=(o=a.map(function(e){return r.transcoordP2S(e.x,e.y,f)}))[0].x,c=l=o[0].y;for(var h=1;h<o.length;h++){var p=o[h];p.x<u?u=p.x:p.x>s&&(s=p.x),p.y<c?c=p.y:p.y>l&&(l=p.y)}i={x:(u+s)/2,y:(c+l)/2},i=this.transcoordS2P(i.x,i.y,f),this.path=a.map(function(e){return r.transcoordP2S(e.x,e.y,i)})}},{}],188:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=e.model,r=n.cx,o=n.cy,i=n.rx,a=n.ry,u=2*Math.PI*t,s=r+i*Math.cos(u),c=o+a*Math.sin(u);return e.transcoordS2T(s,c)}},{}],189:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=e.path.slice();if(n&&n.length){var o=1,i=[];if(e.isLine()||n.push(n[0]),t<=0)return e.transcoordS2T(n[0].x,n[0].y);if(t>=1)return e.transcoordS2T(n[n.length-1].x,n[n.length-1].y);for(;n[o];){var a=n[o-1],u=n[o],s=u.x-a.x,c=u.y-a.y;i.push(Math.sqrt(s*s+c*c)),o++}var l=i.reduce(function(e,t){return e+t},0);o=0;var f=0;do{f+=i[o++]}while(f/l<t);t=(t-(f-=i[--o])/l)*(l/i[o]);var h=n[o%n.length],p=n[(o+1)%n.length],d=h.x+Math.round((p.x-h.x)*t),y=h.y+Math.round((p.y-h.y)*t);return e.transcoordS2T(d,y)}(0,r.error)("path should not be empty")};var r=e("../../core/logger")},{"../../core/logger":208}],190:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(e("./component")),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,u.default),a(t,[{key:"_draw",value:function(e){var t=this.model.path,n=void 0===t?[]:t;if(!(n.length<=1)){e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),this.drawStroke(e)}}},{key:"contains",value:function(e,t){var n=this.model.path,r=!1;return n.forEach(function(o,i){var a=(i+n.length+1)%n.length,u=o.x,s=o.y,c=n[a].x,l=n[a].y;s>t!=l>t&&e<(c-u)*(t-s)/(l-s)+u&&(r=!r)}),r}},{key:"path",get:function(){return this.model.path},set:function(e){this.set("path",e)}}]),t}();n.default=s,u.default.register("path",s)},{"./component":155}],191:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./shape")),l={ondragstart:function(e,t,n){n.mutatePath(null,function(n){n.splice(t+1,0,e)})},ondragmove:function(e,t,n){n.mutatePath(null,function(n){n[t+1]=e})},ondragend:function(e,t,n){}},f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"_draw",value:function(e){var t=this.model.path,n=void 0===t?[]:t;if(!(n.length<=1)){e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath()}}},{key:"contains",value:function(e,t){var n=this.model.path,r=!1;return n.forEach(function(o,i){var a=(i+n.length+1)%n.length,u=o.x,s=o.y,c=n[a].x,l=n[a].y;s>t!=l>t&&e<(c-u)*(t-s)/(l-s)+u&&(r=!r)}),r}},{key:"mutable",get:function(){return!0}},{key:"pathExtendable",get:function(){return!0}},{key:"path",get:function(){return this.model.path},set:function(e){this.set("path",e)}},{key:"controls",get:function(){var e=this.path;return e.map(function(t,n){var r=e[n+1>=e.length?0:n+1];return{x:(t.x+r.x)/2,y:(t.y+r.y)/2,handler:l}})}}]),t}();n.default=f,s.default.memoize(f.prototype,"controls",!1),s.default.register("polygon",f)},{"./component":155,"./shape":197}],192:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./line")),l={ondragstart:function(e,t,n){n.mutatePath(null,function(n){n.splice(t,0,e)})},ondragmove:function(e,t,n){n.mutatePath(null,function(n){n[t]=e})},ondragend:function(e,t,n){}},f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"pathExtendable",get:function(){return!0}},{key:"path",get:function(){return this.model.path},set:function(e){this.set("path",e)}},{key:"controls",get:function(){for(var e=this.path,t=[],n=0;n<e.length-1;n++){var r=e[n],o=e[n+1];0==n&&t.push({x:r.x,y:r.y,handler:l}),t.push({x:(r.x+o.x)/2,y:(r.y+o.y)/2,handler:l}),n==e.length-2&&t.push({x:o.x,y:o.y,handler:l})}return t}}]),t}();n.default=f,s.default.memoize(f.prototype,"controls",!1),s.default.register("polyline",f)},{"./component":155,"./line":180}],193:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){var r=t>n?n/t*100:100;return e>=r?e=r:e<=0&&(e=0),e}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(e("./component")),l=r(e("./shape")),f=r(e("./mixins/rect-path")),h={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"round",name:"round",property:"round"}]},p={ondragmove:function(e,t,n){var r=n.model,o=r.left,i=(r.top,r.width),a=r.height,s=(n.transcoordP2S(e.x,e.y).x-o)/(i/2)*100;s=u(s,i,a),n.set({round:s})}},d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,f.default)(l.default)),s(t,[{key:"is3dish",value:function(){return!0}},{key:"_draw",value:function(e){var t=this.model.round,n=void 0===t?0:t,r=this.bounds,o=r.left,i=r.top,a=r.width,s=r.height;if(e.beginPath(),(n=u(n,a,s))>0){var c=n/100*(a/2);e.moveTo(o+c,i),e.lineTo(o+a-c,i),e.quadraticCurveTo(o+a,i,o+a,i+c),e.lineTo(o+a,i+s-c),e.quadraticCurveTo(o+a,i+s,o+a-c,i+s),e.lineTo(o+c,i+s),e.quadraticCurveTo(o,i+s,o,i+s-c),e.lineTo(o,i+c),e.quadraticCurveTo(o,i,o+c,i)}else e.rect(o,i,a,s)}},{key:"controls",get:function(){var e=this.model,t=e.left,n=e.top,r=e.width,o=e.round,i=e.height;return o=void 0==o?0:u(o,r,i),[{x:t+r/2*(o/100),y:n,handler:p}]}},{key:"nature",get:function(){return h}}]),t}();n.default=d,c.default.register("rect",d)},{"./component":155,"./mixins/rect-path":184,"./shape":197}],194:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){a=null;var e=performance.now(),t=(l=l.filter(function(e){return i(e)})).reduce(function(t,n){var r=e-n.updatedAt;return r>=n.retention?t.kills.push(n):t.next=0==t.next?n.retention-r:Math.min(t.next,n.retention-r),t},{next:0,kills:[]});t.kills.forEach(function(e){var t=l.indexOf(e);-1!=t?(l.splice(t,1),e.removeSelf(!0)):(0,c.error)("Should not be here. Maybe reentrance problem.")}),t.next>0&&(a=setTimeout(f,Math.max(t.next,500)))}function i(e){return!e.disposed&&e.retention>0&&!e.isTemplate()&&e.app&&e.app.isViewMode}Object.defineProperty(n,"__esModule",{value:!0});var a,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../core/utils"),c=e("../../core/logger"),l=[],f=(0,s.throttle)(function(){requestAnimationFrame(o)},500),h=function(){function e(){r(this,e)}return u(e,[{key:"add",value:function(e){i(e)&&-1==l.indexOf(e)&&(l.push(e),e.touch()),this.touch()}},{key:"remove",value:function(e){var t=l.indexOf(e);t>0&&l.splice(t,1),this.touch()}},{key:"touch",value:function(){null!==a&&(clearTimeout(a),a=null),f()}},{key:"length",get:function(){return l.length}}]),e}();n.default=new h},{"../../core/logger":208,"../../core/utils":216}],195:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=o(e("./component")),f=o(e("./container")),h=o(e("./fit/fit")),p=r(e("../model")),d=r(e("../style")),y=r(e("../event")),v=r(e("../event-map")),g=r(e("../core/utils")),m=e("../core/logger"),_=[];"undefined"!=typeof window&&window.addEventListener("resize",function(){_.forEach(function(e){e.resize()})});var b=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Object.assign({type:"root",scale:{x:1,y:1}},e||{}),n));return e=e||{},r._app=n,r.target_element=e.target_element,r.rebuildContentModel(r.model.model),_.push(r),r}return u(t,f.default),s(t,[{key:"dispose",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this._disposeAllResources(),this.target_element=null,this._app&&this._app.dispose();var e=_.indexOf(this);e>=0&&_.splice(e,1)}},{key:"isRoot",value:function(){return!0}},{key:"variable",value:function(e,t){var n=this.findById(e);if(!n){var r=this.findTemplateFor(e);if(!r)return;var o=Object.assign(g.clone(r.hierarchy),{id:e,templatePrefix:""});n=p.compile(o,this.app),this.model_layer.addComponent(n)}if(void 0===t)return n.data;n.set("data",t),n.touch()}},{key:"buildVariables",value:function(e){var t=this;!e||e instanceof Array||(e=Object.keys(e).map(function(t){var n=e[t];return n.key=t,n})),e&&e.forEach(function(e,n){var r=t.indexMap[e.key];if(r)r.set({data:e.value,mappings:e.mappings&&e.mappings.slice(),dataType:e.dataType});else{var o=p.compile({type:"variable",id:e.key,left:-120,top:0+20*n,strokeStyle:"black",width:100,height:20,dataType:e.type,data:e.value,mappings:e.mappings&&e.mappings.slice()},t.app);t.model_layer.addComponent(o)}})}},{key:"addTemplate",value:function(e,t){var n=this.templateMap[e];n&&(0,m.error)("Template replaced (duplicated)",e,t,n),this.templateMap[e]=t,delete this.templatePrefixes}},{key:"removeTemplate",value:function(e,t){var n=this.templateMap[e];n!==t?(0,m.warn)("Removing template failed (different)",e,t,n):delete this.templateMap[e],delete this.templatePrefixes}},{key:"findTemplateFor",value:function(e){this.templatePrefixes||(this.templatePrefixes=Object.keys(this.templateMap).sort().reverse());var t=this.templatePrefixes.find(function(t){return e.startsWith(t)});if(t)return this.templateMap[t]}},{key:"addIndex",value:function(e,t){var n=this.indexMap[e];n&&(0,m.error)("Index replaced (duplicated)",e,t,n),this.indexMap[e]=t}},{key:"removeIndex",value:function(e,t){var n=this.indexMap[e];n!==t?(0,m.warn)("Removing index failed (different)",e,t,n):delete this.indexMap[e]}},{key:"findById",value:function(e){return this.indexMap[e]}},{key:"findOrCreate",value:function(e){var t=this.indexMap[e];if(!t){var n=this.findTemplateFor(e);if(n){var r=Object.assign(g.clone(n.hierarchy),{id:e,templatePrefix:""});t=p.compile(r,this.app),this.model_layer.addComponent(t)}}return t}},{key:"resize",value:function(){this.components.forEach(function(e){e.resize&&e.resize()}),this.invalidate()}},{key:"_disposeAllResources",value:function(){var e=this;this.selected=[],this._focused=null,this._ready=!1,this.eventEngine&&(this.assist_handlers&&this.assist_handlers.forEach(function(t){e.eventEngine.remove(t)}),this.eventEngine.dispose(),delete this.eventEngine),this.assist_layers&&this.assist_layers.forEach(function(t){t.dispose(),e.removeComponent(t)}),delete this.assist_layers,this.model_layer&&this.model_layer.dispose(),this.model_layer&&this.removeComponent(this.model_layer),delete this.model_layer,this.indexMap={},this.templateMap={}}},{key:"rebuildContentModel",value:function(e){var t=this;this._disposeAllResources(),this.eventEngine=new y.Engine(this),(e=e||{}).type="model-layer";var n=e.variables;delete e.variables,this.model_layer=p.compile(e,this.app),this.model_layer.target=this.target_element,this.addComponent(this.model_layer),n&&this.buildVariables(n),this.assist_layers=(this.model.layers||[]).map(function(e){var n=p.compile(e,t.app);return n.target=t.target_element,t.addComponent(n),n}),this.assist_handlers=(this.model.handlers||[]).map(function(e){var n={};return t.eventEngine.add(n,v.EventMap.get(e)),n}),this._ready=!0,this.traverse(function(e){return e.ready()})}},{key:"draw",value:function(){this.components.forEach(function(e){return e.draw()})}},{key:"contains",value:function(e,t){return!0}},{key:"capturePath",value:function(e,t){return this.model_layer.capturePath(e,t)}},{key:"invalidate",value:function(){this.components.forEach(function(e){return e.invalidate()})}},{key:"refreshMappings",value:function(){this._refresh_mapping_debouncer||(this._refresh_mapping_debouncer=g.debounce(function e(t){t.executeMappings(),t.components&&t.components.forEach(function(t){return e(t)})},1e3)),this._refresh_mapping_debouncer(this.model_layer)}},{key:"_addTraverse",value:function(e){var t=this;e.components&&e.components.forEach(function(e){return t._addTraverse(e)});var n=e.model,r=n.id,o=n.templatePrefix;r&&this.addIndex(r,e),o&&this.addTemplate(o,e);var i=g.merge({},e.eventMap,e.model.eventMap);this.eventEngine.add(e,i)}},{key:"_removeTraverse",value:function(e){var t=this;e.components&&e.components.forEach(function(e){return t._removeTraverse(e)});var n=e.model,r=n.id,o=n.templatePrefix;r&&this.removeIndex(r,e),o&&this.removeTemplate(o,e),this.eventEngine.remove(e)}},{key:"onadded",value:function(e,t){this._addTraverse(t),this.refreshMappings(),this.invalidate()}},{key:"onremoved",value:function(e,t){this._removeTraverse(t),this.invalidate()}},{key:"onchanged",value:function(e,t,n){t.templatePrefix&&this.removeTemplate(t.templatePrefix,n.origin),e.templatePrefix&&this.addTemplate(e.templatePrefix,n.origin),t.id&&this.removeIndex(t.id,n.origin),e.id&&this.addIndex(e.id,n.origin),t.id==e.id&&t.class==e.class||this.refreshMappings()}},{key:"app",get:function(){return this._app}},{key:"target_element",get:function(){return this._target_element},set:function(e){this._ua_event_handler&&(this._ua_event_handler.dispose(),delete this._ua_event_handler),e&&(this._ua_event_handler=new y.UAEventHandler(this,e)),this.forEach(function(t){return t.target=e}),this._target_element=e}},{key:"unitScale",get:function(){switch(this.model_layer.get("unit")){case"mm":case"cm":case"in":return this.app.PPM/10;case"px":default:return 1}}},{key:"root",get:function(){return this}},{key:"isReady",get:function(){return this._ready}},{key:"rootModel",get:function(){return this.model_layer}},{key:"stuck",get:function(){return!0}},{key:"data",get:function(){return Object.values(this.indexMap).reduce(function(e,t){var n=t.model;return e[n.id]=n.data,e},{})},set:function(e){for(var t in e){var n=this.findOrCreate(t);n&&n.set("data",e[t])}}},{key:"selected",get:function(){return(this._selected||[]).filter(function(e){return e.parent})},set:function(e){var t=this._selected;this._selected=e,this.trigger("selected",e,t)}},{key:"focused",get:function(){return this._focused},set:function(e){this._focused!==e&&(this._focused=e,this.invalidate())}},{key:"style",get:function(){return this._style},set:function(e){this._style=e,this._compiled_style=d.compile(e)}},{key:"hasTextProperty",get:function(){return!1}},{key:"eventMap",get:function(){return{"(root)":{"(descendant)":{added:this.onadded,removed:this.onremoved,change:this.onchanged}}}}}]),t}();n.default=b,Object.assign(b.prototype,{fit:h.default}),l.default.memoize(b.prototype,"unitScale",!1)},{"../core/logger":208,"../core/utils":216,"../event":226,"../event-map":221,"../model":254,"../style":257,"./component":155,"./container":156,"./fit/fit":169}],196:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./shape")),l=r(e("./mixins/rect-path")),f=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../const")),[1,2,10,20,50,50,50,50,50,50]),h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,l.default)(c.default)),u(t,[{key:"_draw",value:function(e){var t=this.model,n=t.lineWidth,r=void 0===n?1:n,o=t.fillStyle,i=void 0===o?"lightgray":o,a=t.font,u=void 0===a?"15px Arial":a,s=t.left,c=t.top,l=(t.rotation,t.origin),h=(t.margin,t.width),p=t.height,d=t.side,y=void 0===d?"bottom":d,v=t.strokeStyle,g=void 0===v?"#000000":v,m=t.scale,_=void 0===m?1:m;e.translate(s,c),e.beginPath();var b=Math.round(r/2);e.rect(-b,-b,h+2*b,p+2*b),e.clip(),e.beginPath(),e.rect(0,0,h,p),i&&(e.fillStyle=i,e.fill()),e.lineWidth=r,e.strokeStyle=g,e.stroke(),e.beginPath(),e.font=u;var w="bottom"!==y,x=w?0:p,k=4*p/5,O=2*p/3,P=1*p/2,j=3*p/5;w&&(k=p-k,O=p-O,P=p-P,j=p-1.5*p/5);var E=_*this.app.PPM/this.root.unitScale,M=Math.ceil(l/E),A=this.app.PPM/E,S=A<=1.1?1:f[Math.round(A)]||100;1!=S&&(M+=(S-M%S)%S);var T=Math.ceil(M*E),C=l+h;for(e.fillStyle=g;T<C;){if(M%10==0){e.moveTo(T-l,P),e.lineTo(T-l,x);var I=(M/10).toString(),R=e.measureText(I);e.fillText(I,T-l-R.width-6,j)}else M%5==0?(e.moveTo(T-l,O),e.lineTo(T-l,x)):(e.moveTo(T-l,k),e.lineTo(T-l,x));M+=S,T=Math.ceil(M*E)}}}]),t}();n.default=h,s.default.register("ruler",h)},{"../const":203,"./component":155,"./mixins/rect-path":184,"./shape":197}],197:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},s=function(e){return e&&e.__esModule?e:{default:e}}(e("./component")),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,s.default),a(t,[{key:"_post_draw",value:function(e){this.drawFill(e),this.drawStroke(e),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_post_draw",this).call(this,e)}}]),t}();n.default=c},{"./component":155}],198:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./ellipse")),l={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"ratio",name:"ratio",property:"ratio"},{type:"number",label:"wing",name:"wing",property:"wing"}]},f={ondragmove:function(e,t,n){n.controls;var r=n.model,o=r.cy,i=r.ry,a=(n.transcoordP2S(e.x,e.y).y-o)/i*100+100;a>=100?a=100:a<=0&&(a=0),n.set({ratio:a})}},h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"_draw",value:function(e){var t=this.model,n=t.ratio,r=void 0===n?30:n,o=t.wing,i=void 0===o?5:o,a=t.cx,u=t.cy,s=t.rx,c=t.ry;t.startAngle,t.endAngle,t.anticlockwise;if(!(i<3)){var l=1.5707963267948966,f=2*Math.PI/i,h=s-r/100*s,p=c-r/100*c;e.save(),e.beginPath(),e.translate(a,u),e.moveTo(s*Math.cos(-l),c*Math.sin(-l)),e.lineTo((s-h)*(Math.cos(f-l)+Math.cos(0-l))/2,(c-p)*(Math.sin(f-l)+Math.sin(0-l))/2);for(var d=1;d<i;d++)e.lineTo(s*Math.cos(f*d-l),c*Math.sin(f*d-l)),e.lineTo((s-h)*(Math.cos(f*(d+1)-l)+Math.cos(f*d-l))/2,(c-p)*(Math.sin(f*(d+1)-l)+Math.sin(f*d-l))/2);e.closePath(),e.restore()}}},{key:"controls",get:function(){var e=this.model,t=e.cx,n=e.cy,r=e.ry;return[{x:t,y:n-r+r*(e.ratio/100),handler:f}]}},{key:"nature",get:function(){return l}}]),t}();n.default=h,s.default.memoize(h.prototype,"controls",!1),s.default.register("star",h)},{"./component":155,"./ellipse":168}],199:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e("./component")),s=r(e("./mixins/rect-path")),c=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,s.default)(u.default)),t}();n.default=c,u.default.register("text",c)},{"./component":155,"./mixins/rect-path":184}],200:[function(e,t,n){"use strict";function r(e){var t=e.substr(2,e.length-3).trim().replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".").filter(function(e){return!!e.trim()}),n=t.slice(1);return{match:e,target:t[0],accessor:n.length>0?function(e){return n.reduce(function(e,t){return e?e[t]:void 0},e)}:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){if(e){var n=String(e),i=(n.match(/#{(\S*)}/gi)||[]).map(function(e){return r(e)}),a=(n.match(/\${[^}]*}/gi)||[]).map(function(e){return r(e)});if(0!=i.length||0!=a.length)return function(){var e=n;return i.forEach(function(n){var r=(0,o.objToVal)(n.accessor(t.get(n.target)));e=e.replace(n.match,void 0===r?"":r)}),a.forEach(function(n){var r=t.root.findById(n.target),i=(0,o.objToVal)(n.accessor(r&&r.data));e=e.replace(n.match,void 0===i?"":i)}),e}}};var o=e("../../core/utils"),i=function(e){return e}},{"../../core/utils":216}],201:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./shape")),l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"_draw",value:function(e){var t=this.model,n=t.x1,r=t.y1,o=t.x2,i=t.y2,a=t.x3,u=t.y3;e.beginPath(),e.moveTo(n,r),e.lineTo(o,i),e.lineTo(a,u),e.closePath()}},{key:"contains",value:function(e,t){for(var n=this.model,r=[n.x1,n.y1,n.x2,n.y2,n.x3,n.y3],o=!1,i=0;i<r.length;i+=2){var a=(i+2)%r.length,u=r[i],s=r[i+1],c=r[a],l=r[a+1];s>t!=l>t&&e<(c-u)*(t-s)/(l-s)+u&&(o=!o)}return o}},{key:"mutable",get:function(){return!0}},{key:"path",get:function(){var e=this.model;return[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2},{x:e.x3,y:e.y3}]},set:function(e){this.set({x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,x3:e[2].x,y3:e[2].y})}}]),t}();n.default=l,s.default.memoize(l.prototype,"path",!1),s.default.register("triangle",l)},{"./component":155,"./shape":197}],202:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("./component")),c=r(e("./shape")),l=r(e("./mixins/rect-path")),f={mutable:!1,resizable:!0,rotatable:!1,properties:[]},h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,(0,l.default)(c.default)),u(t,[{key:"_draw",value:function(e){var t=this.bounds,n=t.left,r=t.top,o=t.width,i=t.height;e.beginPath(),e.rect(n,r,o,i)}},{key:"text",get:function(){return this.get("id")}},{key:"rotatable",get:function(){return!1}},{key:"nature",get:function(){return f}}]),t}();n.default=h,s.default.register("variable",h)},{"./component":155,"./mixins/rect-path":184,"./shape":197}],203:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.NOTHING={},n.MODE_VIEW=0,n.MODE_EDIT=1,n.MODE_SHIFT=2,n.MAX_UNDO_SIZE=30,n.DPPX="undefined"==typeof window?1:window.devicePixelRatio||(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1,n.GESTURES=["mousemove","mouseup","mousedown","mouseout","wheel","click","touchstart","touchmove","touchend","dblclick"],n.KEYEVENTS=["keydown","keyup"],n.DEFAULT={ALPHA:1,FONT_SIZE:15,FONT_FAMILY:"serif",FONT_COLOR:"black",TEXT_ALIGN:"center",TEXT_BASELINE:"middle",TEXT_WRAP:!1,BOLD:!1,ITALIC:!1,STROKE_STYLE:"#999",LINE_DASH:"solid"}},{}],204:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Stack=n.List=void 0,n.withList=function(){for(var e in i)this[e]=i[e]},n.withStack=function(){for(var e in i)this[e]=i[e]};var i=r(e("./list")),a=r(e("./stack")),u=n.List=function e(){o(this,e)},s=n.Stack=function e(){o(this,e)};u.prototype=i,s.prototype=a},{"./list":207,"./stack":214}],205:[function(e,t,n){"use strict";function r(e,t,n,r){if(!n)return!0;if("object"==(void 0===n?"undefined":a(n))){for(var o in n){var i=n[o];e[t].apply(e,[o,i])}return!1}return!c.test(n)||(n.split(c).forEach(function(n){return e[t].apply(e,[n].concat(r))}),!1)}function o(e,t){e.forEach(function(e){return e.callback.apply(e.ctx,t)})}function i(e,t){e.forEach(function(e){return f.delegate.apply(e,t)})}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils")),s=e("./collection"),c=/\s+/,l=["on","off","once","delegate_on","delegate_off","trigger","listenTo"],f={withEvent:function(){var e=this;l.forEach(function(t){return e[t]=f[t]})},on:function(e,t,n){return r(this,"on",e,[t,n])&&t?(this._listeners||(this._listeners={}),(this._listeners[e]||(this._listeners[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!r(this,"once",e,[t,n])||!t)return this;var o=this,i=u.once(function(){o.off(e,i),t.apply(o,arguments)});i._callback=t,this.on(e,i,n)},off:function(e,t,n){if(!this._listeners||!r(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._listeners=void 0,this;var o;o=e?[e]:Object.keys(this._listeners);for(var i=0;i<o.length;i++){var a=o[i],u=this._listeners[a];if(u){var s=[];if(this._listeners[a]=s,t||n)for(var c=0;c<u.length;c++){var l=u[c];(t&&t!==l.callback&&t!==l.callback._callback||n&&n!==l.context)&&s.push(l)}s.length||delete this._listeners[a]}}return this},delegate_on:function(e){return this._delegators||(this._delegators=new s.List),this._delegators.append(e),this},delegate_off:function(e){return this._delegators?(this._delegators.remove(e),this):this},delegate:function(){if(this._delegators&&this._delegators.size()>0&&i(this._delegators,arguments),!this._listeners)return this;var e=arguments.length-1,t=arguments[e];arguments[e]={origin:t.origin,name:t.name,deliverer:this};var n=this._listeners[t.name],r=this._listeners["(all)"];return n&&o(n,arguments),r&&o(r,arguments),this},trigger:function(e){var t=[].slice.call(arguments,1);if(t.push({origin:this,name:e,deliverer:this}),this._delegators&&this._delegators.size()>0&&i(this._delegators,t),!this._listeners)return this;if(!r(this,"trigger",e,t))return this;var n=this._listeners[e],a=this._listeners["(all)"];return n&&o(n,t),a&&o(a,t),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var o=!t&&!n;n||"object"!=(void 0===t?"undefined":a(t))||(n=this),e&&((r={})[e._listenId]=e);for(var i in r){var s=r[i];s.off(t,n,this),(o||u.isEmpty(s._events))&&delete this._listeningTo[i]}return this}},h={listenTo:"on",listenToOnce:"once"};for(var p in h){var d=h[p];f[p]=function(e,t,n){this._listeningTo||(this._listeningTo={});var r=this._listeningTo;return e._listenId||(e._listenId=u.uniqueId("l")),r[e._listenId]=e,n||"object"!=(void 0===t?"undefined":a(t))||(n=this),e[d](t,n,this),this}}n.default=f},{"./collection":204,"./utils":216}],206:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./logger");Object.defineProperty(n,"logger",{enumerable:!0,get:function(){return r(o).default}});var i=e("./event");Object.defineProperty(n,"event",{enumerable:!0,get:function(){return r(i).default}});var a=e("./mixin");Object.defineProperty(n,"mixin",{enumerable:!0,get:function(){return r(a).default}})},{"./event":205,"./logger":208,"./mixin":210}],207:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.insertAt=function(e,t){return this.__collection__?(-1==(e=this.__collection__.indexOf(t))&&this.__collection__.splice(e,0,t),this):this},n.append=function(e){return this.__collection__||(this.__collection__=[]),-1==this.__collection__.indexOf(e)&&this.__collection__.push(e),this},n.prepend=function(e){return this.__collection__||(this.__collection__=[]),-1==this.__collection__.indexOf(e)&&this.__collection__.unshift(e),this},n.remove=function(e){if(!this.__collection__)return this;var t=this.__collection__.indexOf(e);return t>=0&&this.__collection__.splice(t,1),this},n.getAt=function(e){if(this.__collection__)return this.__collection__[e]},n.forEach=function(e,t){this.__collection__&&this.__collection__.forEach(e,t)},n.indexOf=function(e){if(this.__collection__)return this.__collection__.indexOf(e)},n.size=function(){return this.__collection__?this.__collection__.length:0},n.clear=function(){this.__collection__=[]},n.moveForward=function(e){var t=this.indexOf(e);-1!=t&&0!=t&&(this.__collection__[t]=this.__collection__[t-1],this.__collection__[t-1]=e)},n.moveBackward=function(e){var t=this.indexOf(e);-1!=t&&t!=this.size()-1&&(this.__collection__[t]=this.__collection__[t+1],this.__collection__[t+1]=e)},n.moveToHead=function(e){var t=this.indexOf(e);if(-1!=t&&0!=t){var n=this.__collection__.splice(0,t),r=this.__collection__.splice(1);this.__collection__=this.__collection__.concat(n,r)}},n.moveToTail=function(e){var t=this.indexOf(e);if(-1!=t&&t!=this.size()-1){var n=this.__collection__.splice(0,t),r=this.__collection__.splice(1);this.__collection__=n.concat(r,this.__collection__)}}},{}],208:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});"undefined"==typeof window||window,n.error=function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=[];n.forEach(function(e){return e&&e.stack&&o.push(e.stack)}),(e=console).error.apply(e,["[ERROR]"].concat(n,[o.join(" ")]))},n.warn=function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=[];n.forEach(function(e){return e&&e.stack&&o.push(e.stack)}),(e=console).warn.apply(e,["[WARN]"].concat(n,[o.join(" ")]))},n.debug=function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).log.apply(e,["[DEBUG]"].concat(n))}},{}],209:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.intercept=function(e,t,n){var i=e.__lookupGetter__(t);i?n?e.__defineGetter__(t,function(){return void 0===this.__cache__[t]&&(this.__cache__[t]=i.call(this)),r.clone(this.__cache__[t])}):e.__defineGetter__(t,function(){return void 0===this.__cache__[t]&&(this.__cache__[t]=i.call(this)),this.__cache__[t]}):(0,o.error)(t+" is not defined in "+e.constructor.name)},n.reset=function(e){e.__cache__={}},n.clear=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0==n.length?e.__cache__={}:n.forEach(function(t){return delete e.__cache__[t]})};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils")),o=e("./logger")},{"./logger":208,"./utils":216}],210:[function(e,t,n){"use strict";function r(e,t){if(t instanceof Array)t.forEach(function(t){return r(e,t)});else{if(e.mixedIn=e.hasOwnProperty("mixedIn")?e.mixedIn:[],e.mixingIn=e.hasOwnProperty("mixingIn")?e.mixingIn:[],e.mixedIn.indexOf(t)>=0)return e;if(e.mixingIn.indexOf(t)>=0)throw new Error("found cyclic dependencies between "+e.mixingIn);e.mixingIn.push(t),t.call(e),e.mixingIn.pop(),e.mixedIn.push(t)}return e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],211:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(!e)return r;var t=String(e).trim().replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".").filter(function(e){return!!e.trim()});return t.length>0?function(e){return t.reduce(function(e,t){return e?e[t]:void 0},e)}:r};var r=function(e){return e}},{}],212:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./logger"),a=function(e){return e&&e.__esModule?e:{default:e}}(e("./mixin")),u=new WeakSet,s=function(){function e(t,n){r(this,e),this.counters={},this.references={},this.creator=t,this.disposer=n,u.add(this)}return o(e,null,[{key:"residents",get:function(){return u}}]),o(e,[{key:"dispose",value:function(){if(this.disposer)for(var e in this.references)this.disposer.call(null,e,this.references[e]);delete this.references,delete this.counters}},{key:"add",value:function(e,t){var n=this.references[e];{if(!n){if(!t){if(!this.creator)return void(0,i.error)("Reference target("+t+") is not allowed. Reference creator should be defined.");if(!(t=this.creator.call(null,e)))return void(0,i.error)("Reference creator built "+t+".")}var r=this,t=(0,a.default)(t,function(){var e=this;this.release=function(){return r.release(e)}});return this.references[e]=t,this.counters[e]=1,t}n==t?(0,i.error)("Reference ID and target duplicate"):(0,i.error)("Reference ID duplicate")}}},{key:"get",value:function(e,t){var n=this.references[e];if(n){if(!this.counters.hasOwnProperty(e))return void(0,i.error)("No Referenced Count");this.counters[e]++}else t&&(n=this.add(e));return n}},{key:"_id",value:function(e){for(var t in this.references)if(this.references[t]===e)return t;return-1}},{key:"release",value:function(e){var t=this._id(e),n=this.references[t];n?(this.counters[t]--,0==this.counters[t]&&(this.disposer&&this.disposer.call(null,t,n),delete this.references[t],delete this.counters[t],(0,i.debug)("RELEASED",t))):(0,i.error)("No Referenced ID")}},{key:"ids",get:function(){return Object.keys(this.references)}}]),e}();n.default=s},{"./logger":208,"./mixin":210}],213:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){!e.brake&&e.dirty&&a(e)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(0,e("./utils").debounce)(function(e){e.brake||e.take()},1e3,{leading:!0,trailing:!1}),u=function(){function e(t,n){r(this,e),this.brake=!1,this.dirty=!1,this.state_holder=t,this.timecapsule=n,this.timecapsule.snapshot_taker=this}return i(e,[{key:"dispose",value:function(){delete this.state_holder,delete this.timecapsule}},{key:"touch",value:function(){this.dirty=!0,o(this)}},{key:"take",value:function(e){(this.dirty||e)&&(this.timecapsule.snapshot(this.state_holder.state),this.dirty=!1)}},{key:"brake",get:function(){return this._brake},set:function(e){this._brake=!!e,o(this)}}]),e}();n.default=u},{"./utils":216}],214:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.push=function(e){throw new Error("Not Implemented Yet")},n.pop=function(e){throw new Error("Not Implemented Yet")}},{}],215:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./logger"),a=function(){function e(t,n){r(this,e),!(t=Number(t))||t<=0?((0,i.error)("TimeCapsule maxsize should be greater than 0.",t),this.maxsize=10):this.maxsize=t,this.reset(),n&&this.snapshot(n)}return o(e,[{key:"dispose",value:function(){this.reset()}},{key:"snapshot",value:function(e){this.q.splice(this.pos+1,this.q.length-this.pos+1,e),this.q.length>this.maxsize&&this.q.splice(0,this.q.length-this.maxsize),this.pos=this.q.length-1}},{key:"forward",value:function(){if(this.snapshot_taker&&this.snapshot_taker.take(),this.forwardable)return this.q[++this.pos];(0,i.warn)("Not forwardable.")}},{key:"backward",value:function(){if(this.snapshot_taker&&this.snapshot_taker.take(),this.backwardable)return this.q[--this.pos];(0,i.warn)("Not backwardable.")}},{key:"reset",value:function(){this.q=[],this.pos=-1}},{key:"current",get:function(){if(-1!==this.pos)return this.q[this.pos];(0,i.warn)("Non state has been recorded.")}},{key:"length",get:function(){return this.q.length}},{key:"forwardable",get:function(){return this.pos<this.q.length-1}},{key:"backwardable",get:function(){return this.pos>0}},{key:"snapshot_taker",get:function(){return this._snapshot_taker},set:function(e){this._snapshot_taker=e}}]),e}();n.default=a},{"./logger":208}],216:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"!=(void 0===e?"undefined":a(e))&&(e={});for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach(function(t){for(var n in t)!function(n){"object"!=a(t[n])?e[n]=t[n]:t[n].length>0?e[n]=t[n].map(function(e){return"object"!=a(t[n])?e:o({},e)}):e[n]=o(e[n],t[n])}(n)}),e}function i(e,t,n){if(!e||!t)return e;for(var r in t){if(e[r]&&n)throw new Error('utils.push attempted to overwrite "'+r+'" while running in protected mode');"object"==a(e[r])&&"object"==a(t[r])?i(e[r],t[r]):e[r]=t[r]}return e}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.clone=function(e){return JSON.parse(JSON.stringify(e))},n.merge=o,n.push=i;var u=e("lodash/debounce");Object.defineProperty(n,"debounce",{enumerable:!0,get:function(){return r(u).default}});var s=e("lodash/throttle");Object.defineProperty(n,"throttle",{enumerable:!0,get:function(){return r(s).default}});var c=e("lodash/once");Object.defineProperty(n,"once",{enumerable:!0,get:function(){return r(c).default}}),n.uniqueId=function(e){return""+(e||"")+ ++f};var l=e("lodash/isEmpty");Object.defineProperty(n,"isEmpty",{enumerable:!0,get:function(){return r(l).default}}),n.objToVal=function(e){for(;e&&"object"===(void 0===e?"undefined":a(e));){var t=e;for(var n in e){e=e[n];break}if(e===t){e=void 0;break}}return e};var f=0},{"lodash/debounce":109,"lodash/isEmpty":117,"lodash/once":130,"lodash/throttle":135}],217:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){n.type;var r=n.subType,o=n.from,i=n.to,a=n.colors;switch(r){case"linear":u=t.createLinearGradient(o.x,o.y,i.x,i.y);break;case"radial":u=t.createRadialGradient(o.x,o.y,o.r,i.x,i.y,i.r);break;default:var u=t.createLinearGradient(o.x,o.y,i.x,i.y)}a&&(a.forEach(function(e){u.addColorStop(e.endPoint,e.color)}),t.fillStyle=u,t.fill())}},{}],218:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){var r=a[n.type];r&&r(e,t,n)};var o=r(e("./gradation")),i=r(e("./shadow")),a={gradation:o.default,shadow:i.default}},{"./gradation":217,"./shadow":219}],219:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setShadow=function(e,t,n){var o=t.left,i=void 0===o?0:o,a=t.top,u=void 0===a?0:a,s=t.blurSize,c=void 0===s?0:s,l=t.color,f=void 0===l?"transparent":l,h=n.rootModel.get("scale")||r;e.shadowOffsetX=i*h.x,e.shadowOffsetY=u*h.y,e.shadowBlur=c*h.x,e.shadowColor=f},n.resetShadow=function(e){e.shadowColor="transparent"};var r={x:1,y:1}},{}],220:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={};n.default={register:function(e,t){r[e]=t},unregister:function(e){delete r[e]},get:function(e){return r[e]}}},{}],221:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.EventMap=void 0;var o=e("./event-map");Object.defineProperty(n,"EventMap",{enumerable:!0,get:function(){return r(o).default}});r(e("./text-editor-lite")),r(e("./move-handler"))},{"./event-map":220,"./move-handler":222,"./text-editor-lite":223}],222:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../const"));var o=r(e("./event-map")),i=r(e("../model/duplicate")),a=(r(e("../components/component")),r(e("../components/container")),r(e("../components/group")),r(e("../command/command-change"))),u=r(e("../command/command-migrate")),s=0,c=2,l=3,f=4,h=(0,e("../core/utils").debounce)(function(e,t,n){if(n)e.focused=null;else{var r=[];t[0].parent.isGroup()?e.focused=t[0].parent:(t.forEach(function(e){e.path.forEach(function(t){r.push(e.transcoordS2T(t.x,t.y))})}),e.focused=e.capturePath(r,t))}},300);o.default.register("move-handler",{"model-layer":{"(descendant)":{dragstart:function(e,t){var n=t.origin,r=t.deliverer;if(!n.stuck){var o=r.selected,u=r.selected.filter(function(e){return!e.stuck});if(o.length!==u.length&&(o=r.selected=u),0!=o.length){var c=o[0].transcoordC2S(e.offsetX,e.offsetY);c=o[0].transcoordS2P(c.x,c.y),this.last_pos=c,this.direction=s,r.focused=o[0].parent,e.altKey?(r.selected=o.map(function(e){var t=(0,i.default)(e);return e.parent.addComponent(t),t}),this.duplicates=r.selected.map(function(e){return{component:e}})):this.changes=a.default.before(o)}}},dragmove:function(e,t){var n=t.origin,r=t.deliverer;if(!n.stuck){var o=r.selected;if(0!=o.length){var i=o[0].transcoordC2S(e.offsetX,e.offsetY),a=i.x,u=i.y,p=o[0].transcoordS2P(a,u);e.shiftKey?this.direction==c&&(this.direction=s):this.direction=c;var d=p.x-this.last_pos.x,y=p.y-this.last_pos.y;if(this.direction==s){if(d*d+y*y<25)return;Math.abs(d)>Math.abs(y)?this.direction=l:this.direction=f}this.direction==l?y=0:this.direction==f&&(d=0),o.forEach(function(e){e.move({x:d,y:y})}),this.last_pos=p,h(r,o)}}},dragend:function(e,t){var n=t.origin,r=t.deliverer;if(!n.stuck){var o=r.selected;if(0!=o.length){var i=n.parent,s=r.focused||t.deliverer;if(this.changes)if(s&&s!==i){var c=this.changes.map(function(e){var t=e.component;return e.before,{component:t,to_container:s}});r.app.commander.execute(new u.default({changes:c}))}else a.default.after(this.changes,r.app.commander);else if(this.duplicates){this.duplicates=this.duplicates.map(function(e){return e.to_container=s,e});var l=new u.default({changes:this.duplicates});r.app.commander.execute(l)}o.forEach(function(e){e.parent&&e.parent.calculateBounds&&e.parent.calculateBounds()}),this.last_pos=null,this.changes=null,h(r,o,!0)}}}}},"(root)":{"(self)":{keydown:function(e,t){var n=t.origin,r=t.deliverer,o={},i=e.shiftKey?n.rootModel.MPP:1;switch(e.which){case 37:o.x=-i,o.y=0;break;case 38:o.x=0,o.y=-i;break;case 39:o.x=i,o.y=0;break;case 40:o.x=0,o.y=i;break;default:return}var u=r.selected;a.default.around(u,r.app.commander,function(){u.forEach(function(e){!e.stuck&&e.move(o)})})}}}})},{"../command/command-change":150,"../command/command-migrate":151,"../components/component":155,"../components/container":156,"../components/group":173,"../const":203,"../core/utils":216,"../model/duplicate":253,"./event-map":220}],223:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=0,n=1,r=e;r;){t+=r.get("rotation")||0;var o=r.get("scale")||{x:1,y:1},i=o.x,a=o.y;n*=Math.max(i,a)||1,r=r.parent}return{rotation:t,scale:n}}function i(e){function t(t){var n={left:0,top:0},r=F*a(e,t,Z,X);switch(H.style.height=r+"px",P){case"top":case"hanging":break;case"bottom":case"alphabetic":n.top=K-r;break;case"middle":default:n.top=K/2-r/2}if(!g){var o=u(e,t,Z,X);switch(H.style.width=o+"px",k){case"right":case"end":n.left=X-o;break;case"left":case"start":break;case"center":case"justify":default:n.left=(X-o)/2}}H.style.marginLeft=n.left+"px",H.style.marginTop=n.top+"px";var i="translate("+U.x+"px, "+U.y+"px) scale("+q+") rotate("+f+"rad)";["-webkit-","-moz-","-ms-","-o-",""].forEach(function(e){H.style[e+"transform"]=i,H.style[e+"transform-origin"]=-n.left+"px "+-n.top+"px"})}if(e.hasTextProperty&&!e.textHidden){var n=e.model,r=n.text,i=void 0===r?"":r,c=n.rotation,f=void 0===c?0:c,h=n.bold,p=void 0===h?s.DEFAULT.BOLD:h,d=n.italic,y=void 0===d?s.DEFAULT.ITALIC:d,v=n.textWrap,g=void 0===v?s.DEFAULT.TEXT_WRAP:v,m=n.fontFamily,_=void 0===m?s.DEFAULT.FONT_FAMILY:m,b=n.fontColor,w=void 0===b?s.DEFAULT.FONT_COLOR:b,x=n.textAlign,k=void 0===x?s.DEFAULT.TEXT_ALIGN:x,O=n.textBaseline,P=void 0===O?s.DEFAULT.TEXT_BASELINE:O,j=n.paddingTop,E=void 0===j?0:j,M=n.paddingBottom,A=void 0===M?0:M,S=n.paddingLeft,T=void 0===S?0:S,C=n.paddingRight,I=void 0===C?0:C,R=n.fontSize,L=void 0===R?s.DEFAULT.FONT_SIZE:R,D=n.lineHeight,F=void 0===D?1.2*L:D,B=e.bounds,N=B.left,z=B.top,G=B.width,Y=B.height;e.textHidden=!0;var H=document.createElement("textarea");s.GESTURES.forEach(function(e){H.addEventListener(e,function(e){e.stopPropagation()},!0)}),s.KEYEVENTS.forEach(function(e){H.addEventListener(e,function(e){e.stopPropagation()},!0)});var U=e.transcoordS2C(N,z),W=o(e),f=W.rotation,q=W.scale,X=G-T-I,V=X,K=Y-E-A;switch(H.style.position="absolute",H.style.width=V+"px",H.style.height=K+"px",H.style.paddingLeft=Math.max(T,0)+"px",H.style.paddingRight=I+"px",H.style.paddingTop=Math.max(E,0)+"px",H.style.paddingBottom=A+"px",H.value=i,H.style.fontFamily=_,H.style.fontSize=L+"px",H.style.lineHeight=F+"px",H.style.overflow="hidden",H.style.resize="none",H.style.outline="none",H.style.border=0,H.style.backgroundColor="transparent",H.style.display="inline-block",H.style.color=w,p&&(H.style.fontWeight="bold"),y&&(H.style.fontStyle="italic"),k){case"right":case"end":H.style.textAlign="right";break;case"justify":H.style.textAlign="justify";break;case"left":case"start":H.style.textAlign="left";break;case"center":default:H.style.textAlign="center"}var Z=[p,y,L+"px",_].filter(function(e){return!!e}).join(" ");t(i);var Q=e.root.target_element;Q.appendChild(H),H.select();var J=!1;H.onkeydown=function(e){"Escape"!=e.code&&(e.shiftKey||"Enter"!=e.code&&"NumpadEnter"!=e.code)?setTimeout(function(){t(H.value)}):(J=$.skipUpdate="Escape"==e.code,document.createEvent?H.dispatchEvent($):H.fireEvent($.eventType,$))};var $;document.createEvent?($=document.createEvent("HTMLEvents")).initEvent("blur",!0,!1):($=document.createEventObject()).eventType="blur";var ee=e.root.selected;H.addEventListener("blur",function t(n){e.root.selected=ee,e.textHidden=!1,H.removeEventListener("blur",t,!1),H.parentElement&&H.parentElement.removeChild(H),Q.focus(),n.skipUpdate||J||e.app.commander.execute(new l.default({changes:[{component:e,before:{text:i},after:{text:H.value}}]}))},!1)}}function a(e,t,n,r){var o,i=e.getContext();return i.save(),i.font=n,o=(0,f.default)(i,t,r,e.get("textWrap")).length,i.restore(),o}function u(e,t,n,r){var o=t.split("\n"),i=r,a=e.getContext();return a.save(),a.font=n,o.forEach(function(e){var t=a.measureText(e).width;t>i&&(i=t)}),a.restore(),i}var s=e("../const"),c=r(e("./event-map")),l=r(e("../command/command-change")),f=r(e("../components/drawer/text-wrapper"));c.default.register("text-editor",{"(root)":{"(self)":{keydown:function(e,t){t.origin;var n=t.deliverer.selected;return!(1!==n.length||!n[0].hasTextProperty||"Enter"!=e.code&&"NumpadEnter"!=e.code||(i(n[0]),e.preventDefault(),0))}}},"model-layer":{"(descendant)":{dblclick:function(e,t){i(t.origin)}}}})},{"../command/command-change":150,"../components/drawer/text-wrapper":166,"../const":203,"./event-map":220}],224:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e("./event-pump")),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../model/selector")),u=function(){function e(t){r(this,e),this.eventMaps=[],this.root=t,t.eventMap&&this.add(t,t.eventMap)}return o(e,[{key:"stop",value:function(){this.eventMaps.forEach(function(e){return e.eventPump.stop()})}},{key:"add",value:function(e,t){var n=this;if(this.root){for(var r in t)!function(r){var o=t[r];if("(self)"===r&&void 0===e.on)throw new Error("(self) selector not available when deliverer is not a event handlable object.");a.select(r,n.root,e).forEach(function(r){var a=new i.default(r);a.on(e,o),a.start(),n.eventMaps.push({eventPump:a,listener:e,handlerMap:t,deliverer:r})})}(r)}}},{key:"remove",value:function(e,t){for(var n=this.eventMaps.slice(0),r=0;r<n.length;r++){var o=n[r];o.listener!==e||t&&o.handlerMap!==t||(this.eventMaps.splice(r,1),o.eventPump.dispose())}}},{key:"clear",value:function(){this.eventMaps.slice(0).forEach(function(e){return e.eventPump.dispose()}),this.eventMaps=[]}},{key:"dispose",value:function(){this.stop(),this.clear()}},{key:"root",set:function(e){this._root=e},get:function(){return this._root}}]),e}();n.default=u},{"../model/selector":255,"./event-pump":225}],225:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n,r,o){for(var i in n){var a=n[i];if(u.match(i,r.origin,t,e))for(var s in a){var c=a[s];s==r.name&&(r.listener=t,c.apply(t,o))}}}function i(){var e=arguments,t=e[e.length-1],n=this.event_pump;n.listeners.forEach(function(r){o(n.deliverer,r.listener,r.cloned_handlers,t,e)})}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../model/selector")),s=e("../core/logger"),c=function(){function e(t){if(r(this,e),void 0===t.on)throw new Error("Deliverer should be a event handlable object.");this.deliverer=t,this.listeners=[]}return a(e,[{key:"start",value:function(){this.deliverer.on("(all)",i,{event_pump:this})}},{key:"stop",value:function(){this.deliverer.off("(all)",i)}},{key:"on",value:function(e,t){var n=Object.assign({},t);Object.keys(n).forEach(function(t){if(0==t.indexOf("?")){var r=n[t],o=t.substr(1),i=e.get(o);delete n[t],i?n[i]=r:(0,s.warn)("EventPump#on","variable #{selector} is not evaluated on listener")}}),this.listeners.push({listener:e,handlers:t,cloned_handlers:n})}},{key:"off",value:function(e,t){for(var n=0;n<this.listeners.length;n++){var r=this.listeners[n];r.listener!==e||t&&r.handlers!==t||this.listeners.splice(n,1)}}},{key:"clear",value:function(){this.listeners=[]}},{key:"dispose",value:function(){this.stop(),this.clear()}}]),e}();n.default=c},{"../core/logger":208,"../model/selector":255}],226:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./event-engine");Object.defineProperty(n,"Engine",{enumerable:!0,get:function(){return r(o).default}});var i=e("./ua-event-handler");Object.defineProperty(n,"UAEventHandler",{enumerable:!0,get:function(){return r(i).default}})},{"./event-engine":224,"./ua-event-handler":227}],227:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return t.touches?t.touches[0]?h={x:t.offsetX,y:t.offsetY}:h:{x:t.offsetX,y:t.offsetY}}function a(e,t){return e.capture(t.offsetX,t.offsetY)}function u(e,t,n){if(e){n.type=t;var r="on"+t;e[r]&&e[r](n),n.isPropagationStopped()||e.trigger(t,n)}}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=(r(e("../components/component")),r(e("../components/container")),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../const"))),l=e("../core/utils"),f={NORMAL:0,DRAGGABLE:1,DRAGGING:2},h={},p=function(){function e(t,n){o(this,e),this._type=n.type,this._ctrlKey=n.ctrlKey,this._altKey=n.altKey,this._shiftKey=n.shiftKey,this._metaKey=n.metaKey;var r=i(t,n);this._offsetX=r.x,this._offsetY=r.y,"wheel"==n.type&&(this.deltaX=n.deltaX,this.deltaY=n.deltaY,this.deltaZ=n.deltaZ)}return s(e,[{key:"stopPropagation",value:function(){this._stop_=!0}},{key:"isPropagationStopped",value:function(){return this._stop_}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"altKey",get:function(){return this._altKey}},{key:"ctrlKey",get:function(){return this._ctrlKey}},{key:"shiftKey",get:function(){return this._shiftKey}},{key:"metaKey",get:function(){return this._metaKey}}]),e}(),d=(0,l.throttle)(function(e){e.status===f.DRAGGING?u(e.last_target,"dragmove",e.__dragmove_e):delete e.__dragmove_e},30),y=function(){function e(t,n){var r=this;o(this,e),this.container=t,this.html_element=n,this.status=f.NORMAL,this.last_target=null,this.gesture_handlers=c.GESTURES.map(function(e){return r.gestureHandlerBuilder(e)}),this.keyevent_handlers=c.KEYEVENTS.map(function(e){return r.keyeventHandlerBuilder(e)}),c.GESTURES.forEach(function(e,t){return n.addEventListener(e,r.gesture_handlers[t])}),c.KEYEVENTS.forEach(function(e,t){return n.addEventListener(e,r.keyevent_handlers[t])}),n.tabIndex=1}return s(e,[{key:"dispose",value:function(){var e=this;c.GESTURES.forEach(function(t,n){return e.html_element.removeEventListener(t,e.gesture_handlers[n])}),c.KEYEVENTS.forEach(function(t,n){return e.html_element.removeEventListener(t,e.keyevent_handlers[n])}),delete this.gesture_handlers,delete this.keyevent_handlers,delete this.last_target}},{key:"gestureHandlerBuilder",value:function(e){var t=this["on"+e].bind(this),n=this.html_element;return function(e){return t(new p(n,e))&&e.preventDefault(),!1}}},{key:"keyeventHandlerBuilder",value:function(e){return this["on"+e].bind(this)}},{key:"onclick",value:function(e){return u(a(this.container,e),e.type,e),this.last_target=null,!1}},{key:"ondblclick",value:function(e){return u(a(this.container,e),e.type,e),this.last_target=null,!1}},{key:"onkeydown",value:function(e){return this.container.trigger(e.type,e),!1}},{key:"onkeyup",value:function(e){return this.container.trigger(e.type,e),!1}},{key:"onmousemove",value:function(e){switch(this.status){case f.DRAGGABLE:this.status=f.DRAGGING,u(this.last_target,"dragstart",this.__dragstart_e),this.__dragmove_e=e,d(this);break;case f.DRAGGING:this.__dragmove_e=e,d(this);break;default:var t=a(this.container,e);this.last_target!=t&&(this.last_target&&u(this.last_target,"mouseleave",e),t&&u(t,"mouseenter",e)),u(t,e.type,e),this.last_target=t}return!1}},{key:"onmousedown",value:function(e){switch(this.status){case f.DRAGGING:u(this.last_target,"dragend",e),this.last_target=null,this.status=f.NORMAL;break;default:var t=a(this.container,e);this.last_target=t,this.status=f.DRAGGABLE,this.__dragstart_e=e,u(t,e.type,e)}return!1}},{key:"onmouseup",value:function(e){switch(this.status){case f.DRAGGING:u(this.last_target,"dragend",e);break;default:u(a(this.container,e),e.type,e)}return this.last_target=null,this.status=f.NORMAL,!1}},{key:"onmouseout",value:function(e){var t=a(this.container,e);switch(this.status){case f.DRAGGING:u(this.last_target,"dragend",e);break;default:if(this.last_target&&this.last_target===t)return;this.last_target&&u(this.last_target,e.type,e)}return this.last_target=null,this.status=f.NORMAL,!1}},{key:"ontouchstart",value:function(e){var t=a(this.container,e);return this.last_target=t,this.status=f.DRAGGABLE,u(t,"mousedown",e),!1}},{key:"ontouchmove",value:function(e){switch(this.status){case f.DRAGGABLE:this.status=f.DRAGGING,u(this.last_target,"dragstart",e),u(this.last_target,"dragmove",e);break;case f.DRAGGING:u(this.last_target,"dragmove",e);break;default:var t=a(this.container,e);this.last_target!=t&&(this.last_target&&u(this.last_target,"mouseleave",e),t&&u(t,"mouseenter",e)),u(t,e.type,e),this.last_target=t}return!1}},{key:"ontouchend",value:function(e){switch(this.status){case f.DRAGGING:u(this.last_target,"dragend",e);break;default:var t=a(this.container,e);u(t,"mouseup",e),u(t,"click",e)}return this.last_target=null,this.status=f.NORMAL,!1}},{key:"onwheel",value:function(e){return u(a(this.container,e),e.type,e),!0}}]),e}();n.default=y},{"../components/component":155,"../components/container":156,"../const":203,"../core/utils":216}],228:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.emphasize=function(e){e.hasOwnProperty("_backupStrokeStyle")||(e._backupStrokeStyle=e.model.strokeStyle,e.set("strokeStyle","#f26522"),e.hasOwnProperty("_backupLineWidth")||(e._backupLineWidth=e.model.lineWidth,e.set("lineWidth",e.model.lineWidth+5)))},n.normalize=function(e){e.hasOwnProperty("_backupStrokeStyle")&&(e.set("strokeStyle",e._backupStrokeStyle),delete e._backupStrokeStyle,e.hasOwnProperty("_backupLineWidth")&&(e.set("lineWidth",e._backupLineWidth),delete e._backupLineWidth))}},{}],229:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){return{left:-e.x,top:-e.y,width:m,height:M}}function s(e,t,n,r){return{left:m-e.x,top:_-e.y,origin:b-e.x,width:t-m,height:M}}function c(e,t,n,r){var o={x:-e.x+w+M/2,y:-e.y+x+(n-x)/2},i=p.default.transcoordRR(-e.x+w,-e.y+x,o,O);return{left:i.x-(n-x),top:i.y,origin:k-e.y,width:n-x,height:M}}function l(e){var t=e.get("translate");return{left:-t.x,top:-t.y,width:e.canvas.width/g.DPPX,height:e.canvas.height/g.DPPX}}Object.defineProperty(n,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},p=r(e("../components/component")),d=r(e("./layer")),y=r(e("../components/ruler")),v=r(e("../components/rect")),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../const")),m=20,_=0,b=20,w=0,x=20,k=20,O=90*Math.PI/180,P="m",j=0,E="9px Verdana",M=20,A="#f4f4f4",S="#999",T=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.appScale={x:1,y:1},"disabled"!==e.ruler&&(r.hruler=new y.default({left:m,top:_,origin:b,margin:j,height:M,unit:P,rotation:0,font:E,fillStyle:A,strokeStyle:S,capturable:!1}),r.vruler=new y.default({left:0,top:0,origin:k,margin:j,height:M,unit:P,rotation:O,font:E,side:"top",fillStyle:A,strokeStyle:S,capturable:!1}),r.origin_rect=new v.default({left:-b,top:-k,width:b,height:k,fillStyle:A,strokeStyle:S,lineWidth:1}),r.addComponent(r.hruler),r.addComponent(r.vruler),r.addComponent(r.origin_rect)),r.invalidate(),r}return a(t,d.default),f(t,[{key:"added",value:function(e){if(this.hruler){var t=this.rootModel,n=Object.assign({},t.get("translate"));n.x<m&&(n.x+=m),n.y<x&&(n.y+=x);var r=t.get("scale")||{x:1,y:1};this.appScale=r,this.hruler.set("scale",r.x),this.vruler.set("scale",r.y),t.set("translate",n),this.set("translate",n),this.screen_coord=l(this);var o=this.screen_coord,i=o.width,a=o.height;this.hruler.set(s(n,i,0,this.hruler)),this.vruler.set(c(n,0,a,this.vruler)),this.origin_rect.set(u(n))}else this.screen_coord=l(this)}},{key:"resize",value:function(){h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resize",this).call(this),this.screen_coord=l(this);var e=this.screen_coord,n=e.width,r=e.height;this.hruler&&(this.hruler.set(s(this.model.translate,n,0,this.hruler)),this.vruler.set(c(this.model.translate,0,r,this.vruler)),this.origin_rect.set(u(this.model.translate)))}},{key:"_draw",value:function(e){if(this.guide){e.save();var t=this.guide,n=t.x,r=t.y,o=this.screen_coord,i=o.top,a=o.left,u=o.width,s=o.height;e.beginPath(),e.moveTo(n,i),e.lineTo(n,i+s),e.moveTo(a,r),e.lineTo(a+u,r),e.lineWidth=1,e.strokeStyle="tomato",e.setLineDash([2,3]),e.font="10px tahoma",e.fillStyle="#333";var c=this.transcoordS2C(n,r,this.rootModel);e.textBaseline=c.y>200?"bottom":"top",e.textAlign=c.x>200?"right":"left";var l=c.y>200?-5:5,f=c.x>200?-5:5,h=Math.round(n/this.appScale.x),p=Math.round(r/this.appScale.y);e.fillText(" "+h+", "+p+" ",n+f,r+l),e.stroke(),e.restore()}}},{key:"contains",value:function(e,t){return!0}},{key:"onmousedown_origin",value:function(e,t){this.rootModel.set("translate",{x:b,y:k})}},{key:"onchange_root_model",value:function(e,t,n){if(e.scale&&(this.appScale=e.scale,this.hruler&&(this.hruler.set("scale",e.scale.x),this.vruler.set("scale",e.scale.y))),e.translate&&this.set({translate:{x:e.translate.x,y:e.translate.y}}),e.scale||e.translate){if(this.screen_coord=l(this),this.hruler){var r=this.model.translate,o=this.screen_coord,i=o.width,a=o.height;this.hruler.set(s(r,i,0,this.hruler)),this.vruler.set(c(r,0,a,this.vruler)),this.origin_rect.set(u(r))}this._guide=null}this.invalidate()}},{key:"onmouseout_child",value:function(e){this._guide=null,this.invalidate()}},{key:"onmousemove_child",value:function(e,t){e.target&&"CANVAS"!==e.target.tagName?this.guide=null:this.guide=this.transcoordC2S(e.offsetX,e.offsetY)}},{key:"capturable",get:function(){return!1}},{key:"guide",get:function(){return this._guide},set:function(e){this._guide=e,this.invalidate()}},{key:"eventMap",get:function(){return{"(root)":{"(descendant)":{mousemove:this.onmousemove_child,mouseout:this.onmouseout_child,dragmove:this.onmousemove_child},"model-layer":{change:this.onchange_root_model}},"(self)":{"(descendant)":{mousedown:this.onmousedown_origin}}}}}]),t}();n.default=T,p.default.register("guide-layer",T)},{"../components/component":155,"../components/rect":193,"../components/ruler":196,"../const":203,"./layer":231}],230:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./model-layer");Object.defineProperty(n,"ModelLayer",{enumerable:!0,get:function(){return r(o).default}});var i=e("./guide-layer");Object.defineProperty(n,"GuideLayer",{enumerable:!0,get:function(){return r(i).default}});var a=e("./shift-layer");Object.defineProperty(n,"ShiftLayer",{enumerable:!0,get:function(){return r(a).default}});var u=e("./selection-layer");Object.defineProperty(n,"SelectionLayer",{enumerable:!0,get:function(){return r(u).default}});var s=e("./modeling-layer");Object.defineProperty(n,"ModelingLayer",{enumerable:!0,get:function(){return r(s).default}});var c=e("./tag-layer");Object.defineProperty(n,"TagLayer",{enumerable:!0,get:function(){return r(c).default}})},{"./guide-layer":229,"./model-layer":232,"./modeling-layer":240,"./selection-layer":241,"./shift-layer":242,"./tag-layer":243}],231:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(){}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=r(e("../components/component")),f=r(e("../components/container")),h=e("../core/utils"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../const")),d=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return e.translate=e.translate||{x:0,y:0},r.throttle_draw="undefined"!=typeof window?(0,h.throttle)(function(){requestAnimationFrame(function(){r.reflow(),r.draw(),r.trigger("redraw")})},30):u,r}return a(t,f.default),s(t,[{key:"fitSize",value:function(e){if(this.target){var t=getComputedStyle&&getComputedStyle(this.target),n=t?parseFloat(t.getPropertyValue("width")):this.target.offsetWidth,r=t?parseFloat(t.getPropertyValue("height")):this.target.offsetHeight;e.setAttribute("width",n*p.DPPX),e.setAttribute("height",r*p.DPPX),e.style.width=n+"px",e.style.height=r+"px"}}},{key:"resize",value:function(){this.fitSize(this.canvas)}},{key:"isLayer",value:function(){return!0}},{key:"dispose",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this.target=null,this.canvas=null}},{key:"getContext",value:function(){return this._context2D||(this._context2D=this.canvas&&this.canvas.getContext("2d")),this._context2D}},{key:"draw",value:function(e){this.canvas&&(e=e||this.getContext())&&c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this,e)}},{key:"_pre_draw",value:function(e){var t=this.model,n=t.translate,r=t.scale,o=void 0===r?{x:1,y:1}:r,i=t.rotation;e.clearRect(0,0,e.canvas.width,e.canvas.height),n&&e.translate(n.x*p.DPPX,n.y*p.DPPX),e.scale(o.x*p.DPPX,o.y*p.DPPX),i&&e.rotate(i)}},{key:"contains",value:function(e,t){return!1}},{key:"invalidate",value:function(){this.throttle_draw()}},{key:"move",value:function(e){var t=this.get("translate")||{x:0,y:0};this.set({translate:{x:t.x+e.x,y:t.y+e.y}})}},{key:"target",get:function(){return this._target},set:function(e){this._target&&this.canvas&&this._target.removeChild(this.canvas),this._target=e,e&&(this.canvas||(this.canvas=l.default.createCanvas(screen.width,screen.height)),this.fitSize(this.canvas),this.canvas.style.position="absolute",e.appendChild(this.canvas))}},{key:"selected",get:function(){return this.root.selected},set:function(e){this.root.selected=e}},{key:"focused",get:function(){return this.root.focused},set:function(e){this.root.focused=e}},{key:"rotatePoint",get:function(){return{x:0,y:0}}}]),t}();n.default=d},{"../components/component":155,"../components/container":156,"../const":203,"../core/utils":216}],232:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var u=i.set;void 0!==u&&u.call(o,r)}return r},l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=o(e("../components/component")),h=(o(e("../components/container")),o(e("./layer"))),p=(e("../core/logger"),r(e("../core")),o(e("../components/info-window"))),d=r(e("./action/emphasize")),y=e("../license/license"),v={x:1,y:1},g={x:0,y:0},m=function(e){function t(e,n){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return u(t,h.default),s(t,[{key:"dispose",value:function(){if(this._overlay){var e=this._overlay.parentNode;try{e&&e.parentElement&&e.parentElement.removeChild(e)}catch(e){console.error(e)}delete this._overlay}l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"contains",value:function(e,t){return!0}},{key:"isRootModel",value:function(){return!0}},{key:"capturePath",value:function(e,t){for(var n=this.layout.capturables(this),r=n.length-1;r>=0;r--){var o=n[r];if(o.isContainer()){var i=o.capturePath(e,t);if(i)return i}}return!1}},{key:"_post_draw",value:function(e){if(l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_post_draw",this).call(this,e),y.License.valid)delete t.prototype._post_draw;else{this._watermark||(this._watermark=new Image,this._watermark.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAAAjCAMAAAC0JoimAAACQ1BMVEVHcEwODw+xHySxHySxHySxHyRYWFldR0mxHyRLS0wPEBAPEBBYWFmxHiNYWFlYWFlYWFm0HyRYWFlYWFlYWFmxHySxHySxHyRYWFkPEBAODw9YWFlYWFm9QkYPEBAPEBBYWFlYWFmxHyRYWFmxHyQPEBBYWFlYWFlYWFkPEBAPEBBYWFlYWFlYWFlYWFkOEA+xHyQPEBD///9YWFmxHyRYWFlYWFlYWFlYWFkPEBBYWFn89vaxHyRYWFlYWFmxHyRYWFkPEBAPEBAPEBCxHySxHyQOEA8OEA+xHyRYWFmxHyRYWFkOEA9YWFmxHySxHyS8PUEPEBCxHyQOEA+xHyRYWFkPEBBYWFlYWFkPEBAPEBDz3d757u4PEBAPEBAPEBCxHySxHSIPEBDTgIMPEBCxHyQPEBAPEBBYWFkOEA+xHySyHySxHyQPEBAPEBCwHCHCT1OxHySxHyQPEBDksbPeoKLKZmmxHyS6ODwPEBAOEA/XjZD/8fHnmpz/2Njll5n+7e3/09S+PkL8y8zae37ikJL2vb7wra/fiIryzs+xHyQPEBCvGR6xHSL///+wGyCsEheuFRqyHySuFxy0HyWsHSK6NzvakZTARkq3MDTuztBwEhGzJCmWGRzipKe1Ky/XhIfBSk7CT1PkrrDNZ2r14ODw09T35uf9+fnIXmLRc3Xy2NnrwcOiHB/+/Px5ExP67++ZGh3ObnHcm525MzeMFxnovb7nt7ntycqTGRtsERDRen1oEA6XGh1qERBpEQ/HVFjdAcS7AAAAfHRSTlMAEw4E93sNAaQEB9er2D4YhRIRIpyfwMQICg5Fev2i+VejKn8J3l9lM8z1iybgLr/Shfa9VimRbks+tv5Jc81ul8fSY3XoJKmV87QdHlJm769ayXYjQbY5aUZx/fvmTl3gXtH88B17KsJujRU4VZCI9qw+M+r29vPGKK/+ZLYwnwAACHRJREFUeF68lklvGkkUx4tNGBCHHIxlJINkwcG+GCQuyEiIsFkIGQUjS3bGGHucWDGxo2QOaJxv8Kp6Be/77uz7PttHm6qmCTTt4Mxh+KtV23tS/fTqva5CVPfHSuZkJuRD16vwIGDOucaNqDsyJcxQq9Vk6Clf6xtK1l1dg91hi4Isv9h7sybDw+siF6nUXWuQv9MNtMGKDB92dnZevajBeGfXcgC+uy51g+0ByB++0g2/vlqTXTc6us5B7YvqWit141QD8trOX1+p/tirmTtv2COvvfpbcf0iQwj9tGyGn3KzRqIhbXDM8tqfivZeALh6OikHa2/2Gq6JxsbBdLCfDex3V9lAr9TqUFy7YrQ8XNLntikPyUEtG0CtLhmuV9PVguqyz2CHmw36h7BfG6D+8PQi7YoYx3SJWzLq2VxQ0rE1RCRJgB+KEzhoqsnmwEN1thF8U8s2gfEU7bLp2C0txY0+cP4nNkFaPz46ELkfkEkSEFH4KTa3erTT2BvWJp77Sjajr5XNqGPjpM2T2xcX5++2qleRkYPD59uf94+IcBWbwmJT2GzF9JBjfnIZIcOqA+PYZBAtpienmcMUtcRWFrVs1khP3hnIhOpszvuWfKAvYdKwcdLpa17R+cAVcNXjZ4pxdAM4Pdt8ykCVjTE2gwMPL2DsnUZZL2YaQWGM0xQiOIwx/WaKGjZjHsw5AEhYGVvSCUw9plY2svkLr2r7QHes0sBZw/qY6Nm8fkXDjM0ej6fc4ZvYn7Uvp7E3ODuFwsPYg9AsxkPF1L1h7E9pznQ8WjDeD0CywNggmXgUTQKMt7IJn+i+r08+XdLuVwJaCfIJ39DosaRja6iRb4asB3uLrBZYvtXZbPN44Tc6CWI80Z5v5cISQISxmRnUnBkyviYbtz7K8xfHsHtK4bZJW+CqA5f8+fGT2xsDGy/5dyLXzuaP35qdvRV3KGzuidjMDD07Wpp3sXeqwZZawJN2OlnEeFXDZoz2lZIVgND3OvWVIHCnyUaevOT5DUkgQON39l4Ajcgpz78VxX92xd0z/uOuoKsFe7MWaNZh/+S8jo01VlbDNAOtLWxlF0DJlW9lQ05wFrRs7Cw5bp/Gb520sX2jxipwQNYv+M9bpNM/ZAV771lRXMf2O41bfz1u6Za4WS0AFhOKtLIZS5AvN9mETXqWn3erEt2cfya3nymN2+0twgnixksWt05s89hPZ0GFbQLjZZWNubF8o+z4nsJWL0VfBnI+hKIqm3mOVYcZek3lRNSn1oLM/hEfT5+e025fgvZ8G6XG95Lw7ZKn+Qad2EawN+6OL2A8i1j0YrNhhU2ZzE8Zpr34Zpax5XrHmIw9AFFjKAcwx9igknhkyUElgnrpuspG3jYrcUAArThgdXr2lLWvj9rqtF97nxaHMZWDRQelaEczP8waZAtSCzNNKfepKlOkwjonQAL5AuCkBgaIUB/AksomwL6KdvmUQIf/22EVtGy2oEd9h0wog+V0bHIiteJRMs0zMjKNUh5PnDkUPSOx1btZ5R3Sq8qHIg/7MpbCWG8E+Sy9ocKYy0WHCEUymUGVDcjuoXIxPDslHOjhjrbrMT3kOC2bXlaDvTkxuFtNboMN6VX2ad4B6hPOZ2re9URYP318+GSrKsAVqh68Pdl+vrHZtFrQ/y9z8z4ngkDUqOkkEI7jaAPdZ6uKAhFFiZNEsSqIYsuMozOiLFXrS9Xusgncv82Y32vbVhTHDwyuuKBZQtKGQDJICCSBZDGkSRYq0vy4YTz2YmxYX0oYmDFYgLYMKsm286sLc7oxcJ0SOo84zeyWAatxCnvxn7Z7Q9YtQMbap34lLlydry4fQPeco7vsjxZFsXu82y/mk71+f7opioerZVEsVw/7/c20X+yN5sSwmhV/HD66the0ELAi3vDt1WMyigoGKku7etz24CZ5letsj072hjvT3bI8OD4YlrPRznBnMy/L/VVRlv3J/nA43wzL/dGsLJ+uDoY7/fG/2eSMxVgiCAIApjiAZDIwGDCvYakrM2B3MTAIIFIBX1pMhTjojTAXhQxdhYQvPbEGdAFqw5Ttp0Wen/06y/MXx+tB/nh0PjjfLPP8+8npID+dPBsMlotBfjZ9nOcXq1eDwWBOU9wnV2xID+qMFKM6b3IpAiusGIYnpLwNbsZ6ka4aKDQ5K41McLoucRBpHVsDT0Mmr7RqfBPAM/iOYNWJpx1Di+dt2wIuhY9Ian1Ke58HpK9ckVTxskpq64KU0LPJ+ujoglaxPxc06b4kZW1C68cpLQ0f/80mxUElaquOG2ishnoKq9R1u1YXQEgMTmIridlmxUyNe6IRSRoQMVJX06El2ZnStHstBCiI455HPJlY5ytBx0zaGapL8PXh+GR9ne23o9//k+3Fz+N//tYQy5mJUwkklVXMyEpbmRE57eASoQUNE1K+o7u6CHpb/SwBKqZhaQ2IJaQmbYHlAMKaYbAdlngUSzUcgETh65JCzhzGJxdvxrYmLdynzBWbkLjA1jqS6rpY1GucknRczutRBD2VpS6ofIUNWQ+ziuE0eDnkKJsScCqLOTMTggqGZlYRm25CPZahJVwnCMNaJAB8fvjD1puxzX48/PD1WQ1ymuAGtqsbKgJVAkaVeIVr0JDJ2mkLzK7HN3kR87bV4nQlEAEaXZmNGrxoOCk4DQ7A0lWt6YgM8TiyE0kW4KwORHfeP37yP9imlG31nAy/jD94jQaMgC93luw1GZBlABBDhAWgEgWEAJEZuRhBphPFARCTGOQQIyy6ANil73Ae9YCAWIIUElqN5YDqqztf3L29/cD3n1Wf+P697Vu+f3/L97+srn3/onru+1v3ff/29j3ff1V9fuvud99+8x68rWiy4FP5prAZIaASdRveaf0FsOq+MCErseEAAAAASUVORK5CYII=");var n=this._watermark;e.globalAlpha=.5,e.drawImage(n,this.model.width-n.width-30,this.model.height-n.height-30)}}},{key:"_repositionOverlay",value:function(){var e=this._overlay;if(e){var t=e.parentNode;this.fitSize(t);var n=this.model,r=n.translate,o=void 0===r?g:r,i=n.scale,a=void 0===i?v:i,u=n.rotation,s=void 0===u?0:u,c=this.bounds,l=c.left,f=c.top;c.width,c.height;e.style.left=l+"px",e.style.top=f+"px";var h="rotate("+s+"rad) scale("+a.x+", "+a.y+")";e.style["margin-left"]=o.x+"px",e.style["margin-top"]=o.y+"px",["-webkit-","-moz-","-ms-","-o-",""].forEach(function(t){e.style[t+"transform"]=h})}}},{key:"onchange",value:function(e){e.hasOwnProperty("text")&&this.set("text",null),e.hasOwnProperty("id")&&this.set("id",null),e.hasOwnProperty("class")&&this.set("class",null),this._repositionOverlay()}},{key:"onchanged",value:function(e,t,n){this.invalidate()}},{key:"onmouseenter",value:function(e,n){if(!this.app.isEditMode&&n){var r=n.origin;if(!(r instanceof t)&&r.model.event&&r.model.event.hover){var o=r.model.event.hover;o.emphasize&&d.emphasize(r),o.infoWindow&&p.default.show(r,o.infoWindow),o.target&&o.hasOwnProperty("value")&&(r._lastValue=this.root.variable(o.target),this.root.variable(o.target,o.value))}}}},{key:"onmouseleave",value:function(e,t){if(!this.app.isEditMode&&t){var n=t.origin;if(n.model.event&&n.model.event.hover){var r=n.model.event.hover;r&&(r.emphasize&&d.normalize(n),r.infoWindow&&p.default.hide(n,r.infoWindow),r.target&&r.hasOwnProperty("value")&&(this.root.variable(r.target,n._lastValue),delete n._lastValue))}}}},{key:"onclick",value:function(e,t){if(!this.app.isEditMode&&t){var n=t.origin;if(n.model.event&&n.model.event.tap){var r=n.model.event.tap;r.infoWindow&&p.default.show(n,r.infoWindow),r&&r.target&&(/^\$/.test(r.target)?this.root.variable(r.target.substring(1),r.value):this.trigger(r.target,r.value))}}}},{key:"stuck",get:function(){return!0}},{key:"overlay",get:function(){if(!this._overlay&&this.target){var e=document.createElement("div");e.style.position="absolute",e.style["user-select"]="none",e.style.overflow="hidden";var t=this.canvas.nextSibling;t?this._target.insertBefore(e,t):this._target.appendChild(e);var n=document.createElement("div");n.style.position="absolute",n.style["user-select"]="none",n.style["transform-origin"]="top left",e.appendChild(n),this._overlay=n,this._repositionOverlay()}return this._overlay}},{key:"target",get:function(){return this._target},set:function(e){var n=this._overlay&&this._overlay.parentNode;try{n&&n.parentElement&&n.parentElement.removeChild(n)}catch(e){console.error(e)}c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"target",e,this),e&&n&&(e.appendChild(n),this.fitSize(n))}},{key:"MPP",get:function(){var e=this.model,t=e.scale,n=void 0===t?{x:1,y:1}:t;switch(e.unit){case"mm":case"cm":return 1/this.app.PPM/n.x;case"in":return 1/this.app.PPI/n.x;case"px":default:return 1/n.x}}},{key:"eventMap",get:function(){return{"(self)":{"(all)":{change:this.onchanged,mouseenter:this.onmouseenter,mouseleave:this.onmouseleave,click:this.onclick}}}}}]),t}();n.default=m,f.default.register("model-layer",m)},{"../components/component":155,"../components/container":156,"../components/info-window":179,"../core":206,"../core/logger":208,"../license/license":251,"./action/emphasize":228,"./layer":231}],233:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-change")),a=function(){function e(t){r(this,e),this.layer=t}return o(e,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(e,t,n,r){var o=this,i=n.controls;return!!i&&(i.every(function(i,a){return Math.abs(e-i.x)<=4/r.x&&Math.abs(t-i.y)<=4/r.y&&(o.active={component:n,index:a,handler:i.handler}),!o.active}),!!this.active)}},{key:"draw",value:function(e,t,n){var r=t.controls;r&&r.forEach(function(t,r){e.beginPath(),e.lineWidth=1/n.x,e.ellipse(t.x,t.y,4/n.x,4/n.y,0,0,2*Math.PI,!0),e.fillStyle="#ff5d72",e.fill(),e.strokeStyle="#fff",e.stroke()})}},{key:"onevent",value:function(e,t){var n=this.active,r=n.handler,o=n.component,i=n.index,a=o.transcoordC2S(t.offsetX,t.offsetY);a=o.transcoordS2P(a.x,a.y),r&&"function"==typeof r[e]&&r[e](a,i,o)}},{key:"onmousedown",value:function(e){this.onevent("onmousedown",e)}},{key:"ondragstart",value:function(e){var t=this.active;t.changes=i.default.before([t.component]),this.onevent("ondragstart",e)}},{key:"ondragmove",value:function(e){this.onevent("ondragmove",e)}},{key:"ondragend",value:function(e){this.onevent("ondragend",e);var t=this.active,n=t.component,r=t.changes;i.default.after(r,n.app.commander),n.parent&&n.parent.calculateBounds&&n.parent.calculateBounds()}},{key:"selected",get:function(){return this.layer.selected}}]),e}();n.default=a},{"../../command/command-change":150}],234:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.layer=t}return o(e,[{key:"draw",value:function(e,t,n){var r=t.bounds;0!=r.width&&0!=r.height&&(e.beginPath(),e.rect(r.left,r.top,r.width,r.height),e.clip(),e.beginPath(),e.strokeStyle="#f26522",e.lineWidth=4,e.shadowBlur=10,e.shadowColor="black",e.shadowOffsetX=0,e.shadowOffsetY=0,e.rect(r.left,r.top,r.width,r.height),e.stroke(),e.closePath())}}]),e}();n.default=i},{}],235:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.layer=t}return o(e,[{key:"draw",value:function(e,t,n){var r=t.bounds;e.beginPath(),e.rect(r.left,r.top,r.width,r.height),e.setLineDash([3/n.x,4/n.y]),e.lineWidth=1/n.x,e.strokeStyle="black",e.stroke(),e.setLineDash([]),e.closePath()}}]),e}();n.default=i},{}],236:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./focus-outline");Object.defineProperty(n,"FocusOutline",{enumerable:!0,get:function(){return r(o).default}});var i=e("./group-outline");Object.defineProperty(n,"GroupOutline",{enumerable:!0,get:function(){return r(i).default}});var a=e("./control-handler");Object.defineProperty(n,"ControlHandler",{enumerable:!0,get:function(){return r(a).default}});var u=e("./path-handler");Object.defineProperty(n,"PathHandler",{enumerable:!0,get:function(){return r(u).default}});var s=e("./resizer");Object.defineProperty(n,"Resizer",{enumerable:!0,get:function(){return r(s).default}});var c=e("./rotator");Object.defineProperty(n,"Rotator",{enumerable:!0,get:function(){return r(c).default}})},{"./control-handler":233,"./focus-outline":234,"./group-outline":235,"./path-handler":237,"./resizer":238,"./rotator":239}],237:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function i(e,t){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function a(e,t,n){return{x:Math.cos(t)*n+e.x,y:Math.sin(t)*n+e.y}}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-change")),c=15*Math.PI/180,l=function(){function e(t){r(this,e),this.layer=t}return u(e,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(e,t,n,r){var o=this;return!!n.mutable&&(n.path.every(function(i,a){return Math.abs(e-i.x)<=4/r.x&&Math.abs(t-i.y)<=4/r.y&&(o.active={component:n,index:a}),!o.active}),!!this.active)}},{key:"draw",value:function(e,t,n){if(t.mutable&&!t.stuck){var r=t.path,o=this.active;r.forEach(function(r,i){e.beginPath(),e.ellipse(r.x,r.y,4/n.x,4/n.y,0,0,2*Math.PI,!0),e.lineWidth=1/n.x,e.strokeStyle="#656565",e.fillStyle="#fff",o&&o.component===t&&o.index===i&&(e.strokeStyle="#fa7703",o.toFill&&(e.fillStyle="#ffb80c")),e.fill(),e.stroke()})}}},{key:"ondblclick",value:function(e){var t=this.active.component;if(t.pathExtendable){var n=t.path.slice();n.length<4||(n.splice(this.active.index,1),t.path=n)}}},{key:"onmousedown",value:function(e){this.active.toFill=!0}},{key:"ondragstart",value:function(e){var t=this.active;t.changes=s.default.before([t.component])}},{key:"ondragmove",value:function(e){var t=this.active,n=t.component,r=t.index,u=n.transcoordC2S(e.offsetX,e.offsetY);if(u=n.transcoordS2P(u.x,u.y),e.shiftKey){var s=n.path.length,l=n.isLine()&&0==r?n.path[1]:n.path[(r-1+s)%s];l=n.transcoordS2P(l.x,l.y);var f=0;if(s>2){var h;n.isLine()?0==r?h=n.path[2]:1!=r&&(h=n.path[r-2]):h=n.path[(r-2+s)%s],h&&(f=o(h=n.transcoordS2P(h.x,h.y),l))}var p=Math.round((o(l,u)-f)/c)*c+f;u=a(l,p,i(l,u))}n.mutatePath(null,function(e){e[r]=u})}},{key:"ondragend",value:function(e){var t=this.active,n=t.component,r=t.changes;s.default.after(r,n.app.commander),n.parent&&n.parent.calculateBounds&&n.parent.calculateBounds()}},{key:"selected",get:function(){return this.layer.selected}}]),e}();n.default=l},{"../../command/command-change":150}],238:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){var r,o,i=e.bounds,a=i.left,u=i.top,v=i.width,g=i.height;switch(t){case s:r=a,o=u;break;case c:r=a+v/2,o=u;break;case l:r=a+v,o=u;break;case f:r=a+v,o=u+g/2;break;case h:r=a+v,o=u+g;break;case p:r=a+v/2,o=u+g;break;case d:r=a,o=u+g;break;case y:r=a,o=u+g/2}var m={x:r,y:o},_=e.transcoordT2S(n.x,n.y);return{dx:_.x-m.x,dy:_.y-m.y}}function i(e,t,n,r,o,i){var a=e.bounds,u=a.left,v=a.top,g=a.width,m=a.height,_={left:u,top:v,width:g,height:m};switch(t){case s:u+=r,v+=o,g-=r,m-=o;break;case c:v+=o,m-=o;break;case l:v+=o,g+=r,m-=o;break;case f:g+=r;break;case h:g+=r,m+=o;break;case p:m+=o;break;case d:u+=r,g-=r,m+=o;break;case y:u+=r,g-=r}if(e.mutateBounds(function(t){return Math.abs(g)<=.001&&(g=.001),Math.abs(m)<=.001&&(m=.001),e.adjustResize({left:u,top:v,width:g,height:m},_,n)},this),e.isContainer()&&!e.isGroup()){var b=_.left-u,w=_.top-v;i?e.components.forEach(function(e){e.delta("tx",0),e.delta("ty",0),e.move({x:b,y:w})}):e.components.forEach(function(e){e.delta("tx",b),e.delta("ty",w)})}i&&e.parent&&e.parent.calculateBounds&&e.parent.calculateBounds()}function a(e){var t=e.left,n=e.top,r=e.width,o=e.height,i=t+r/2,a=n+o/2,u=t+r,s=n+o;return[{x:t,y:n},{x:i,y:n},{x:u,y:n},{x:u,y:a},{x:u,y:s},{x:i,y:s},{x:t,y:s},{x:t,y:a}]}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=0,c=1,l=2,f=3,h=4,p=5,d=6,y=7,v=function(){function e(t){r(this,e),this.layer=t}return u(e,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(e,t,n,r){var o=this;return!!n.resizable&&(a(n.bounds).every(function(i,a){return Math.abs(e-i.x)<=4/r.x&&Math.abs(t-i.y)<=4/r.y&&(o.active={component:n,index:a}),!o.active}),!!this.active)}},{key:"draw",value:function(e,t,n){if(!t.isLine()){var r=t.bounds;if(e.beginPath(),e.rect(r.left,r.top,r.width,r.height),e.setLineDash([3/n.x,4/n.y]),e.lineWidth=1/n.x,e.strokeStyle="black",e.stroke(),e.setLineDash([]),t.resizable){var o=this.active;a(r).forEach(function(r,i){e.beginPath(),e.rect(r.x-4/n.x,r.y-4/n.y,8/n.x,8/n.y),e.setLineDash([0,0]),e.strokeStyle="#656565",e.stroke(),e.fillStyle="#fff",o&&o.component===t&&o.index===i&&(e.strokeStyle="#fa7703",o.focus&&(e.fillStyle="#ffb80c")),e.fill(),e.stroke()})}}}},{key:"onmousedown",value:function(e){this.active.focus=!0}},{key:"ondragstart",value:function(e){var t=this.active.component;this.active.bounds=t.bounds,this.active.boundsList=this.layer.selected.filter(function(e){return e.resizable}).map(function(e){return e.bounds})}},{key:"ondragmove",value:function(e){var t=this.active,n=t.component,r=t.index,a=t.boundsList,u=t.bounds,s=this.layer.transcoordC2S(e.offsetX,e.offsetY);n.bounds=u;var c=o(n,r,s);this.layer.selected.filter(function(e){return e.resizable}).forEach(function(t,n){t.bounds=a[n],i(t,r,e.shiftKey,c.dx,c.dy,!1)})}},{key:"ondragend",value:function(e){var t=this.active,n=t.component,r=t.index,a=t.boundsList,u=t.bounds,s=this.layer.transcoordC2S(e.offsetX,e.offsetY);n.bounds=u;var c=o(n,r,s);this.layer.selected.filter(function(e){return e.resizable}).forEach(function(t,n){t.bounds=a[n],i(t,r,e.shiftKey,c.dx,c.dy,!0)}),this.active.component.app.commander.execute(null,!1)}},{key:"selected",get:function(){return this.layer.selected}}]),e}();n.default=v},{}],239:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var n=e.bounds;return{x:n.left+n.width/2,y:n.top-u/t.y}}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=(r(e("../../components/component")),r(e("../../command/command-change")),20),s=2*Math.PI,c=Math.PI/2,l=function(){function e(t){o(this,e),this.layer=t}return a(e,[{key:"reset",value:function(){this.active=null}},{key:"contains",value:function(e,t,n,r){if(!n.rotatable)return!1;var o=i(n,r);return Math.abs(e-o.x)<=4/r.x&&Math.abs(t-o.y)<=4/r.y&&(this.active={component:n},!0)}},{key:"draw",value:function(e,t,n){if(t.rotatable){e.beginPath();var r=i(t,n);e.lineWidth=1.5/n.x,e.moveTo(r.x,r.y+u/n.y),e.lineTo(r.x,r.y),e.strokeStyle="#656565",e.stroke(),e.beginPath(),e.ellipse(r.x,r.y,4/n.x,4/n.y,0,0,s,!0),e.stroke(),e.fillStyle="#fff",e.fill();var o=this.active;o&&o.component===t&&(e.strokeStyle="#fa7703",e.stroke(),o.toFill&&(e.fillStyle="#ffb80c",e.fill()))}}},{key:"onmousedown",value:function(e){this.active.toFill=!0}},{key:"ondragstart",value:function(e){var t=this.active;t.component;t.start_rotation=t.component.get("rotation"),t.rotations=this.layer.selected.filter(function(e){return e.rotatable}).map(function(e){return e.get("rotation")})}},{key:"ondragmove",value:function(e){var t=this.active.component,n=t.transcoordC2S(e.offsetX,e.offsetY);n=t.transcoordS2P(n.x,n.y);var r=t.rotatePoint,o=t.get("rotation")||0,i=Math.atan((r.y-n.y)/(r.x-n.x)),a=(i=r.x>=n.x?i-c:c+i)-o;this.layer.selected.filter(function(e){return e.rotatable}).forEach(function(t,n){var r=((t.get("rotation")||0)+a)%s;t.set("rotation",t.adjustRotation(r,e.shiftKey))})}},{key:"ondragend",value:function(e){var t=this.active,n=t.component;t.rotations;n.app.commander.execute(null,!1)}},{key:"selected",get:function(){return this.layer.selected}}]),e}();n.default=l},{"../../command/command-change":150,"../../components/component":155}],240:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=o(e("../components/component")),l=(o(e("../components/group")),o(e("./layer"))),f=r(e("./modeler")),h=o(e("../command/command-change")),p=r(e("../const")),d=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=new f.PathHandler(r),u=new f.ControlHandler(r),s=new f.Resizer(r),c=new f.Rotator(r);return r._modelers=[o,u,s,c],r._control_mode_modelers=[u,o,s,c],r.focusOutline=new f.FocusOutline(r),r.groupOutline=new f.GroupOutline(r),r._reversed_modelers=r._modelers.slice().reverse(),r._control_mode_reverse_modelers=r._control_mode_modelers.slice().reverse(),r}return u(t,l.default),s(t,[{key:"added",value:function(e){var t=this.rootModel,n=t.get("translate"),r=t.get("scale");this.set("translate",n),this.set("scale",r)}},{key:"contains",value:function(e,t){if(this._state_dragging)return!0;this.modelers.forEach(function(e){return e.reset()});for(var n=this.selected.filter(function(e){return!!e.parent}),r=this.get("scale")||{x:1,y:1},o=0;o<n.length;o++)for(var i=n[o],a=i.transcoordT2S(e,t),u=0;u<this.modelers.length;u++){var s=this.modelers[u];if(s.contains(a.x,a.y,i,r))return this.currentModeler=s,!0}return!1}},{key:"_componentDrawer",value:function(e,t,n,r){var o=[],i=t.parent;if(t.isRootModel())return e.save(),r(e,t,n),void e.restore();for(;i&&!i.isRootModel();)o.push(i),i=i.parent;e.save(),o.reverse().forEach(function(t){var n=t.rotatePoint;e.translate(n.x,n.y);var r=t.get("scale");r&&e.scale(r.x,r.y),e.rotate(t.get("rotation")),e.translate(-n.x,-n.y);var o=t.bounds;e.translate(o.left,o.top)});var a=t.rotatePoint;e.translate(a.x,a.y);var u=t.get("scale");u&&e.scale(u.x,u.y),e.rotate(t.get("rotation")),e.translate(-a.x,-a.y),r(e,t,n),e.restore()}},{key:"_pre_draw",value:function(e){var t=this.model,n=t.translate,r=t.scale,o=void 0===r?{x:1,y:1}:r,i=t.rotation;e.save(),e.beginPath(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.rect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="black",e.globalAlpha=.5,e.fill(),e.restore(),n&&e.translate(n.x*p.DPPX,n.y*p.DPPX),e.scale(o.x*p.DPPX,o.y*p.DPPX),i&&e.rotate(i),e.clearRect(0,0,this.rootModel.get("width"),this.rootModel.get("height"))}},{key:"_draw",value:function(e){var t=this;e.beginPath();var n=this.get("scale")||{x:1,y:1},r=this.selected.filter(function(e){return!!e.parent});if(this.focused&&this._componentDrawer(e,this.focused,n,function(e,n,r){t.focusOutline.draw(e,n,r)}),r.length>0&&r[0].parent.isGroup()){for(var o=r[0].parent;o.parent.isGroup();)o=o.parent;this._componentDrawer(e,o,n,function(e,n,r){t.groupOutline.draw(e,n,r)})}r.forEach(function(r){t._componentDrawer(e,r,n,function(e,n,r){t.reversedModelers.forEach(function(t){return t.draw(e,n,r)})})})}},{key:"onkeydown",value:function(e){"Alt"==e.key&&(this._control_mode=!0,this.invalidate())}},{key:"onkeyup",value:function(e){"Alt"==e.key&&(this._control_mode=!1,this.invalidate())}},{key:"onselected",value:function(e,t){this.invalidate()}},{key:"onchange_model",value:function(e,t,n){n.origin===n.deliverer&&(e.translate&&this.set("translate",e.translate),void 0!==e.rotation&&this.set("rotation",e.rotation),e.scale&&this.set("scale",e.scale)),this.invalidate()}},{key:"ondblclick",value:function(e){"function"==typeof this.currentModeler.ondblclick&&this.currentModeler.ondblclick(e),this.invalidate()}},{key:"onmousedown",value:function(e){this.currentModeler.onmousedown(e),this.invalidate()}},{key:"onmouseup",value:function(e){"function"==typeof this.currentModeler.onmouseup&&this.currentModeler.onmouseup(e),this.invalidate()}},{key:"onmouseenter",value:function(e,t){this.invalidate()}},{key:"onmouseleave",value:function(e,t){this.invalidate()}},{key:"ondragstart",value:function(e){this.currentModeler.ondragstart(e),this._state_dragging=!0}},{key:"ondragmove",value:function(e){this.currentModeler.ondragmove(e),this.invalidate()}},{key:"ondragend",value:function(e){this._state_dragging=!1,this.currentModeler.ondragend(e),this.invalidate()}},{key:"onwheel_scale",value:function(e,t){if(0!=e.deltaY||0!=e.deltaX){var n=t.deliverer;if(e.shiftKey){if(-1!=navigator.userAgent.indexOf("Win"))r=e.deltaY<0?1:-1;else r=e.deltaX<0?1:-1;h.default.around(n.selected,this.app.commander,function(){n.selected.forEach(function(e){var t=e.get("fontSize")||p.DEFAULT.FONT_SIZE;t<1&&(t=1),t+=r,e.set("fontSize",t)})})}else{var r=e.deltaY<0?1:-1,o=n.get("scale")||{x:1,y:1},i=n.get("translate"),a=e.offsetX,u=e.offsetY,s=n.transcoordC2S(a,u),c=.1*r,l={x:o.x+c,y:o.y+c};if(r<0&&o.x<.2||r>0&&o.x>10)return;n.set("scale",l);var f=n.transcoordC2S(a,u);n.set("translate",{x:i.x+(f.x-s.x)*l.x,y:i.y+(f.y-s.y)*l.y})}}}},{key:"modelers",get:function(){return this._control_mode?this._control_mode_modelers:this._modelers}},{key:"reversedModelers",get:function(){return this._control_mode?this._control_mode_reverse_modelers:this._reversed_modelers}},{key:"eventMap",get:function(){return{"model-layer":{"(all)":{change:this.onchange_model,wheel:this.onwheel_scale}},"(root)":{"(self)":{selected:this.onselected,keydown:this.onkeydown,keyup:this.onkeyup}}}}}]),t}();n.default=d,c.default.register("modeling-layer",d)},{"../command/command-change":150,"../components/component":155,"../components/group":173,"../const":203,"./layer":231,"./modeler":236}],241:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){var r,o,i,a,u=t.sx,s=t.sy,c=t.ex,l=t.ey;if(u>c?(r=c,o=u):(r=u,o=c),s>l?(i=l,a=s):(i=s,a=l),n){var f=e.bounds,h=e.transcoordS2TR(f.left,f.top),d=e.transcoordS2TR(f.left+f.width,f.top+f.height),y=h.x,v=d.x,g=h.y,m=d.y,_=Math.min(r,y,o,v),b=Math.max(r,y,o,v),w=Math.min(i,g,a,m),x=Math.max(i,g,a,m);return!(b-_>Math.abs(o-r)+Math.abs(v-y))&&!(x-w>Math.abs(a-i)+Math.abs(m-g))}var k=e.path;if(!k)return(0,p.error)(" get path  .",e),!1;for(var O=0;O<k.length;O++){var P=e.transcoordS2TR(k[O].x,k[O].y);if(r>P.x||o<P.x||i>P.y||a<P.y)return!1}return!0}function s(e,t,n,r){var o=e.selected,i=r?o.slice(0):[];r&&i.length>0?t=i[0].parent:t.isContainer()||(t=t.parent);var a=t.layout.capturables(t),s=!!t.layout.joinType;if(r&&n.selected.forEach(function(e){i.splice(i.indexOf(e),1)}),n.selected=[],a.forEach(function(e){e.capturable&&u(e,n,s)&&-1==i.indexOf(e)&&n.selected.push(e)}),i=i.concat(n.selected),o.length!==i.length)e.selected=i;else for(var c=0;c<i.length;c++)if(o[c]!=i[c]){e.selected=i;break}}function c(e,t,n,r,o){o||s(e,t,n,r)}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=r(e("../components/component")),h=(r(e("../components/container")),r(e("../components/group")),r(e("./layer"))),p=e("../core/logger"),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,h.default),l(t,[{key:"added",value:function(e){var t=this.rootModel,n=t.get("translate"),r=t.get("scale");this.set("translate",n),this.set("scale",r)}},{key:"contains",value:function(e,t){return!1}},{key:"_draw",value:function(e){var t=this.selbox;if(t){var n=t.sx,r=t.sy,o=t.ex,i=t.ey,a=this.get("scale")||{x:1,y:1};e.beginPath(),e.rect(n,r,o-n,i-r),e.setLineDash([2/a.x,4/a.y]),e.lineWidth=1/a.x,e.strokeStyle="black",e.stroke()}}},{key:"onkeydown",value:function(e,t){t.origin;var n=t.deliverer,r=n.selected;if(1!=r.length)return!1;var o=r[0],i=o.parent;if(!i||i===n)return!1;if("Tab"==e.code){if("Tab"!=e.code)return!1;var a=i.layout.capturables(i),u=a.indexOf(o);if(-1==u){if(!i.indexOf(o))return(0,p.warn)("Container not contains [",o,"] as a component"),!1;u=0}var s=a.length;e.shiftKey?u--:u++,o=a[(u+s)%s]}else{if(!i.layout.keyNavigate)return!1;o=i.layout.keyNavigate(i,o,e)||o}n.selected=[o],e.preventDefault()}},{key:"onchange_root_model",value:function(e,t,n){e.translate&&this.set("translate",e.translate),e.scale&&this.set("scale",e.scale)}},{key:"_pendingDecision",value:function(e){this.downpoint={x:e.offsetX,y:e.offsetY}}},{key:"_selectGroupItem",value:function(e,t){for(var n=this.selected.indexOf(e),r=e.parent;r.parent.isGroup();)r=r.parent;var o=[],i=!1,a=!1;if(this.selected.forEach(function(e){var t=e.parent;if(e!==r){for(;t.parent.isGroup();)t=t.parent;t===r&&(o.push(e),i=!0)}else a=!0}),i)if(t.shiftKey){if(-1!=n)return void this._pendingDecision(t);o.push(e)}else{if(-1!=n)return void this._pendingDecision(t);o=[e]}else if(a)return void this._pendingDecision(t);this.selected=o}},{key:"onmousedown_comp",value:function(e,t){var n=t.origin;if(this.downpoint=null,e.shiftKey){if(-1!=this.selected.indexOf(n))return void this._pendingDecision(e);var r=this.selected.filter(function(e){return!e.isRootModel()&&!!e.parent}),o=r.length>0&&r[0].parent;if(o&&o!==n.parent)return void(n.parent.isGroup()&&this._pendingDecision(e));r.push(n),this.selected=r}else{if(n.parent.isGroup())return void this._selectGroupItem(n,e);if(-1!=this.selected.indexOf(n))return;this.selected=[n]}}},{key:"onmouseup_comp",value:function(e,t){if(this.downpoint&&this.downpoint.x===e.offsetX&&this.downpoint.y===e.offsetY){var n=t.origin,r=this.selected.indexOf(n);if(-1==r&&n.parent.isGroup()&&(r=this.selected.indexOf(n.parent)),-1!==r&&e.shiftKey){var o=this.selected.slice();return r>-1&&o.splice(r,1),void(this.selected=o)}n.parent.isGroup()&&(this.selected=[n])}}},{key:"ondragstart_selbox",value:function(e,t){if(t.origin.stuck){var n=this.transcoordC2S(e.offsetX,e.offsetY),r=n.x,o=n.y;this.selbox={sx:r,sy:o,selected:[]}}}},{key:"ondragmove_selbox",value:function(e,t){var n=t.origin;if(n.stuck){var r=this.transcoordC2S(e.offsetX,e.offsetY),o=r.x,i=r.y;t.deliverer;if(this.selbox){this.selbox.ex=o,this.selbox.ey=i;c(this,n,this.selbox,e.shiftKey),this.invalidate()}}}},{key:"ondragend_selbox",value:function(e,t){t.origin.stuck&&(this.last_pos=null,this.selbox=null,c(this,null,null,!1,!0),this.invalidate())}},{key:"eventMap",get:function(){return{"(root)":{"(self)":{keydown:this.onkeydown}},"model-layer":{"(self)":{change:this.onchange_root_model},"(all)":{dragstart:this.ondragstart_selbox,dragmove:this.ondragmove_selbox,dragend:this.ondragend_selbox,mousedown:this.onmousedown_comp,mouseup:this.onmouseup_comp}}}}}]),t}();n.default=d,f.default.register("selection-layer",d)},{"../components/component":155,"../components/container":156,"../components/group":173,"../core/logger":208,"./layer":231}],242:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("../components/component")),c=r(e("./layer")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../const")),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,c.default),u(t,[{key:"added",value:function(e){var t=this.rootModel.get("translate");this.set("translate",t)}},{key:"_draw",value:function(e){}},{key:"contains",value:function(e,t){return!(this.app.mode!=l.MODE_SHIFT)}},{key:"onkeydown",value:function(e){32==e.keyCode&&void 0===this.before_mode&&(this.before_mode=this.app.mode,this.app.mode=l.MODE_SHIFT)}},{key:"onkeyup",value:function(e){32==e.keyCode&&(void 0!=this.before_mode&&(this.app.mode=this.before_mode),delete this.before_mode)}},{key:"ondragstart",value:function(e){this.last_position=this.transcoordC2S(e.offsetX,e.offsetY)}},{key:"ondragmove",value:function(e){var t=this.transcoordC2S(e.offsetX,e.offsetY),n=t.x,r=t.y;this.rootModel.move({x:n-this.last_position.x,y:r-this.last_position.y}),this.last_position=this.transcoordC2S(e.offsetX,e.offsetY)}},{key:"eventMap",get:function(){return{"(root)":{"(self)":{keydown:this.onkeydown,keyup:this.onkeyup}}}}}]),t}();n.default=f,s.default.register("shift-layer",f)},{"../components/component":155,"../const":203,"./layer":231}],243:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=r(e("../components/component")),c=r(e("./layer")),l=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../const")),225*Math.PI/180),f=135*Math.PI/180,h=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._anim_alpha=1,r}return a(t,c.default),u(t,[{key:"_drawArrow",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=n.x-t.x,i=n.y-t.y,a=Math.atan2(i,o),u=n.x+r*Math.cos(a+l),s=n.y+r*Math.sin(a+l),c=n.x+r*Math.cos(a+f),h=n.y+r*Math.sin(a+f);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.moveTo(n.x,n.y),e.lineTo(u,s),e.moveTo(n.x,n.y),e.lineTo(c,h),e.stroke()}},{key:"animOnTargetChange",value:function(e){var t=this;e!==this._lastTargets&&(this._lastTargets=e,this._anim_alpha=1,this.animate({step:function(e){t._anim_alpha=1-e*e,t.invalidate()},duration:5e3,delta:"linear",options:{x:1},ease:"out"}).start())}},{key:"_draw",value:function(e){var t=this,n=this.targets&&this.targets.filter(function(e){return e.rootModel});if(!n||0==n.length)return this._animate&&this._animate.stop(),void delete this._animate;var r=!1;n.forEach(function(n){var o=n.get("id");if(e.globalAlpha*=t._anim_alpha,o){var i="#"+o,a=n.bounds,u=a.left,s=a.top,c=n.transcoordS2C(u,s,n.rootModel),l=c.x,f=c.y;l=Math.max(l,0),f=Math.max(f-18,0),e.font="12px Arial";var h=e.measureText(i);e.fillStyle="#FF0000",e.fillRect(l,f,h.width+6,16),e.fillStyle="white",e.fillText(i,l+3,f+13),r=!0}e.lineWidth=2,e.strokeStyle="orange",n.mappings&&n.mappings.forEach(function(o){var i=t.root.findAll(o.target,n);i&&i.forEach(function(r){var o=n.center,i=r.center;o=n.transcoordS2C(o.x,o.y,n.rootModel),i=r.transcoordS2C(i.x,i.y,r.rootModel),t._drawArrow(e,o,i)}),r=!0})}),r&&this.animOnTargetChange(this.targets)}},{key:"_ontag",value:function(e){this.targets&&-1!==this.targets.lastIndexOf(e)||(this.targets=(this.targets||[]).concat(e))}},{key:"_offtag",value:function(e){if(this.targets){var t=this.targets.slice();t.splice(this.targets.lastIndexOf(e),1),this.targets=t}}},{key:"_resettag",value:function(){this.targets=[]}},{key:"ontagreset",value:function(e,t){this._resettag()}},{key:"ontag",value:function(e,t){this._ontag(t.origin)}},{key:"offtag",value:function(e,t){this._offtag(t.origin)}},{key:"onmouseenter",value:function(e,t){this._resettag(),this._ontag(t.origin)}},{key:"onmouseleave",value:function(e,t){this._resettag()}},{key:"targets",get:function(){return this._targets},set:function(e){this._targets=e&&e.filter(function(e){return!e.isLayer()}),this.invalidate()}},{key:"eventMap",get:function(){return{"model-layer":{"(descendant)":{tag:this.ontag,tagreset:this.ontagreset,mouseenter:this.onmouseenter,mouseleave:this.onmouseleave}}}}}]),t}();n.default=h,s.default.register("tag-layer",h)},{"../components/component":155,"../const":203,"./layer":231}],244:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={reflow:function(e,t){},capturables:function(e){return e.components},drawables:function(e){return e.components.filter(function(e){return!e.hidden})},isStuck:function(e){return!1}};(function(e){return e&&e.__esModule?e:{default:e}})(e("./layout")).default.register("absolute",r),n.default=r},{"./layout":248}],245:[function(e,t,n){"use strict";function r(e){var t=e.components.filter(function(e){return!e.hidden}),n=e.get("layoutConfig"),r=t[n&&n.activeIndex||0];return r&&[r]||[]}Object.defineProperty(n,"__esModule",{value:!0});var o={reflow:function(e){var t=e.bounds,n={left:0,top:0,width:t.width,height:t.height};e.forEach(function(e){e.bounds=n,e.set("rotation",0)})},capturables:function(e){return r(e)},drawables:function(e){return r(e)},isStuck:function(e){return!0}};(function(e){return e&&e.__esModule?e:{default:e}})(e("./layout")).default.register("card",o),n.default=o},{"./layout":248}],246:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("./layout")),i=r(e("../components/html/reposition")),a={reflow:function(e,t){this.drawables(e).filter(function(e){return e.isHTMLElement()}).forEach(function(e){return(0,i.default)(e)})},capturables:function(e){return e.components},drawables:function(e){return e.components.filter(function(e){return!e.hidden})},isStuck:function(e){return!1}};o.default.register("html-absolute",a),n.default=a},{"../components/html/reposition":176,"./layout":248}],247:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./layout");Object.defineProperty(n,"Layout",{enumerable:!0,get:function(){return r(o).default}});var i=e("./absolute");Object.defineProperty(n,"AbsoluteLayout",{enumerable:!0,get:function(){return r(i).default}});var a=e("./card");Object.defineProperty(n,"CardLayout",{enumerable:!0,get:function(){return r(a).default}});var u=e("./linear-horizontal");Object.defineProperty(n,"LinearHorizontalLayout",{enumerable:!0,get:function(){return r(u).default}});var s=e("./linear-vertical");Object.defineProperty(n,"LinearVerticalLayout",{enumerable:!0,get:function(){return r(s).default}});var c=e("./html-absolute");Object.defineProperty(n,"HTMLAbsoluteLayout",{enumerable:!0,get:function(){return r(c).default}})},{"./absolute":244,"./card":245,"./html-absolute":246,"./layout":248,"./linear-horizontal":249,"./linear-vertical":250}],248:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/logger"),o={};n.default={register:function(e,t){o[e]=t},unregister:function(e){delete o[e]},get:function(e){if(e){var t=o[e];return t||(0,r.error)("Layout Not Found - ",e),t}}}},{"../core/logger":208}],249:[function(e,t,n){"use strict";function r(e){var t=e.get("layoutConfig");return t?t.weight||1:1}Object.defineProperty(n,"__esModule",{value:!0});var o={reflow:function(e){var t=this.drawables(e),n=e.get("padding")||{},o=t.reduce(function(e,t){return e+r(t)},0),i=e.bounds,a=o>0?(i.width-((n.left||0)+(n.right||0)))/o:i.width,u=i.height-((n.top||0)+(n.bottom||0)),s=0;t.forEach(function(e){var t=r(e),o=e.get("margin")||{};e.bounds={left:a*s+(n.left||0)+(o.left||0),top:0+(n.top||0)+(o.top||0),width:t*a-((o.left||0)+(o.right||0)),height:u-((o.top||0)+(o.bottom||0))},e.set("rotation",0),s+=t})},capturables:function(e){return e.components},drawables:function(e){return e.components.filter(function(e){return!e.hidden})},isStuck:function(e){return!0}};(function(e){return e&&e.__esModule?e:{default:e}})(e("./layout")).default.register("linear-horizontal",o),n.default=o},{"./layout":248}],250:[function(e,t,n){"use strict";function r(e){var t=e.get("layoutConfig");return t?t.weight||1:1}Object.defineProperty(n,"__esModule",{value:!0});var o={reflow:function(e){var t=this.drawables(e),n=e.get("padding")||{},o=t.reduce(function(e,t){return e+r(t)},0),i=e.bounds,a=o>0?(i.height-((n.top||0)+(n.bottom||0)))/o:i.height,u=i.width-((n.left||0)+(n.right||0)),s=0;t.forEach(function(e){var t=r(e),o=e.get("margin")||{};e.bounds={left:0+(n.left||0)+(o.left||0),top:a*s+(n.top||0)+(o.top||0),width:u-((o.left||0)+(o.right||0)),height:t*a-((o.top||0)+(o.bottom||0))},e.set("rotation",0),s+=t})},capturables:function(e){return e.components},drawables:function(e){return e.components.filter(function(e){return!e.hidden})},isStuck:function(e){return!0}};(function(e){return e&&e.__esModule?e:{default:e}})(e("./layout")).default.register("linear-vertical",o),n.default=o},{"./layout":248}],251:[function(e,t,n){(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(t){return new e(t).toString("base64")}function o(e,t){var n=JSON.parse(JSON.stringify(e));delete n.Key;var o=[];return r(JSON.stringify(n)).split("").forEach(function(e,n){o.push(String.fromCharCode(Math.abs(e.charCodeAt()-t[n%t.length].charCodeAt())))}),r(o.join(""))}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.license=function(e){c.key=e};var a={},u=!1,s=!1,c=n.License=function(){function e(){t(this,e)}return i(e,null,[{key:"isHostnameValid",value:function(){var t=location.hostname;if(""===t)return!0;for(var n=e.hostname.split(","),r=0;r<n.length;r++){if(e.matchLicenseHost(n[r].trim(),e.baseUrl))return!0;if(e.matchLicenseHost(n[r].trim(),t))return!0}return!1}},{key:"matchLicenseHost",value:function(t,n){if(n="127.0.0.1"==n?"localhost":n,t="127.0.0.1"==t?"localhost":t,n==t)return"localhost"!=t||"Production"!=e.licenseType;var r=t.split("."),o=n.split(".");if(r.length==o.length){for(var i=0;i<r.length;i++){var a=r[i],u=o[i];if(!("*"==a||a==u))return!1}return!0}return!1}},{key:"isUnlimited",value:function(){return"UNLIMITED"==e.expirationDate}},{key:"isUnexpired",value:function(){if(e.isUnlimited())return!0;var t=new Date;return e.expirationDate>t}},{key:"isKeyValid",value:function(){JSON.stringify(a,null," ");return a.Key==o(a,"hatio lab.")}},{key:"certified",get:function(){if(s)return s;if(!e.key)return!1;try{for(var t=Number(e.key.charAt(0)),n=Number(e.key.substring(e.key.length-t)),r=e.key.substring(1,e.key.length-t),o=0,i=0;i<r.length;i++)o+=r.charCodeAt(i);return o===n&&(a=JSON.parse(atob(r)),s=!0)}catch(e){return console.error("license invalid"),!1}}},{key:"key",get:function(){return e._key},set:function(t){e._key=t,u=!1,s=!1}},{key:"licenseType",get:function(){return a["License Type"]}},{key:"expirationDate",get:function(){var e=a["Expiration Date"]||"";if("UNLIMITED"==e)return e;var t=e.split(".");return e&&3==t.length&&(e=new Date(t[0],t[1],t[2])),e}},{key:"hostname",get:function(){return a.Hostname}},{key:"licenseKey",get:function(){return a.Key}},{key:"baseUrl",get:function(){return e._baseUrl||""},set:function(t){e._baseUrl=t}},{key:"valid",get:function(){return!!e.certified&&(u||(u=e.isKeyValid()&&e.isHostnameValid()&&e.isUnexpired()),u)}}]),e}()}).call(this,e("buffer").Buffer)},{buffer:3}],252:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){var n=i.Component.register(e.type);if(!n)return(0,a.warn)("Class not found",e.type),null;var r=new n(e,t);return e.components&&r.isContainer()&&(e.components.forEach(function(e){var n=o(e,t);n&&r.addComponent(n)}),delete e.components),r.created(),r}Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var i=r(e("../components")),a=(r(e("../layer")),e("../core/logger"))},{"../components":178,"../core/logger":208,"../layer":230}],253:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=(0,o.clone)(e.hierarchy);return void 0!==t.id&&delete t.id,(0,r.default)(t,e.app)};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("./compile")),o=e("../core/utils")},{"../core/utils":216,"./compile":252}],254:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./compile");Object.defineProperty(n,"compile",{enumerable:!0,get:function(){return r(o).default}});var i=e("./duplicate");Object.defineProperty(n,"duplicate",{enumerable:!0,get:function(){return r(i).default}});var a=e("./selector");Object.defineProperty(n,"select",{enumerable:!0,get:function(){return a.select}}),Object.defineProperty(n,"match",{enumerable:!0,get:function(){return a.match}})},{"./compile":252,"./duplicate":253,"./selector":255}],255:[function(e,t,n){"use strict";function r(e,t,n,r){return e.substr(1)==t.get("id")}function o(e,t,n,r){var o=t.get("class");return!!o&&(o.split(" ")||[]).indexOf(e.substr(1))>=0}function i(e,t,n,r){switch(e){case"(all)":return!0;case"(self)":return r===t;case"(root)":return!r.parent&&r===t;case"(descendant)":return r!==t;case"(child)":return r===t.parent;default:return!1}}function a(e,t,n,r){return e==t.get("type")}function u(e,t,n,r,o,i){return e(t,n,r,o)&&i.push(n),n.components&&n.components.forEach(function(n){u(e,t,n,r,o,i)}),i}function s(e,t,n,r){switch(e){case"(all)":return!0;case"(parent)":return n&&n.parent===t;case"(child)":case"(children)":return n&&n===t.parent;case"(sibling)":case"(siblings)":return n&&n.parent===t.parent&&n!==t;default:return!1}}Object.defineProperty(n,"__esModule",{value:!0}),n.match=function(e,t,n,u){if("(all)"==e)return!0;switch(e.charAt(0)){case"#":return r(e,t,n,u);case".":return o(e,t,n,u);case"(":return i(e,t,n,u);default:return a(e,t,n,u)}},n.select=function(e,t,n){if("(root)"==e)return[t];if("(self)"==e)return n?[n]:[];var r;switch(e.charAt(0)){case"#":var i=t.root.findById(e.substr(1));return i?[i]:[];case".":r=o;break;case"(":r=s;break;default:r=a}return u(r,e,t,n,t,[])}},{}],256:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e}},{}],257:[function(e,t,n){arguments[4][149][0].apply(n,arguments)},{"./compile":256,dup:149}],258:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){e instanceof Array||(e=[e]),n||(n=this.model_layer);var i=[];this.selected=e.map(function(e){var o=t.left,a=t.top,u=t.width,s=t.height,c=t.x,l=t.y,f=t.cx,h=t.cy,p=r.compile(e,n.app);return isNaN(o)||isNaN(a)||isNaN(u)||isNaN(s)||(p.bounds={left:o,top:a,width:u,height:s}),isNaN(c)||isNaN(l)||p.move({x:c,y:l}),isNaN(f)||isNaN(h)||(p.center={x:f,y:h}),i.push({component:p,to_container:n}),p}),this.app.commander.execute(new o.default({changes:i}))};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../../model")),o=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-migrate"))},{"../../command/command-migrate":151,"../../model":254}],259:[function(e,t,n){"use strict";function r(e,t){for(var n=JSON.parse(JSON.stringify(t[0].bounds)),r=n.left+n.width,o=n.top+n.height,f=0;f<t.length;f++){var h=t[f].bounds;n.left=h.left>n.left?n.left:h.left,n.top=h.top>n.top?n.top:h.top,r=h.left+h.width>r?h.left+h.width:r,o=h.top+h.height>o?h.top+h.height:o}switch(n.width=r-n.left,n.height=o-n.top,e){case i:for(var p=0;p<t.length;p++){var d=t[p].bounds;t[p].bounds={left:n.left,top:d.top,width:d.width,height:d.height}}break;case u:for(var y=0;y<t.length;y++){var v=t[y].bounds;t[y].bounds={left:n.left+n.width/2-v.width/2,top:v.top,width:v.width,height:v.height}}break;case a:for(var g=0;g<t.length;g++){var m=t[g].bounds;t[g].bounds={left:r-m.width,top:m.top,width:m.width,height:m.height}}break;case s:for(var _=0;_<t.length;_++){var b=t[_].bounds;t[_].bounds={left:b.left,top:n.top,width:b.width,height:b.height}}break;case l:for(var w=0;w<t.length;w++){var x=t[w].bounds;t[w].bounds={left:x.left,top:n.top+n.height/2-x.height/2,width:x.width,height:x.height}}break;case c:for(var k=0;k<t.length;k++){var O=t[k].bounds;t[k].bounds={left:O.left,top:o-O.height,width:O.width,height:O.height}}break;default:return}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(-1!=f.indexOf(e)){var t=this.selected.filter(function(e){return!e.stuck});if(!(t.length<=1)){var n=this.app.commander;o.default.around(t,n,function(){r(e,t)})}}};var o=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-change")),i="left",a="right",u="center",s="top",c="bottom",l="middle",f=[i,a,u,s,l,c]},{"../../command/command-change":150}],260:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.change=function(e,t,n){var r=this.findAll(e,n);return r.forEach(function(e){e.set(t)}),r},n.undoableChange=function(e){r.default.around(null,this.app.commander,e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-change"))},{"../../command/command-change":150}],261:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.selected;if(0!=e.length){var t=e.filter(function(e){return!e.isRootModel()}).map(function(e){return e.hierarchy});0!=t.length&&(s=0,i.default.put(t))}}Object.defineProperty(n,"__esModule",{value:!0}),n.copy=o,n.cut=function(){s=0,o.call(this),a.default.call(this)},n.paste=function(){var e=i.default.get();e&&(s++,u.default.call(this,e,{x:15*s,y:15*s}))};var i=r(e("../clipboard")),a=r(e("./remove")),u=r(e("./add")),s=0},{"../clipboard":274,"./add":258,"./remove":268}],262:[function(e,t,n){"use strict";function r(e,t){var n=t.filter(function(e){return!e.stuck}).slice(0);n.sort(function(t,n){var r=t.center,o=n.center;return e===i?r.y-o.y:r.x-o.x});for(var r=n.reduce(function(t,n){return t+(e===i?n.bounds.height:n.bounds.width)},0),o=n[0].bounds,a=n[n.length-1].bounds,u=((e===i?a.top+a.height-o.top:a.left+a.width-o.left)-r)/(n.length-1),s=e===i?o.top+o.height:o.left+o.width,c=1;c<n.length-1;c++){var l=n[c],f=l.bounds;s+=u,e===i?(f.top=s,s+=f.height):(f.left=s,s+=f.width),l.bounds=f}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(-1!=a.indexOf(e)){var t=this.selected;if(!(t.length<=1)){var n=this.app.commander;o.default.around(t,n,function(){r(e,t)})}}};var o=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-change")),i="VERTICAL",a=[i,"HORIZONTAL"]},{"../../command/command-change":150}],263:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=[];if(this.selected=this.selected.filter(function(e){return!e.isRootModel()}).map(function(t){var n=r.duplicate(t);return n.move({x:20,y:20}),e.push({component:n,to_container:t.parent}),n}),0!=e.length){var t=new o.default({changes:e});this.app.commander.execute(t)}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../../model")),o=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-migrate"))},{"../../command/command-migrate":151,"../../model":254}],264:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){function t(e){o.fit(r),setTimeout(function(){o.fit(r)},500),document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"].forEach(function(e){return document.removeEventListener(e,t)})}var n=this.target_element,r=e||"ratio",o=this;["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"].forEach(function(e){return document.addEventListener(e,t)}),n.requestFullScreen?n.requestFullScreen():n.webkitRequestFullScreen?n.webkitRequestFullScreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()}},{}],265:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.group=function(){var e=this.selected.filter(function(e){return!!e.parent&&!e.stuck});if(!(e.length<2)){var t=e[0].parent,n=[],r=e.sort(function(e,n){return t.components.indexOf(e)-t.components.indexOf(n)});r.forEach(function(e){n.push(e.bounds)});var u=o.default.union(n),s=e[0].transcoordP2S(u.left,u.top);s=e[0].transcoordS2T(s.x,s.y);var c=i.compile({type:"group",left:s.x,top:s.y,width:u.width,height:u.height}),l=[{component:c,to_container:t}];r.forEach(function(e){l.push({component:e,to_container:c})}),this.app.commander.execute(new a.default({changes:l})),this.selected=[c]}},n.ungroup=function(){if(0!==this.selected.length){var e=[],t=[];this.selected.forEach(function(n){if(n.isGroup()){var r=n.parent;n.components.forEach(function(n){e.push(n),t.push({component:n,to_container:r})}),t.push({component:n,to_container:null})}}),this.app.commander.execute(new a.default({changes:t})),this.selected=e}};var o=r(e("../../components/component")),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../../model")),a=r(e("../../command/command-migrate"))},{"../../command/command-migrate":151,"../../components/component":155,"../../model":254}],266:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./align");Object.defineProperty(n,"align",{enumerable:!0,get:function(){return r(o).default}});var i=e("./distribute");Object.defineProperty(n,"distribute",{enumerable:!0,get:function(){return r(i).default}});var a=e("./zorder");Object.defineProperty(n,"zorder",{enumerable:!0,get:function(){return r(a).default}});var u=e("./add");Object.defineProperty(n,"add",{enumerable:!0,get:function(){return r(u).default}});var s=e("./duplicate");Object.defineProperty(n,"duplicate",{enumerable:!0,get:function(){return r(s).default}});var c=e("./remove");Object.defineProperty(n,"remove",{enumerable:!0,get:function(){return r(c).default}});var l=e("./listener");Object.defineProperty(n,"on",{enumerable:!0,get:function(){return l.on}}),Object.defineProperty(n,"once",{enumerable:!0,get:function(){return l.once}}),Object.defineProperty(n,"off",{enumerable:!0,get:function(){return l.off}});var f=e("./fullscreen");Object.defineProperty(n,"fullscreen",{enumerable:!0,get:function(){return r(f).default}});var h=e("./clipboard");Object.defineProperty(n,"cut",{enumerable:!0,get:function(){return h.cut}}),Object.defineProperty(n,"copy",{enumerable:!0,get:function(){return h.copy}}),Object.defineProperty(n,"paste",{enumerable:!0,get:function(){return h.paste}});var p=e("./to-data-url");Object.defineProperty(n,"toDataURL",{enumerable:!0,get:function(){return r(p).default}});var d=e("./group");Object.defineProperty(n,"group",{enumerable:!0,get:function(){return d.group}}),Object.defineProperty(n,"ungroup",{enumerable:!0,get:function(){return d.ungroup}});var y=e("./symmetry");Object.defineProperty(n,"symmetryX",{enumerable:!0,get:function(){return y.symmetryX}}),Object.defineProperty(n,"symmetryY",{enumerable:!0,get:function(){return y.symmetryY}});var v=e("./change");Object.defineProperty(n,"change",{enumerable:!0,get:function(){return v.change}}),Object.defineProperty(n,"undoableChange",{enumerable:!0,get:function(){return v.undoableChange}}),Object.defineProperty(n,"undoableChangeBefore",{enumerable:!0,get:function(){return v.undoableChangeBefore}}),Object.defineProperty(n,"undoableChangeAfter",{enumerable:!0,get:function(){return v.undoableChangeAfter}}),Object.defineProperty(n,"undoableChangeReset",{enumerable:!0,get:function(){return v.undoableChangeReset}});var g=e("./variables");Object.defineProperty(n,"getIds",{enumerable:!0,get:function(){return g.getIds}}),Object.defineProperty(n,"getVariables",{enumerable:!0,get:function(){return g.getVariables}}),Object.defineProperty(n,"setVariables",{enumerable:!0,get:function(){return g.setVariables}})},{"./add":258,"./align":259,"./change":260,"./clipboard":261,"./distribute":262,"./duplicate":263,"./fullscreen":264,"./group":265,"./listener":267,"./remove":268,"./symmetry":269,"./to-data-url":270,"./variables":271,"./zorder":272}],267:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.on=function(e,t,n){switch(e){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.on(e,t,n);break;case"selected":this.on(e,t,n);break;case"mode":this.app.on(e,t,n);break;default:this.on(e,t,n)}},n.once=function(e,t,n){switch(e){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.once(e,t,n);break;case"selected":this.once(e,t,n);break;case"mode":this.app.once(e,t,n);break;default:this.once(e,t,n)}},n.off=function(e,t,n){switch(e){case"execute":case"redo":case"undo":case"command-reset":this.app.commander.off(e,t,n);break;case"selected":this.off(e,t,n);break;case"mode":this.app.off(e,t,n);break;default:this.off(e,t,n)}}},{}],268:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=this.selected;this.selected=[];for(var t=null,n=e.filter(function(e){return!e.isRootModel()&&(e.parent.focusible||e.parent.isGroup())}).map(function(e){return t||(t=e.parent),{component:e,to_container:null}});t&&t.isGroup()&&"break"!==function(){var e=[];if(t.components.filter(function(e){return!n.find(function(t){return t.component===e})}).forEach(function(t){return e.push(t)}),e.length>1)return"break";var r=t.parent;e.forEach(function(e){return n.push({component:e,to_container:r})}),n.push({component:t,to_container:null}),t=r}(););n.length>0&&this.app.commander.execute(new r.default({changes:n})),t&&t.calculateBounds&&t.calculateBounds()};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-migrate"))},{"../../command/command-migrate":151}],269:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.selected;if(0!=e.length){var t=e.map(function(e){return e.bounds}),n=a.default.union(t),r=n.left+n.width/2;e.map(function(e){e.symmetryX(r)})}}function i(){var e=this.selected;if(0!=e.length){var t=e.map(function(e){return e.bounds}),n=a.default.union(t),r=n.top+n.height/2;e.map(function(e){e.symmetryY(r)})}}Object.defineProperty(n,"__esModule",{value:!0}),n.symmetryX=function(){u.default.around(this.selected,this.app.commander,o,this)},n.symmetryY=function(){u.default.around(this.selected,this.app.commander,i,this)};var a=r(e("../../components/component")),u=r(e("../../command/command-change"))},{"../../command/command-change":150,"../../components/component":155}],270:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n,r){if(this.model_layer){var a=this.model_layer.get("width"),u=this.model_layer.get("height");n=n||a,r=r||u;var s=o.default.createCanvas(n*i.DPPX,r*i.DPPX),c=this.model_layer.get("translate"),l=this.model_layer.get("scale");this.model_layer.set("translate",{x:0,y:0}),this.model_layer.set("scale",{x:n/a,y:r/u}),this.model_layer.draw(s.getContext("2d"));var f=s.toDataURL(e,t);return this.model_layer.set("translate",c),this.model_layer.set("scale",l),s=null,f}};var o=function(e){return e&&e.__esModule?e:{default:e}}(e("../../components/component")),i=(r(e("../../model")),r(e("../../const")))},{"../../components/component":155,"../../const":203,"../../model":254}],271:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.getIds=function(){return Object.values(this.indexMap).map(function(e){var t=e.model;return{key:t.id,value:t.data}}).sort(function(e,t){return e.key>t.key?1:-1})},n.getVariables=function(){return Object.values(this.indexMap).filter(function(e){return"variable"===e.get("type")}).map(function(e){var t=e.model,n=t.id,r=t.data;return t.dataType,{key:n,value:r}}).sort(function(e,t){return e.key>t.key?1:-1})},n.setVariables=function(e){var t=Object.values(this.indexMap).filter(function(e){return"variable"===e.get("type")}).reduce(function(e,t){return e[t.get("id")]=t,e},{}),n=[];e.forEach(function(e){var r=t[e.key];r?(r.set("data",e.value),delete t[e.key]):n.push({type:"variable",id:e.key,left:0,top:0,width:100,height:20,data:e.value})}),o.default.call(this,n,{x:-100,y:0}),this.selected=Object.values(t),i.default.call(this)};var o=r(e("./add")),i=r(e("./remove"))},{"./add":258,"./remove":268}],272:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=this.selected.filter(function(e){return!e.stuck});if(!(0==t.length||t[0].isRootModel()||t.length>1&&("forward"==e||"backward"==e))){var n,o=t[0].parent;if("forward"==e){var i=o.indexOf(t[0]);n=[{component:t[0],from_container:o,to_container:o,from_index:i,to_index:i+1}]}else if("backward"==e){var a=o.indexOf(t[0]);n=[{component:t[0],from_container:o,to_container:o,from_index:a,to_index:a-1}]}else n=t.filter(function(e){return e.parent===o}).sort(function(t,n){var r=o.indexOf(t)<o.indexOf(n);return"front"==e?r:!r}).map(function(t,n){return o.indexOf(t),{component:t,to_container:o,to_index:"front"==e?o.components.length-n-1:n}});var u=new r.default({changes:n});this.app.commander.execute(u)}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("../../command/command-migrate"))},{"../../command/command-migrate":151}],273:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n,r){e>0||(e=1),t>0||(t=1),r||(r="d");var o=("d"==r?Math.sqrt(e*e+t*t):"w"==r?e:t)/n;return o>0?Math.round(o):0}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=r(e("../core")),s=function(e){return e&&e.__esModule?e:{default:e}}(e("./config")),c=r(e("../const")),l=e("../license/license"),f=Math.PI/12,h=function(){function e(t,n){o(this,e),this._mode=t,this.screen=s.default.screen(),this._baseUrl="undefined"!=typeof window?window.location.origin:null,this._refProvider=n,this.isEditMode&&(this._rotateStep=f,this._rotateStepForced=!1)}return a(e,[{key:"dispose",value:function(){}},{key:"_calcScreen",value:function(){var e={width:screen.width,height:screen.height};this._PPI=i(e.width,e.height,this.screen),this._PPM=this._PPI/25.4}},{key:"url",value:function(e){return e.replace("$base_url",this.baseUrl)}},{key:"refProvider",get:function(){return this._refProvider}},{key:"commander",set:function(e){this._commander=e},get:function(){return this._commander}},{key:"screen",get:function(){return this._screen},set:function(e){this._screen=e,this._calcScreen()}},{key:"DPPX",get:function(){return c.DPPX}},{key:"PPI",get:function(){return this._PPI}},{key:"PPM",get:function(){return this._PPM}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this._mode;t!==e&&(this._mode=e,this.trigger("mode",e,t))}},{key:"isViewMode",get:function(){return this._mode==c.MODE_VIEW}},{key:"isEditMode",get:function(){return this._mode==c.MODE_EDIT}},{key:"baseUrl",get:function(){return this._baseUrl},set:function(e){this._baseUrl=e,void 0!=e&&(l.License.baseUrl=e.replace(/^(?:http(s?)\:\/\/)?/,"").replace("/rest",""))}},{key:"rotateStep",get:function(){return this._rotateStep},set:function(e){this._rotateStep=Number(e)||f}},{key:"rotateStepForced",get:function(){return this._rotateStepForced},set:function(e){this._rotateStepForced=!!e}}]),e}();n.default=h,u.mixin(h.prototype,u.event.withEvent)},{"../const":203,"../core":206,"../license/license":251,"./config":275}],274:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../core")),o=e("../core/utils"),i=null,a={};r.mixin(a,r.event.withEvent),n.default={put:function(e){e instanceof Array?i=e.map(function(e){var t=(0,o.clone)(e);return delete t.id,t}):delete(i=(0,o.clone)(e)).id,a.trigger("clipboard-put",i)},get:function(){return i instanceof Array?i.map(function(e){return(0,o.clone)(e)}):(0,o.clone)(i)},reset:function(){i=null,a.trigger("clipboard-reset")}}},{"../core":206,"../core/utils":216}],275:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=13.3;n.default={screen:function(e){return void 0!==e&&(r=e),r}}},{}],276:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=e.target,n=e.model,r=e.style,s=e.layers,c=void 0===s?[]:s,l=e.handlers,f=void 0===l?[]:l,h=e.mode,p=void 0===h?a.MODE_VIEW:h,d=e.refProvider,y=null;if("string"==typeof t){if(!(y=document.getElementById(t)))throw"target element '"+t+"' is not exist";if(y.firstChild)throw"target element '"+t+"' is not empty"}else y=t;return y&&y.style&&(y.style.cursor="default",y.style.overflow="hidden"),new u.default(new o.default({target_element:y,model:n,style:r,layers:c,handlers:f},new i.default(p,d)))};var o=r(e("../components/root-container")),i=r(e("./application-context")),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../const")),u=r(e("./scene"))},{"../components/root-container":195,"../const":203,"./application-context":273,"./scene":280}],277:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return r};var r=0,o=performance.now(),i=0;requestAnimationFrame(function e(){requestAnimationFrame(e),i++;var t=performance.now(),n=t-o;n<1e3||(r=Math.round(1e3*i/n),o=t,i=0)})},{}],278:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.FPS=n.version=n.license=n.Scene=n.ReferenceMap=n.EventMap=n.Layer=n.Model=n.clipboard=n.create=n.config=n.polyfill=void 0;var o=e("./polyfill");Object.defineProperty(n,"polyfill",{enumerable:!0,get:function(){return r(o).default}});var i=e("./config");Object.defineProperty(n,"config",{enumerable:!0,get:function(){return i.config}});var a=e("./create");Object.defineProperty(n,"create",{enumerable:!0,get:function(){return r(a).default}});var u=e("./clipboard");Object.defineProperty(n,"clipboard",{enumerable:!0,get:function(){return r(u).default}});var s=e("../layer/layer");Object.defineProperty(n,"Layer",{enumerable:!0,get:function(){return r(s).default}});var c=e("../event-map/event-map");Object.defineProperty(n,"EventMap",{enumerable:!0,get:function(){return r(c).default}});var l=e("../const");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return l[e]}})});var f=e("../components/");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return f[e]}})});var h=e("../layout");Object.keys(h).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return h[e]}})});var p=e("../core/reference-map");Object.defineProperty(n,"ReferenceMap",{enumerable:!0,get:function(){return r(p).default}});var d=e("./scene");Object.defineProperty(n,"Scene",{enumerable:!0,get:function(){return r(d).default}});var y=e("../license/license");Object.defineProperty(n,"license",{enumerable:!0,get:function(){return y.license}});var v=e("./version");Object.defineProperty(n,"version",{enumerable:!0,get:function(){return r(v).default}});var g=e("./fps");Object.defineProperty(n,"FPS",{enumerable:!0,get:function(){return r(g).default}});var m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../model"));n.Model=m},{"../components/":178,"../const":203,"../core/reference-map":212,"../event-map/event-map":220,"../layer/layer":231,"../layout":247,"../license/license":251,"../model":254,"./clipboard":274,"./config":275,"./create":276,"./fps":277,"./polyfill":279,"./scene":280,"./version":281}],279:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n.default="done","function"!=typeof Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}),"function"!=typeof Object.values&&(Object.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t}),"function"!=typeof Object.keys&&(Object.values=function(e){var t=[];for(var n in e)t.push(n);return t}),"undefined"!=typeof CanvasRenderingContext2D&&void 0==CanvasRenderingContext2D.prototype.ellipse&&(CanvasRenderingContext2D.prototype.ellipse=function(e,t,n,r,o,i,a,u){this.save(),this.translate(e,t),this.rotate(o),this.translate(-n,-r),this.scale(n,r),this.arc(1,1,1,i,a,u),this.restore()}),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(console.warn("requestAnimationFrame not supported"),window.requestAnimationFrame=function(t,n){var r=performance.now(),o=Math.max(0,33-(r-e)),i=window.setTimeout(function(){t(r+o)},o);return e=r+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e});var i=i||function(){function e(){r(this,e)}return o(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"has",value:function(){}},{key:"delete",value:function(){}}]),e}(),a=a||function(){function e(){r(this,e)}return o(e,[{key:"add",value:function(){}}]),e}()},{}],280:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./api")),u=r(e("../animation/animate")),s=r(e("../command/snapshot-commander")),c=new WeakSet,l=function(){function e(t){o(this,e),this._container=t,this.app=t.app,this._commander=new s.default(this._container),this.app.commander=this._commander,c.add(this)}return i(e,null,[{key:"residents",get:function(){return c}}]),i(e,[{key:"play",value:function(){a.play.apply(this._container,arguments)}},{key:"add",value:function(){return a.add.apply(this._container,arguments)}},{key:"duplicate",value:function(){return a.duplicate.apply(this._container,arguments)}},{key:"remove",value:function(){return a.remove.apply(this._container,arguments)}},{key:"animate",value:function(){return u.default.apply(this,arguments)}},{key:"fullscreen",value:function(){return a.fullscreen.apply(this._container,arguments)}},{key:"variable",value:function(e,t){return this._container.variable.apply(this._container,arguments)}},{key:"resize",value:function(){this._container.resize()}},{key:"dispose",value:function(){this._commander&&this._commander.dispose(),this._container&&this._container.dispose()}},{key:"select",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this._container.selected=(t=this.root).findAll.apply(t,[e].concat(r)),this.selected}},{key:"undo",value:function(){this.commander.undo()}},{key:"redo",value:function(){this.commander.redo()}},{key:"cut",value:function(){return a.cut.apply(this._container,arguments)}},{key:"copy",value:function(){return a.copy.apply(this._container,arguments)}},{key:"paste",value:function(){return a.paste.apply(this._container,arguments)}},{key:"undoableChange",value:function(){return a.undoableChange.apply(this._container,arguments)}},{key:"change",value:function(){return a.change.apply(this.root,arguments)}},{key:"findAll",value:function(){return this.root.findAll.apply(this.root,arguments)}},{key:"findFirst",value:function(){return this.root.findFirst.apply(this.root,arguments)}},{key:"findById",value:function(){return this._container.findById.apply(this._container,arguments)}},{key:"serialize",value:function(){return this.root.trim(),this.root.serialize.apply(this.root,arguments)}},{key:"align",value:function(){return a.align.apply(this._container,arguments)}},{key:"distribute",value:function(){return a.distribute.apply(this._container,arguments)}},{key:"zorder",value:function(){return a.zorder.apply(this._container,arguments)}},{key:"symmetryX",value:function(){return a.symmetryX.apply(this._container,arguments)}},{key:"symmetryY",value:function(){return a.symmetryY.apply(this._container,arguments)}},{key:"on",value:function(){return a.on.apply(this._container,arguments)}},{key:"once",value:function(){return a.once.apply(this._container,arguments)}},{key:"off",value:function(){return a.off.apply(this._container,arguments)}},{key:"toDataURL",value:function(){return a.toDataURL.apply(this._container,arguments)}},{key:"group",value:function(){return a.group.apply(this._container,arguments)}},{key:"ungroup",value:function(){return a.ungroup.apply(this._container,arguments)}},{key:"fit",value:function(e){return this._container.fit(e)}},{key:"target",get:function(){return this._container.target_element},set:function(e){var t;if("string"==typeof e){if(!(t=document.getElementById(e)))throw"target element '"+e+"' is not exist";if(t.firstChild)throw"target element '"+e+"' already has children"}else t=e;t&&t.style&&(t.style.cursor="default"),this._container.target_element=t,this._container.invalidate()}},{key:"scale",get:function(){return this.root.get("scale")},set:function(e){this.root.set("scale",e)}},{key:"translate",get:function(){return this.root.get("translate")},set:function(e){this.root.set("translate",e)}},{key:"unit",get:function(){return this.root.get("unit")||"px"}},{key:"PPM",get:function(){return this.app.PPM}},{key:"PPI",get:function(){return this.app.PPI}},{key:"DPPX",get:function(){return this.app.DPPX}},{key:"unitScale",get:function(){return this._container.unitScale}},{key:"screen",get:function(){return this.app.screen},set:function(e){this.app.screen=e,this._container.resize()}},{key:"selected",get:function(){return this._container.selected.slice()}},{key:"commander",get:function(){return this._commander}},{key:"model",get:function(){return this.root.hierarchy},set:function(e){this._container.rebuildContentModel(e)}},{key:"root",get:function(){return this._container.model_layer}},{key:"mode",get:function(){return this.app.mode},set:function(e){void 0!==e&&(this.app.mode=e)}},{key:"ids",get:function(){return a.getIds.apply(this._container)}},{key:"data",set:function(e){this._container.data=e},get:function(){return this._container.data}},{key:"variables",get:function(){return a.getVariables.apply(this._container)},set:function(e){a.setVariables.apply(this._container,[e])}}]),e}();n.default=l},{"../animation/animate":140,"../command/snapshot-commander":153,"./api":266}],281:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default="0.0.0"},{}]},{},[1]);